<!DOCTYPE html><html lang="ru"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>üéÆ GameZone - –ò–≥—Ä–æ–≤–æ–π –ü–æ—Ä—Ç–∞–ª</title>    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">    <style>        * { font-family: 'Nunito', sans-serif; }                body {            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);            min-height: 100vh;        }                .glass {            background: rgba(255, 255, 255, 0.1);            backdrop-filter: blur(20px);            border: 1px solid rgba(255, 255, 255, 0.2);        }                .neon-glow {            box-shadow: 0 0 20px rgba(139, 92, 246, 0.5), 0 0 40px rgba(139, 92, 246, 0.3);        }                .game-card {            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);        }                .game-card:hover {            transform: translateY(-10px) scale(1.02);            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.4);        }                .floating {            animation: floating 3s ease-in-out infinite;        }                @keyframes floating {            0%, 100% { transform: translateY(0); }            50% { transform: translateY(-10px); }        }                .pulse-glow {            animation: pulseGlow 2s ease-in-out infinite;        }                @keyframes pulseGlow {            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.8), 0 0 60px rgba(236, 72, 153, 0.4); }        }                .gradient-text {            background: linear-gradient(135deg, #8b5cf6, #ec4899, #06b6d4);            -webkit-background-clip: text;            -webkit-text-fill-color: transparent;            background-clip: text;        }                .btn-primary {            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);            transition: all 0.3s ease;        }                .btn-primary:hover {            transform: scale(1.05);            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);        }                .online-dot {            animation: onlinePulse 2s infinite;        }                @keyframes onlinePulse {            0%, 100% { opacity: 1; }            50% { opacity: 0.5; }        }                .particle {            position: fixed;            pointer-events: none;            border-radius: 50%;            animation: floatUp 15s linear infinite;        }                @keyframes floatUp {            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }            10% { opacity: 1; }            90% { opacity: 1; }            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }        }                .memory-card {            perspective: 1000px;        }                .memory-card-inner {            transition: transform 0.6s;            transform-style: preserve-3d;        }                .memory-card.flipped .memory-card-inner {            transform: rotateY(180deg);        }                .memory-card-front, .memory-card-back {            backface-visibility: hidden;        }                .memory-card-back {            transform: rotateY(180deg);        }        .slide-in {            animation: slideIn 0.5s ease-out;        }        @keyframes slideIn {            from { opacity: 0; transform: translateY(20px); }            to { opacity: 1; transform: translateY(0); }        }                .fruit-fall {            animation: fruitFall linear forwards;        }                @keyframes fruitFall {            from { top: -40px; }            to { top: 100%; }        }                .basket-move {            transition: left 0.1s ease-out;        }                .catch-effect {            animation: catchPop 0.3s ease-out;        }                @keyframes catchPop {            0% { transform: scale(1); }            50% { transform: scale(1.3); }            100% { transform: scale(1); }        }                .rainbow-border {            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);            background-size: 400%;            animation: rainbowMove 3s linear infinite;        }                @keyframes rainbowMove {            0% { background-position: 0% 50%; }            100% { background-position: 400% 50%; }        }                .glow-green {            box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);        }                .glow-red {            box-shadow: 0 0 20px rgba(239, 68, 68, 0.6);        }        ::-webkit-scrollbar { width: 8px; }        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #8b5cf6, #ec4899); border-radius: 4px; }    </style></head><body class="text-white overflow-x-hidden">    <!-- Particles Background -->    <div id="particles"></div>    <!-- Auth Screen -->    <div id="authScreen" class="min-h-screen flex items-center justify-center p-4">        <div class="glass rounded-3xl p-8 w-full max-w-md neon-glow slide-in">            <div class="text-center mb-8">                <h1 class="text-5xl font-black gradient-text mb-2">üéÆ GameZone</h1>                <p class="text-gray-300">–ò–≥—Ä–∞–π —Å –¥—Ä—É–∑—å—è–º–∏ –æ–Ω–ª–∞–π–Ω!</p>            </div>                        <div id="authTabs" class="flex mb-6 bg-white/10 rounded-xl p-1">                <button onclick="showAuthTab('login')" id="loginTab" class="flex-1 py-2 rounded-lg bg-purple-500 font-bold transition-all">–í—Ö–æ–¥</button>                <button onclick="showAuthTab('register')" id="registerTab" class="flex-1 py-2 rounded-lg font-bold transition-all">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>            </div>                        <div id="loginForm">                <input type="email" id="loginEmail" placeholder="Email" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <button onclick="login()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–í–æ–π—Ç–∏ üöÄ</button>            </div>                        <div id="registerForm" class="hidden">                <input type="text" id="regUsername" placeholder="–ù–∏–∫–Ω–µ–π–º" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="email" id="regEmail" placeholder="Email" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <button onclick="register()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç ‚ú®</button>            </div>                        <p id="authError" class="text-red-400 text-center mt-4 hidden"></p>        </div>    </div>    <!-- Main App -->    <div id="mainApp" class="hidden">        <!-- Header -->        <header class="glass sticky top-0 z-50 px-6 py-4">            <div class="max-w-7xl mx-auto flex items-center justify-between">                <h1 class="text-2xl font-black gradient-text">üéÆ GameZone</h1>                <div class="flex items-center gap-4">                    <div class="flex items-center gap-2">                        <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold" id="userAvatar">?</div>                        <span id="userName" class="font-bold hidden sm:block">–ò–≥—Ä–æ–∫</span>                    </div>                    <button onclick="logout()" class="glass px-4 py-2 rounded-xl hover:bg-white/20 transition-all">üö™</button>                </div>            </div>        </header>        <!-- Navigation -->        <nav class="flex justify-center gap-2 p-4 flex-wrap">            <button onclick="showSection('games')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="games">üéÆ –ò–≥—Ä—ã</button>            <button onclick="showSection('friends')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="friends">üë• –î—Ä—É–∑—å—è</button>            <button onclick="showSection('leaderboard')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="leaderboard">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>            <button onclick="showSection('invites')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all relative" data-section="invites">                üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è                <span id="invitesBadge" class="absolute -top-2 -right-2 bg-red-500 text-xs w-5 h-5 rounded-full flex items-center justify-center hidden">0</span>            </button>        </nav>        <!-- Games Section -->        <section id="gamesSection" class="max-w-7xl mx-auto p-6">            <h2 class="text-3xl font-black mb-6 gradient-text">üéÆ –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É</h2>                        <!-- Multiplayer Games -->            <h3 class="text-xl font-bold mb-4 text-purple-300">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã</h3>            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">                <!-- Tic Tac Toe -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('tictactoe')">                    <div class="text-6xl mb-4 floating">‚ùå‚≠ï</div>                    <h3 class="text-2xl font-bold mb-2">–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</h3>                    <p class="text-gray-300 mb-4">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ –¥–ª—è –¥–≤–æ–∏—Ö</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Rock Paper Scissors -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('rps')">                    <div class="text-6xl mb-4 floating">‚úä‚úã‚úåÔ∏è</div>                    <h3 class="text-2xl font-bold mb-2">–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞</h3>                    <p class="text-gray-300 mb-4">–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Quiz -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('quiz')">                    <div class="text-6xl mb-4 floating">üß©</div>                    <h3 class="text-2xl font-bold mb-2">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h3>                    <p class="text-gray-300 mb-4">–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Fruit Catcher -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer rainbow-border" onclick="openGame('fruitcatcher')">                    <div class="text-6xl mb-4 floating">üß∫üçé</div>                    <h3 class="text-2xl font-bold mb-2">–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤</h3>                    <p class="text-gray-300 mb-4">–õ–æ–≤–∏ —Ñ—Ä—É–∫—Ç—ã –±—ã—Å—Ç—Ä–µ–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Click Battle -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('clickbattle')">                    <div class="text-6xl mb-4 floating">üëÜüí•</div>                    <h3 class="text-2xl font-bold mb-2">–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª</h3>                    <p class="text-gray-300 mb-4">–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–∫–ª–∏–∫–∞–µ—Ç!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Math Battle -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('mathbattle')">                    <div class="text-6xl mb-4 floating">üî¢‚öîÔ∏è</div>                    <h3 class="text-2xl font-bold mb-2">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π</h3>                    <p class="text-gray-300 mb-4">–†–µ—à–∏ –ø—Ä–∏–º–µ—Ä—ã –±—ã—Å—Ç—Ä–µ–µ!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Word Chain -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('wordchain')">                    <div class="text-6xl mb-4 floating">üìùüîó</div>                    <h3 class="text-2xl font-bold mb-2">–°–ª–æ–≤–∞</h3>                    <p class="text-gray-300 mb-4">–°–æ—Å—Ç–∞–≤–ª—è–π —Å–ª–æ–≤–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <!-- Color Match -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('colormatch')">                    <div class="text-6xl mb-4 floating">üé®üèÉ</div>                    <h3 class="text-2xl font-bold mb-2">–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞</h3>                    <p class="text-gray-300 mb-4">–í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ü–≤–µ—Ç!</p>                    <span class="inline-block bg-green-500/30 text-green-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>            </div>                        <!-- Solo Games -->            <h3 class="text-xl font-bold mb-4 text-blue-300">üèÜ –û–¥–∏–Ω–æ—á–Ω—ã–µ –∏–≥—Ä—ã —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º</h3>            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">                <!-- Memory Game -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('memory')">                    <div class="text-6xl mb-4 floating">üß†</div>                    <h3 class="text-2xl font-bold mb-2">–ú–µ–º–æ—Ä–∏</h3>                    <p class="text-gray-300 mb-4">–ù–∞–π–¥–∏ –≤—Å–µ –ø–∞—Ä—ã!</p>                    <span class="inline-block bg-blue-500/30 text-blue-300 px-3 py-1 rounded-full text-sm">üèÜ –†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <!-- Reaction Game -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('reaction')">                    <div class="text-6xl mb-4 floating">‚ö°</div>                    <h3 class="text-2xl font-bold mb-2">–†–µ–∞–∫—Ü–∏—è</h3>                    <p class="text-gray-300 mb-4">–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ—é —Å–∫–æ—Ä–æ—Å—Ç—å!</p>                    <span class="inline-block bg-blue-500/30 text-blue-300 px-3 py-1 rounded-full text-sm">üèÜ –†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <!-- Snake -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('snake')">                    <div class="text-6xl mb-4 floating">üêç</div>                    <h3 class="text-2xl font-bold mb-2">–ó–º–µ–π–∫–∞</h3>                    <p class="text-gray-300 mb-4">–ö–ª–∞—Å—Å–∏–∫–∞ –∞—Ä–∫–∞–¥!</p>                    <span class="inline-block bg-blue-500/30 text-blue-300 px-3 py-1 rounded-full text-sm">üèÜ –†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <!-- Fruit Catcher Solo -->                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('fruitcatchersolo')">                    <div class="text-6xl mb-4 floating">üß∫üçá</div>                    <h3 class="text-2xl font-bold mb-2">–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤</h3>                    <p class="text-gray-300 mb-4">–°–æ–±–µ—Ä–∏ –º–∞–∫—Å–∏–º—É–º!</p>                    <span class="inline-block bg-blue-500/30 text-blue-300 px-3 py-1 rounded-full text-sm">üèÜ –†–µ–π—Ç–∏–Ω–≥</span>                </div>            </div>        </section>        <!-- Friends Section -->        <section id="friendsSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üë• –î—Ä—É–∑—å—è</h2>                        <div class="glass rounded-2xl p-6 mb-6">                <h3 class="text-xl font-bold mb-4">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞</h3>                <div class="flex gap-4 flex-wrap">                    <input type="text" id="friendEmail" placeholder="Email –¥—Ä—É–≥–∞" class="flex-1 min-w-[200px] p-4 rounded-xl bg-white/10 border border-white/20 focus:outline-none focus:border-purple-500">                    <button onclick="addFriend()" class="btn-primary px-6 rounded-xl font-bold">–î–æ–±–∞–≤–∏—Ç—å</button>                </div>            </div>                        <div class="glass rounded-2xl p-6 mb-6">                <h3 class="text-xl font-bold mb-4">üì® –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h3>                <div id="friendRequests" class="space-y-3">                    <p class="text-gray-400">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>                </div>            </div>                        <div class="glass rounded-2xl p-6">                <h3 class="text-xl font-bold mb-4">üë• –ú–æ–∏ –¥—Ä—É–∑—å—è</h3>                <div id="friendsList" class="space-y-3">                    <p class="text-gray-400">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>                </div>            </div>        </section>        <!-- Leaderboard Section -->        <section id="leaderboardSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>                        <div class="flex gap-2 mb-6 flex-wrap">                <button onclick="showLeaderboard('snake')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üêç –ó–º–µ–π–∫–∞</button>                <button onclick="showLeaderboard('memory')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üß† –ú–µ–º–æ—Ä–∏</button>                <button onclick="showLeaderboard('reaction')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">‚ö° –†–µ–∞–∫—Ü–∏—è</button>                <button onclick="showLeaderboard('fruitcatcher')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üß∫ –§—Ä—É–∫—Ç—ã</button>            </div>                        <div id="leaderboardContent" class="glass rounded-2xl p-6">                <div class="space-y-3" id="leaderboardList">                    <p class="text-gray-400 text-center">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</p>                </div>            </div>        </section>        <!-- Invites Section -->        <section id="invitesSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –∏–≥—Ä—ã</h2>            <div id="gameInvites" class="glass rounded-2xl p-6 space-y-4">                <p class="text-gray-400 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>            </div>        </section>    </div>    <!-- Game Modal -->    <div id="gameModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">        <div class="glass rounded-3xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto neon-glow">            <div class="flex justify-between items-center mb-6">                <h2 id="gameTitle" class="text-2xl font-black gradient-text">–ò–≥—Ä–∞</h2>                <button onclick="closeGame()" class="text-3xl hover:scale-110 transition-transform">‚ùå</button>            </div>            <div id="gameContent"></div>        </div>    </div>    <!-- Notification -->    <div id="notification" class="fixed bottom-4 right-4 glass rounded-xl p-4 hidden transform translate-y-20 transition-all z-50">        <p id="notificationText"></p>    </div>    <script>        // Firebase Config        const firebaseConfig = {            apiKey: "AIzaSyBKDnOlEP4wb8YfZkJ-b5qVzbZmCBn6G3A",            authDomain: "bucktupogub-ae41a.firebaseapp.com",            databaseURL: "https://bucktupogub-ae41a-default-rtdb.firebaseio.com",            projectId: "bucktupogub-ae41a",            storageBucket: "bucktupogub-ae41a.firebasestorage.app",            messagingSenderId: "974220682292",            appId: "1:974220682292:web:16f3696389804f2f4a5661",            measurementId: "G-QTZ59V95LN"        };        firebase.initializeApp(firebaseConfig);        const auth = firebase.auth();        const db = firebase.database();                let currentUser = null;        let currentGameId = null;        let gameListeners = [];        let gameIntervals = [];        // Create particles        function createParticles() {            const container = document.getElementById('particles');            const colors = ['#8b5cf6', '#ec4899', '#06b6d4', '#10b981'];            for (let i = 0; i < 20; i++) {                const particle = document.createElement('div');                particle.className = 'particle';                particle.style.left = Math.random() * 100 + '%';                particle.style.width = Math.random() * 10 + 5 + 'px';                particle.style.height = particle.style.width;                particle.style.background = colors[Math.floor(Math.random() * colors.length)];                particle.style.animationDelay = Math.random() * 15 + 's';                particle.style.opacity = Math.random() * 0.5 + 0.2;                container.appendChild(particle);            }        }        createParticles();        // Auth        function showAuthTab(tab) {            document.getElementById('loginForm').classList.toggle('hidden', tab !== 'login');            document.getElementById('registerForm').classList.toggle('hidden', tab !== 'register');            document.getElementById('loginTab').classList.toggle('bg-purple-500', tab === 'login');            document.getElementById('registerTab').classList.toggle('bg-purple-500', tab === 'register');        }        async function login() {            const email = document.getElementById('loginEmail').value;            const password = document.getElementById('loginPassword').value;            try {                await auth.signInWithEmailAndPassword(email, password);            } catch (e) {                showAuthError(e.message);            }        }        async function register() {            const username = document.getElementById('regUsername').value;            const email = document.getElementById('regEmail').value;            const password = document.getElementById('regPassword').value;            try {                const cred = await auth.createUserWithEmailAndPassword(email, password);                await db.ref('users/' + cred.user.uid).set({                    username: username,                    email: email,                    createdAt: Date.now(),                    online: true                });            } catch (e) {                showAuthError(e.message);            }        }        function logout() {            if (currentUser) {                db.ref('users/' + currentUser.uid + '/online').set(false);            }            auth.signOut();        }        function showAuthError(msg) {            const el = document.getElementById('authError');            el.textContent = msg;            el.classList.remove('hidden');        }        auth.onAuthStateChanged(async (user) => {            if (user) {                currentUser = user;                const userData = await db.ref('users/' + user.uid).once('value');                const data = userData.val() || {};                                document.getElementById('userName').textContent = data.username || '–ò–≥—Ä–æ–∫';                document.getElementById('userAvatar').textContent = (data.username || '–ò')[0].toUpperCase();                                db.ref('users/' + user.uid + '/online').set(true);                db.ref('users/' + user.uid + '/online').onDisconnect().set(false);                                document.getElementById('authScreen').classList.add('hidden');                document.getElementById('mainApp').classList.remove('hidden');                                setupListeners();            } else {                currentUser = null;                document.getElementById('authScreen').classList.remove('hidden');                document.getElementById('mainApp').classList.add('hidden');            }        });        // Navigation        function showSection(section) {            ['games', 'friends', 'leaderboard', 'invites'].forEach(s => {                document.getElementById(s + 'Section').classList.add('hidden');            });            document.getElementById(section + 'Section').classList.remove('hidden');                        document.querySelectorAll('.nav-btn').forEach(btn => {                btn.classList.remove('bg-purple-500');                if (btn.dataset.section === section) btn.classList.add('bg-purple-500');            });        }        // Friends        async function addFriend() {            const email = document.getElementById('friendEmail').value.trim();            if (!email) return;                        const users = await db.ref('users').orderByChild('email').equalTo(email).once('value');            const data = users.val();                        if (!data) {                notify('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω üò¢');                return;            }                        const friendId = Object.keys(data)[0];            if (friendId === currentUser.uid) {                notify('–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è –≤ –¥—Ä—É–∑—å—è üòÖ');                return;            }                        await db.ref('friendRequests/' + friendId + '/' + currentUser.uid).set({                from: currentUser.uid,                timestamp: Date.now()            });                        document.getElementById('friendEmail').value = '';            notify('–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! ‚úâÔ∏è');        }        async function acceptFriend(friendId) {            await db.ref('friends/' + currentUser.uid + '/' + friendId).set(true);            await db.ref('friends/' + friendId + '/' + currentUser.uid).set(true);            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();            notify('–î—Ä—É–≥ –¥–æ–±–∞–≤–ª–µ–Ω! üéâ');        }        async function declineFriend(friendId) {            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();        }        const gameNames = {             tictactoe: '–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏',             rps: '–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞',             quiz: '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞',            fruitcatcher: '–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤',            clickbattle: '–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª',            mathbattle: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π',            wordchain: '–°–ª–æ–≤–∞',            colormatch: '–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞'        };        function setupListeners() {            // Friend requests            db.ref('friendRequests/' + currentUser.uid).on('value', async (snap) => {                const requests = snap.val() || {};                const container = document.getElementById('friendRequests');                                if (Object.keys(requests).length === 0) {                    container.innerHTML = '<p class="text-gray-400">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>';                    return;                }                                container.innerHTML = '';                for (const id of Object.keys(requests)) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4">                            <div class="flex items-center gap-3">                                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold">${(user.username || '?')[0].toUpperCase()}</div>                                <span class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</span>                            </div>                            <div class="flex gap-2">                                <button onclick="acceptFriend('${id}')" class="bg-green-500 px-4 py-2 rounded-lg font-bold hover:bg-green-600">‚úì</button>                                <button onclick="declineFriend('${id}')" class="bg-red-500 px-4 py-2 rounded-lg font-bold hover:bg-red-600">‚úï</button>                            </div>                        </div>                    `;                }            });            // Friends list            db.ref('friends/' + currentUser.uid).on('value', async (snap) => {                const friends = snap.val() || {};                const container = document.getElementById('friendsList');                                if (Object.keys(friends).length === 0) {                    container.innerHTML = '<p class="text-gray-400">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>';                    return;                }                                container.innerHTML = '';                for (const id of Object.keys(friends)) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    const online = user.online ? '<span class="w-3 h-3 bg-green-500 rounded-full online-dot"></span>' : '<span class="w-3 h-3 bg-gray-500 rounded-full"></span>';                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 flex-wrap gap-2">                            <div class="flex items-center gap-3">                                ${online}                                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold">${(user.username || '?')[0].toUpperCase()}</div>                                <span class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</span>                            </div>                            <button onclick="inviteToGame('${id}')" class="btn-primary px-4 py-2 rounded-lg font-bold ${user.online ? '' : 'opacity-50 cursor-not-allowed'}" ${user.online ? '' : 'disabled'}>üéÆ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>                        </div>                    `;                }            });            // Game invites            db.ref('gameInvites/' + currentUser.uid).on('value', async (snap) => {                const invites = snap.val() || {};                const container = document.getElementById('gameInvites');                const keys = Object.keys(invites);                                document.getElementById('invitesBadge').classList.toggle('hidden', keys.length === 0);                document.getElementById('invitesBadge').textContent = keys.length;                                if (keys.length === 0) {                    container.innerHTML = '<p class="text-gray-400 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>';                    return;                }                                container.innerHTML = '';                for (const id of keys) {                    const invite = invites[id];                    const userData = await db.ref('users/' + invite.from).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 flex-wrap gap-2">                            <div>                                <div class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</div>                                <div class="text-gray-300">${gameNames[invite.game] || invite.game}</div>                            </div>                            <div class="flex gap-2">                                <button onclick="joinGame('${id}', '${invite.game}', '${invite.gameId}')" class="bg-green-500 px-4 py-2 rounded-lg font-bold hover:bg-green-600">–ü—Ä–∏–Ω—è—Ç—å</button>                                <button onclick="declineInvite('${id}')" class="bg-red-500 px-4 py-2 rounded-lg font-bold hover:bg-red-600">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>                            </div>                        </div>                    `;                }            });        }        function inviteToGame(friendId) {            document.getElementById('gameContent').innerHTML = `                <div class="text-center">                    <h3 class="text-xl font-bold mb-6">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">                        <button onclick="sendGameInvite('${friendId}', 'tictactoe')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">‚ùå‚≠ï</div>                            <div class="text-sm font-bold">–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'rps')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">‚úä‚úã‚úåÔ∏è</div>                            <div class="text-sm font-bold">–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'quiz')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">üß©</div>                            <div class="text-sm font-bold">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'fruitcatcher')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all rainbow-border">                            <div class="text-3xl mb-2">üß∫üçé</div>                            <div class="text-sm font-bold">–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'clickbattle')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">üëÜüí•</div>                            <div class="text-sm font-bold">–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'mathbattle')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">üî¢‚öîÔ∏è</div>                            <div class="text-sm font-bold">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'wordchain')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">üìùüîó</div>                            <div class="text-sm font-bold">–°–ª–æ–≤–∞</div>                        </button>                        <button onclick="sendGameInvite('${friendId}', 'colormatch')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                            <div class="text-3xl mb-2">üé®üèÉ</div>                            <div class="text-sm font-bold">–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞</div>                        </button>                    </div>                </div>            `;            document.getElementById('gameTitle').textContent = 'üéÆ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞';            document.getElementById('gameModal').classList.remove('hidden');        }        async function sendGameInvite(friendId, game) {            const gameId = db.ref('games').push().key;                        await db.ref('games/' + gameId).set({                type: game,                player1: currentUser.uid,                player2: friendId,                status: 'waiting',                createdAt: Date.now()            });                        await db.ref('gameInvites/' + friendId + '/' + Date.now()).set({                from: currentUser.uid,                game: game,                gameId: gameId            });                        closeGame();            notify('–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! üì®');                        waitForOpponent(gameId, game);        }        function waitForOpponent(gameId, game) {            document.getElementById('gameContent').innerHTML = `                <div class="text-center py-12">                    <div class="text-6xl mb-4 floating">‚è≥</div>                    <h3 class="text-xl font-bold mb-2">–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...</h3>                    <p class="text-gray-300">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</p>                </div>            `;            document.getElementById('gameTitle').textContent = 'üéÆ –û–∂–∏–¥–∞–Ω–∏–µ';            document.getElementById('gameModal').classList.remove('hidden');                        const listener = db.ref('games/' + gameId + '/status').on('value', (snap) => {                if (snap.val() === 'playing') {                    db.ref('games/' + gameId + '/status').off('value', listener);                    startMultiplayerGame(gameId, game);                }            });            gameListeners.push({ ref: 'games/' + gameId + '/status', callback: listener });        }        async function joinGame(inviteId, game, gameId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();            await db.ref('games/' + gameId + '/status').set('playing');            startMultiplayerGame(gameId, game);        }        async function declineInvite(inviteId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();        }        // Games        function openGame(game) {            document.getElementById('gameModal').classList.remove('hidden');                        switch(game) {                case 'tictactoe': initTicTacToe(); break;                case 'rps': initRPS(); break;                case 'memory': initMemory(); break;                case 'reaction': initReaction(); break;                case 'snake': initSnake(); break;                case 'quiz': initQuiz(); break;                case 'fruitcatcher': showMultiplayerOnly('fruitcatcher'); break;                case 'fruitcatchersolo': initFruitCatcherSolo(); break;                case 'clickbattle': showMultiplayerOnly('clickbattle'); break;                case 'mathbattle': showMultiplayerOnly('mathbattle'); break;                case 'wordchain': showMultiplayerOnly('wordchain'); break;                case 'colormatch': showMultiplayerOnly('colormatch'); break;            }        }        function showMultiplayerOnly(game) {            document.getElementById('gameTitle').textContent = gameNames[game] || game;            document.getElementById('gameContent').innerHTML = `                <div class="text-center py-8">                    <div class="text-6xl mb-4">üë•</div>                    <h3 class="text-xl font-bold mb-2">–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω–∞—è –∏–≥—Ä–∞</h3>                    <p class="text-gray-300 mb-6">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å!</p>                    <button onclick="showSection('friends'); closeGame();" class="btn-primary px-6 py-3 rounded-xl font-bold">–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥—Ä—É–∑—å—è–º üë•</button>                </div>            `;        }        function closeGame() {            document.getElementById('gameModal').classList.add('hidden');            gameListeners.forEach(l => db.ref(l.ref).off('value', l.callback));            gameListeners = [];            gameIntervals.forEach(i => clearInterval(i));            gameIntervals = [];            currentGameId = null;        }        // Multiplayer games        function startMultiplayerGame(gameId, game) {            currentGameId = gameId;            document.getElementById('gameModal').classList.remove('hidden');            switch(game) {                case 'tictactoe': initMultiplayerTicTacToe(gameId); break;                case 'rps': initMultiplayerRPS(gameId); break;                case 'quiz': initMultiplayerQuiz(gameId); break;                case 'fruitcatcher': initMultiplayerFruitCatcher(gameId); break;                case 'clickbattle': initMultiplayerClickBattle(gameId); break;                case 'mathbattle': initMultiplayerMathBattle(gameId); break;                case 'wordchain': initMultiplayerWordChain(gameId); break;                case 'colormatch': initMultiplayerColorMatch(gameId); break;            }        }        // TIC TAC TOE        function initTicTacToe() {            document.getElementById('gameTitle').textContent = '‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏';            let board = ['', '', '', '', '', '', '', '', ''];            let currentPlayer = 'X';            let gameOver = false;                        function render() {                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-xl" id="tttStatus">–•–æ–¥: ${currentPlayer === 'X' ? '‚ùå' : '‚≠ï'}</p>                    </div>                    <div class="grid grid-cols-3 gap-2 max-w-xs mx-auto">                        ${board.map((cell, i) => `                            <button onclick="tttMove(${i})" class="aspect-square glass rounded-xl text-4xl font-bold hover:bg-purple-500/30 transition-all ${cell ? 'cursor-not-allowed' : ''}">${cell === 'X' ? '‚ùå' : cell === 'O' ? '‚≠ï' : ''}</button>                        `).join('')}                    </div>                    <div class="text-center mt-6">                        <button onclick="initTicTacToe()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>                    </div>                `;            }                        window.tttMove = function(i) {                if (board[i] || gameOver) return;                board[i] = currentPlayer;                                const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];                for (const [a,b,c] of wins) {                    if (board[a] && board[a] === board[b] && board[a] === board[c]) {                        gameOver = true;                        render();                        document.getElementById('tttStatus').innerHTML = `–ü–æ–±–µ–¥–∏–ª ${currentPlayer === 'X' ? '‚ùå' : '‚≠ï'}! üéâ`;                        return;                    }                }                                if (!board.includes('')) {                    gameOver = true;                    render();                    document.getElementById('tttStatus').textContent = '–ù–∏—á—å—è! ü§ù';                    return;                }                                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';                render();            };                        render();        }        async function initMultiplayerTicTacToe(gameId) {            document.getElementById('gameTitle').textContent = '‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏ (–û–Ω–ª–∞–π–Ω)';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;            const mySymbol = isPlayer1 ? 'X' : 'O';                        if (!game.board) {                await db.ref('games/' + gameId + '/board').set(['', '', '', '', '', '', '', '', '']);                await db.ref('games/' + gameId + '/turn').set('X');            }                        function render(board, turn, winner) {                const isMyTurn = turn === mySymbol;                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-lg text-gray-300">–í—ã: ${mySymbol === 'X' ? '‚ùå' : '‚≠ï'}</p>                        <p class="text-xl">${winner ? (winner === 'draw' ? '–ù–∏—á—å—è! ü§ù' : (winner === mySymbol ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢')) : (isMyTurn ? '–í–∞—à —Ö–æ–¥!' : '–•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...')}</p>                    </div>                    <div class="grid grid-cols-3 gap-2 max-w-xs mx-auto">                        ${board.map((cell, i) => `                            <button onclick="multiTttMove(${i})" class="aspect-square glass rounded-xl text-4xl font-bold hover:bg-purple-500/30 transition-all ${cell || !isMyTurn || winner ? 'cursor-not-allowed' : ''}">${cell === 'X' ? '‚ùå' : cell === 'O' ? '‚≠ï' : ''}</button>                        `).join('')}                    </div>                `;            }                        window.multiTttMove = async function(i) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                if (data.board[i] || data.turn !== mySymbol || data.winner) return;                                data.board[i] = mySymbol;                                const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];                let winner = null;                for (const [a,b,c] of wins) {                    if (data.board[a] && data.board[a] === data.board[b] && data.board[a] === data.board[c]) {                        winner = data.board[a];                        break;                    }                }                                if (!winner && !data.board.includes('')) winner = 'draw';                                await db.ref('games/' + gameId).update({                    board: data.board,                    turn: mySymbol === 'X' ? 'O' : 'X',                    winner: winner || null                });            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                const data = snap.val();                if (data && data.board) {                    render(data.board, data.turn, data.winner);                }            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // ROCK PAPER SCISSORS        function initRPS() {            document.getElementById('gameTitle').textContent = '‚úä‚úã‚úåÔ∏è –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞';            let playerChoice = null;            let computerChoice = null;            let result = null;                        function render() {                document.getElementById('gameContent').innerHTML = `                    <div class="text-center">                        <div class="flex justify-center gap-4 mb-8">                            <button onclick="rpsChoice('rock')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all ${playerChoice === 'rock' ? 'ring-4 ring-purple-500' : ''}">‚úä</button>                            <button onclick="rpsChoice('paper')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all ${playerChoice === 'paper' ? 'ring-4 ring-purple-500' : ''}">‚úã</button>                            <button onclick="rpsChoice('scissors')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all ${playerChoice === 'scissors' ? 'ring-4 ring-purple-500' : ''}">‚úåÔ∏è</button>                        </div>                        ${result ? `                            <div class="mb-6">                                <p class="text-lg mb-2">–ö–æ–º–ø—å—é—Ç–µ—Ä –≤—ã–±—Ä–∞–ª: ${{'rock':'‚úä','paper':'‚úã','scissors':'‚úåÔ∏è'}[computerChoice]}</p>                                <p class="text-2xl font-bold ${result === 'win' ? 'text-green-400' : result === 'lose' ? 'text-red-400' : 'text-yellow-400'}">${result === 'win' ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : result === 'lose' ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}</p>                            </div>                        ` : '<p class="text-gray-300 mb-6">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ö–æ–¥</p>'}                        <button onclick="initRPS()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>                    </div>                `;            }                        window.rpsChoice = function(choice) {                playerChoice = choice;                const options = ['rock', 'paper', 'scissors'];                computerChoice = options[Math.floor(Math.random() * 3)];                                if (playerChoice === computerChoice) result = 'draw';                else if (                    (playerChoice === 'rock' && computerChoice === 'scissors') ||                    (playerChoice === 'paper' && computerChoice === 'rock') ||                    (playerChoice === 'scissors' && computerChoice === 'paper')                ) result = 'win';                else result = 'lose';                                render();            };                        render();        }        async function initMultiplayerRPS(gameId) {            document.getElementById('gameTitle').textContent = '‚úä‚úã‚úåÔ∏è –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞ (–û–Ω–ª–∞–π–Ω)';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        function render(data) {                const myChoice = isPlayer1 ? data.choice1 : data.choice2;                const oppChoice = isPlayer1 ? data.choice2 : data.choice1;                const choiceEmoji = {'rock':'‚úä','paper':'‚úã','scissors':'‚úåÔ∏è'};                                let result = null;                if (data.choice1 && data.choice2) {                    if (myChoice === oppChoice) result = 'draw';                    else if (                        (myChoice === 'rock' && oppChoice === 'scissors') ||                        (myChoice === 'paper' && oppChoice === 'rock') ||                        (myChoice === 'scissors' && oppChoice === 'paper')                    ) result = 'win';                    else result = 'lose';                }                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center">                        ${!myChoice ? `                            <p class="text-xl mb-6">–°–¥–µ–ª–∞–π—Ç–µ –≤–∞—à –≤—ã–±–æ—Ä!</p>                            <div class="flex justify-center gap-4 mb-8">                                <button onclick="multiRpsChoice('rock')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all">‚úä</button>                                <button onclick="multiRpsChoice('paper')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all">‚úã</button>                                <button onclick="multiRpsChoice('scissors')" class="text-6xl p-4 glass rounded-2xl hover:bg-purple-500/30 transition-all">‚úåÔ∏è</button>                            </div>                        ` : result ? `                            <div class="mb-6">                                <div class="flex justify-center gap-8 mb-4">                                    <div>                                        <p class="text-gray-300 mb-2">–í—ã</p>                                        <div class="text-6xl">${choiceEmoji[myChoice]}</div>                                    </div>                                    <div class="text-4xl self-center">VS</div>                                    <div>                                        <p class="text-gray-300 mb-2">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                        <div class="text-6xl">${choiceEmoji[oppChoice]}</div>                                    </div>                                </div>                                <p class="text-2xl font-bold ${result === 'win' ? 'text-green-400' : result === 'lose' ? 'text-red-400' : 'text-yellow-400'}">${result === 'win' ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : result === 'lose' ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}</p>                            </div>                        ` : `                            <div class="text-6xl mb-4 floating">‚è≥</div>                            <p class="text-xl">–í—ã –≤—ã–±—Ä–∞–ª–∏: ${choiceEmoji[myChoice]}</p>                            <p class="text-gray-300">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>                        `}                    </div>                `;            }                        window.multiRpsChoice = async function(choice) {                const field = isPlayer1 ? 'choice1' : 'choice2';                await db.ref('games/' + gameId + '/' + field).set(choice);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // FRUIT CATCHER SOLO        function initFruitCatcherSolo() {            document.getElementById('gameTitle').textContent = 'üß∫ –õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤';                        let score = 0;            let timeLeft = 30;            let basketPos = 50;            let fruits = [];            let gameOver = false;            const fruitEmojis = ['üçé', 'üçä', 'üçã', 'üçá', 'üçì', 'üçë', 'üçí', 'ü•ù', 'üçå', 'üçâ'];                        function render() {                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p class="text-xl font-bold">–°—á—ë—Ç: ${score}</p>                        <p class="text-xl font-bold">‚è±Ô∏è ${timeLeft}—Å</p>                    </div>                    <div id="fruitGameArea" class="relative bg-gradient-to-b from-blue-900/50 to-green-900/50 rounded-2xl h-80 overflow-hidden touch-none select-none">                        <div id="fruitsContainer"></div>                        <div id="basket" class="absolute bottom-2 text-5xl basket-move" style="left: ${basketPos}%; transform: translateX(-50%);">üß∫</div>                    </div>                    <div class="flex justify-center gap-4 mt-4">                        <button onmousedown="moveBasketStart(-1)" onmouseup="moveBasketStop()" onmouseleave="moveBasketStop()" ontouchstart="moveBasketStart(-1)" ontouchend="moveBasketStop()" class="glass px-8 py-4 rounded-xl text-2xl font-bold active:bg-purple-500/50">‚¨ÖÔ∏è</button>                        <button onmousedown="moveBasketStart(1)" onmouseup="moveBasketStop()" onmouseleave="moveBasketStop()" ontouchstart="moveBasketStart(1)" ontouchend="moveBasketStop()" class="glass px-8 py-4 rounded-xl text-2xl font-bold active:bg-purple-500/50">‚û°Ô∏è</button>                    </div>                    ${gameOver ? `                        <div class="text-center mt-6">                            <p class="text-2xl font-bold gradient-text mb-2">–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</p>                            <p class="text-xl">–í–∞—à —Å—á—ë—Ç: ${score}</p>                            <button onclick="initFruitCatcherSolo()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>                        </div>                    ` : ''}                `;            }                        let moveInterval = null;            window.moveBasketStart = function(dir) {                if (gameOver) return;                moveInterval = setInterval(() => {                    basketPos = Math.max(10, Math.min(90, basketPos + dir * 5));                    const basket = document.getElementById('basket');                    if (basket) basket.style.left = basketPos + '%';                }, 50);            };                        window.moveBasketStop = function() {                clearInterval(moveInterval);            };                        function spawnFruit() {                if (gameOver) return;                const fruit = {                    id: Date.now(),                    emoji: fruitEmojis[Math.floor(Math.random() * fruitEmojis.length)],                    x: Math.random() * 80 + 10,                    y: -10,                    speed: Math.random() * 2 + 2                };                fruits.push(fruit);            }                        function updateFruits() {                if (gameOver) return;                const container = document.getElementById('fruitsContainer');                if (!container) return;                                fruits.forEach(fruit => {                    fruit.y += fruit.speed;                                        // Check catch                    if (fruit.y > 85 && fruit.y < 95) {                        if (Math.abs(fruit.x - basketPos) < 15) {                            score++;                            fruit.caught = true;                        }                    }                                        // Remove if off screen                    if (fruit.y > 100) {                        fruit.remove = true;                    }                });                                fruits = fruits.filter(f => !f.caught && !f.remove);                                container.innerHTML = fruits.map(f => `                    <div class="absolute text-3xl" style="left: ${f.x}%; top: ${f.y}%; transform: translateX(-50%);">${f.emoji}</div>                `).join('');            }                        render();                        const spawnInterval = setInterval(spawnFruit, 800);            const updateInterval = setInterval(updateFruits, 50);            const timerInterval = setInterval(() => {                timeLeft--;                const timeEl = document.querySelector('.text-xl.font-bold:last-child');                if (timeEl) timeEl.textContent = `‚è±Ô∏è ${timeLeft}—Å`;                                if (timeLeft <= 0) {                    gameOver = true;                    clearInterval(spawnInterval);                    clearInterval(updateInterval);                    clearInterval(timerInterval);                    clearInterval(moveInterval);                    saveScore('fruitcatcher', score);                    render();                }            }, 1000);                        gameIntervals.push(spawnInterval, updateInterval, timerInterval);        }        // MULTIPLAYER FRUIT CATCHER        async function initMultiplayerFruitCatcher(gameId) {            document.getElementById('gameTitle').textContent = 'üß∫ –õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤ (–û–Ω–ª–∞–π–Ω)';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.fruits) {                // Generate fruits sequence for both players                const fruitEmojis = ['üçé', 'üçä', 'üçã', 'üçá', 'üçì', 'üçë', 'üçí', 'ü•ù'];                const fruitSequence = [];                for (let i = 0; i < 50; i++) {                    fruitSequence.push({                        emoji: fruitEmojis[Math.floor(Math.random() * fruitEmojis.length)],                        x: Math.random() * 80 + 10,                        spawnTime: i * 600                    });                }                await db.ref('games/' + gameId + '/fruits').set(fruitSequence);                await db.ref('games/' + gameId + '/score1').set(0);                await db.ref('games/' + gameId + '/score2').set(0);                await db.ref('games/' + gameId + '/startTime').set(Date.now());                await db.ref('games/' + gameId + '/duration').set(30000);            }                        let basketPos = 50;            let localScore = 0;            let activeFruits = [];            let gameEnded = false;                        function render(data) {                const myScore = isPlayer1 ? (data.score1 || 0) : (data.score2 || 0);                const oppScore = isPlayer1 ? (data.score2 || 0) : (data.score1 || 0);                const timeElapsed = Date.now() - (data.startTime || Date.now());                const timeLeft = Math.max(0, Math.ceil(((data.duration || 30000) - timeElapsed) / 1000));                                if (timeLeft <= 0 && !gameEnded) {                    gameEnded = true;                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üèÜ</div>                            <div class="flex justify-center gap-8 mb-4">                                <div class="${myScore > oppScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–í—ã</p>                                    <p class="text-4xl font-bold">${myScore}</p>                                </div>                                <div class="${oppScore > myScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <p class="text-4xl font-bold">${oppScore}</p>                                </div>                            </div>                            <p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : myScore < oppScore ? 'text-red-400' : 'text-yellow-400'}">                                ${myScore > oppScore ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : myScore < oppScore ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}                            </p>                        </div>                    `;                    return;                }                                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p class="text-lg">–í—ã: <span class="font-bold text-green-400">${myScore}</span></p>                        <p class="text-xl font-bold">‚è±Ô∏è ${timeLeft}—Å</p>                        <p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: <span class="font-bold text-red-400">${oppScore}</span></p>                    </div>                    <div id="fruitGameArea" class="relative bg-gradient-to-b from-blue-900/50 to-green-900/50 rounded-2xl h-64 overflow-hidden">                        <div id="fruitsContainer"></div>                        <div id="basket" class="absolute bottom-2 text-4xl basket-move" style="left: ${basketPos}%; transform: translateX(-50%);">üß∫</div>                    </div>                    <div class="flex justify-center gap-4 mt-4">                        <button onmousedown="moveBasketMPStart(-1)" onmouseup="moveBasketMPStop()" onmouseleave="moveBasketMPStop()" ontouchstart="moveBasketMPStart(-1)" ontouchend="moveBasketMPStop()" class="glass px-8 py-4 rounded-xl text-2xl font-bold active:bg-purple-500/50">‚¨ÖÔ∏è</button>                        <button onmousedown="moveBasketMPStart(1)" onmouseup="moveBasketMPStop()" onmouseleave="moveBasketMPStop()" ontouchstart="moveBasketMPStart(1)" ontouchend="moveBasketMPStop()" class="glass px-8 py-4 rounded-xl text-2xl font-bold active:bg-purple-500/50">‚û°Ô∏è</button>                    </div>                `;            }                        let moveInterval = null;            window.moveBasketMPStart = function(dir) {                if (gameEnded) return;                moveInterval = setInterval(() => {                    basketPos = Math.max(10, Math.min(90, basketPos + dir * 5));                    const basket = document.getElementById('basket');                    if (basket) basket.style.left = basketPos + '%';                }, 50);            };                        window.moveBasketMPStop = function() {                clearInterval(moveInterval);            };                        const listener = db.ref('games/' + gameId).on('value', async (snap) => {                const data = snap.val();                if (!data || !data.fruits) return;                                render(data);                                if (gameEnded) return;                                const timeElapsed = Date.now() - data.startTime;                const container = document.getElementById('fruitsContainer');                if (!container) return;                                // Spawn fruits based on time                data.fruits.forEach((fruit, i) => {                    if (fruit.spawnTime <= timeElapsed && !activeFruits.find(f => f.id === i)) {                        activeFruits.push({                            id: i,                            ...fruit,                            y: -10                        });                    }                });                                // Update fruits                activeFruits.forEach(fruit => {                    fruit.y += 3;                                        if (fruit.y > 75 && fruit.y < 90 && !fruit.caught) {                        if (Math.abs(fruit.x - basketPos) < 15) {                            fruit.caught = true;                            localScore++;                            const scoreField = isPlayer1 ? 'score1' : 'score2';                            db.ref('games/' + gameId + '/' + scoreField).set(localScore);                        }                    }                });                                activeFruits = activeFruits.filter(f => f.y < 100 && !f.caught);                                container.innerHTML = activeFruits.map(f => `                    <div class="absolute text-2xl" style="left: ${f.x}%; top: ${f.y}%; transform: translateX(-50%);">${f.emoji}</div>                `).join('');            });                        gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // CLICK BATTLE        async function initMultiplayerClickBattle(gameId) {            document.getElementById('gameTitle').textContent = 'üëÜüí• –ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.startTime) {                await db.ref('games/' + gameId + '/clicks1').set(0);                await db.ref('games/' + gameId + '/clicks2').set(0);                await db.ref('games/' + gameId + '/startTime').set(Date.now());                await db.ref('games/' + gameId + '/duration').set(10000);            }                        let localClicks = 0;                        function render(data) {                const myClicks = isPlayer1 ? (data.clicks1 || 0) : (data.clicks2 || 0);                const oppClicks = isPlayer1 ? (data.clicks2 || 0) : (data.clicks1 || 0);                const timeElapsed = Date.now() - (data.startTime || Date.now());                const timeLeft = Math.max(0, Math.ceil(((data.duration || 10000) - timeElapsed) / 1000));                                if (timeLeft <= 0) {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üèÜ</div>                            <div class="flex justify-center gap-8 mb-4">                                <div class="${myClicks > oppClicks ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–í—ã</p>                                    <p class="text-4xl font-bold">${myClicks}</p>                                </div>                                <div class="${oppClicks > myClicks ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <p class="text-4xl font-bold">${oppClicks}</p>                                </div>                            </div>                            <p class="text-2xl font-bold ${myClicks > oppClicks ? 'text-green-400' : myClicks < oppClicks ? 'text-red-400' : 'text-yellow-400'}">                                ${myClicks > oppClicks ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : myClicks < oppClicks ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}                            </p>                        </div>                    `;                    return;                }                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-6">                        <p class="text-4xl font-bold mb-2">‚è±Ô∏è ${timeLeft}</p>                        <div class="flex justify-center gap-8">                            <p class="text-lg">–í—ã: <span class="font-bold text-green-400">${myClicks}</span></p>                            <p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: <span class="font-bold text-red-400">${oppClicks}</span></p>                        </div>                    </div>                    <button onclick="clickBattle()" class="w-full aspect-square max-w-xs mx-auto block glass rounded-full text-8xl hover:scale-105 active:scale-95 transition-transform pulse-glow">                        üëÜ                    </button>                    <p class="text-center text-gray-300 mt-4">–ö–ª–∏–∫–∞–π—Ç–µ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!</p>                `;            }                        window.clickBattle = async function() {                localClicks++;                const field = isPlayer1 ? 'clicks1' : 'clicks2';                await db.ref('games/' + gameId + '/' + field).set(localClicks);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // MATH BATTLE        async function initMultiplayerMathBattle(gameId) {            document.getElementById('gameTitle').textContent = 'üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.problems) {                const problems = [];                for (let i = 0; i < 10; i++) {                    const a = Math.floor(Math.random() * 20) + 1;                    const b = Math.floor(Math.random() * 20) + 1;                    const ops = ['+', '-', '√ó'];                    const op = ops[Math.floor(Math.random() * ops.length)];                    let answer;                    if (op === '+') answer = a + b;                    else if (op === '-') answer = a - b;                    else answer = a * b;                                        const wrong1 = answer + Math.floor(Math.random() * 10) - 5;                    const wrong2 = answer + Math.floor(Math.random() * 10) - 5;                    const wrong3 = answer + Math.floor(Math.random() * 10) - 5;                                        let options = [answer, wrong1, wrong2, wrong3].filter((v, i, a) => a.indexOf(v) === i);                    while (options.length < 4) options.push(answer + options.length);                    options = options.sort(() => Math.random() - 0.5);                                        problems.push({ q: `${a} ${op} ${b} = ?`, answer, options });                }                await db.ref('games/' + gameId + '/problems').set(problems);                await db.ref('games/' + gameId + '/current1').set(0);                await db.ref('games/' + gameId + '/current2').set(0);                await db.ref('games/' + gameId + '/score1').set(0);                await db.ref('games/' + gameId + '/score2').set(0);            }                        function render(data) {                if (!data.problems) return;                                const myCurrent = isPlayer1 ? (data.current1 || 0) : (data.current2 || 0);                const oppCurrent = isPlayer1 ? (data.current2 || 0) : (data.current1 || 0);                const myScore = isPlayer1 ? (data.score1 || 0) : (data.score2 || 0);                const oppScore = isPlayer1 ? (data.score2 || 0) : (data.score1 || 0);                                if (myCurrent >= data.problems.length || oppCurrent >= data.problems.length) {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üßÆ</div>                            <div class="flex justify-center gap-8 mb-4">                                <div class="${myScore > oppScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–í—ã</p>                                    <p class="text-4xl font-bold">${myScore}/10</p>                                </div>                                <div class="${oppScore > myScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <p class="text-4xl font-bold">${oppScore}/10</p>                                </div>                            </div>                            <p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : myScore < oppScore ? 'text-red-400' : 'text-yellow-400'}">                                ${myScore > oppScore ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : myScore < oppScore ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}                            </p>                        </div>                    `;                    return;                }                                const problem = data.problems[myCurrent];                                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p class="text-lg">–í—ã: ${myCurrent + 1}/10</p>                        <p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: ${oppCurrent + 1}/10</p>                    </div>                    <div class="text-center mb-6">                        <p class="text-4xl font-bold gradient-text">${problem.q}</p>                    </div>                    <div class="grid grid-cols-2 gap-4">                        ${problem.options.map(opt => `                            <button onclick="mathAnswer(${opt})" class="glass p-4 rounded-xl text-2xl font-bold hover:bg-purple-500/50 transition-all">${opt}</button>                        `).join('')}                    </div>                `;            }                        window.mathAnswer = async function(answer) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const problem = data.problems[myCurrent];                                const currentField = isPlayer1 ? 'current1' : 'current2';                const scoreField = isPlayer1 ? 'score1' : 'score2';                                const updates = {};                updates[currentField] = myCurrent + 1;                if (answer === problem.answer) {                    updates[scoreField] = (isPlayer1 ? data.score1 : data.score2) + 1;                }                                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // WORD CHAIN        async function initMultiplayerWordChain(gameId) {            document.getElementById('gameTitle').textContent = 'üìù –°–ª–æ–≤–∞';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.words) {                await db.ref('games/' + gameId + '/words').set([]);                await db.ref('games/' + gameId + '/turn').set(1);                await db.ref('games/' + gameId + '/lastLetter').set('');            }                        function render(data) {                const isMyTurn = (data.turn === 1 && isPlayer1) || (data.turn === 2 && !isPlayer1);                const words = data.words || [];                const lastLetter = data.lastLetter || '';                                if (data.winner) {                    const iWon = (data.winner === 1 && isPlayer1) || (data.winner === 2 && !isPlayer1);                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">${iWon ? 'üéâ' : 'üò¢'}</div>                            <p class="text-2xl font-bold ${iWon ? 'text-green-400' : 'text-red-400'}">                                ${iWon ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏!' : '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!'}                            </p>                            <p class="text-gray-300 mt-2">–°–ª–æ–≤ —Å—ã–≥—Ä–∞–Ω–æ: ${words.length}</p>                        </div>                    `;                    return;                }                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-xl ${isMyTurn ? 'text-green-400' : 'text-gray-400'}">${isMyTurn ? '–í–∞—à —Ö–æ–¥!' : '–•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...'}</p>                        ${lastLetter ? `<p class="text-lg">–°–ª–æ–≤–æ –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –Ω–∞: <span class="text-2xl font-bold gradient-text">${lastLetter.toUpperCase()}</span></p>` : '<p class="text-lg text-gray-300">–ù–∞–ø–∏—à–∏—Ç–µ –ª—é–±–æ–µ —Å–ª–æ–≤–æ</p>'}                    </div>                    <div class="glass rounded-xl p-4 mb-4 max-h-40 overflow-y-auto">                        ${words.length > 0 ? words.map((w, i) => `<span class="${i % 2 === 0 ? 'text-purple-400' : 'text-pink-400'}">${w}</span>`).join(' ‚Üí ') : '<p class="text-gray-400 text-center">–ï—â—ë –Ω–µ—Ç —Å–ª–æ–≤</p>'}                    </div>                    ${isMyTurn ? `                        <div class="flex gap-2">                            <input type="text" id="wordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ..." class="flex-1 p-4 rounded-xl bg-white/10 border border-white/20 focus:outline-none focus:border-purple-500" onkeypress="if(event.key==='Enter')submitWord()">                            <button onclick="submitWord()" class="btn-primary px-6 rounded-xl font-bold">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>                        </div>                        <button onclick="giveUp()" class="w-full mt-4 glass p-3 rounded-xl text-red-400 hover:bg-red-500/20">–°–¥–∞—Ç—å—Å—è üè≥Ô∏è</button>                    ` : ''}                `;            }                        window.submitWord = async function() {                const input = document.getElementById('wordInput');                const word = input.value.trim().toLowerCase();                if (!word) return;                                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const lastLetter = data.lastLetter || '';                                if (lastLetter && word[0] !== lastLetter) {                    notify('–°–ª–æ–≤–æ –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –Ω–∞ ' + lastLetter.toUpperCase());                    return;                }                                if (data.words && data.words.includes(word)) {                    notify('–≠—Ç–æ —Å–ª–æ–≤–æ —É–∂–µ –±—ã–ª–æ!');                    return;                }                                const newWords = [...(data.words || []), word];                const newLastLetter = word[word.length - 1];                                await db.ref('games/' + gameId).update({                    words: newWords,                    lastLetter: newLastLetter,                    turn: data.turn === 1 ? 2 : 1                });            };                        window.giveUp = async function() {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                await db.ref('games/' + gameId + '/winner').set(data.turn === 1 ? 2 : 1);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // COLOR MATCH        async function initMultiplayerColorMatch(gameId) {            document.getElementById('gameTitle').textContent = 'üé® –¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        const colors = [                { name: '–ö—Ä–∞—Å–Ω—ã–π', color: '#ef4444' },                { name: '–°–∏–Ω–∏–π', color: '#3b82f6' },                { name: '–ó–µ–ª—ë–Ω—ã–π', color: '#22c55e' },                { name: '–ñ—ë–ª—Ç—ã–π', color: '#eab308' },                { name: '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π', color: '#a855f7' },                { name: '–û—Ä–∞–Ω–∂–µ–≤—ã–π', color: '#f97316' }            ];                        if (isPlayer1 && !game.rounds) {                const rounds = [];                for (let i = 0; i < 10; i++) {                    const correctColor = colors[Math.floor(Math.random() * colors.length)];                    const displayColor = colors[Math.floor(Math.random() * colors.length)];                    rounds.push({                        text: correctColor.name,                        displayColor: displayColor.color,                        correctColor: correctColor.color                    });                }                await db.ref('games/' + gameId + '/rounds').set(rounds);                await db.ref('games/' + gameId + '/current1').set(0);                await db.ref('games/' + gameId + '/current2').set(0);                await db.ref('games/' + gameId + '/score1').set(0);                await db.ref('games/' + gameId + '/score2').set(0);            }                        function render(data) {                if (!data.rounds) return;                                const myCurrent = isPlayer1 ? (data.current1 || 0) : (data.current2 || 0);                const oppCurrent = isPlayer1 ? (data.current2 || 0) : (data.current1 || 0);                const myScore = isPlayer1 ? (data.score1 || 0) : (data.score2 || 0);                const oppScore = isPlayer1 ? (data.score2 || 0) : (data.score1 || 0);                                if (myCurrent >= data.rounds.length || oppCurrent >= data.rounds.length) {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üé®</div>                            <div class="flex justify-center gap-8 mb-4">                                <div class="${myScore > oppScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–í—ã</p>                                    <p class="text-4xl font-bold">${myScore}/10</p>                                </div>                                <div class="${oppScore > myScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <p class="text-4xl font-bold">${oppScore}/10</p>                                </div>                            </div>                            <p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : myScore < oppScore ? 'text-red-400' : 'text-yellow-400'}">                                ${myScore > oppScore ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : myScore < oppScore ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}                            </p>                        </div>                    `;                    return;                }                                const round = data.rounds[myCurrent];                                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p class="text-lg">–í—ã: ${myCurrent + 1}/10</p>                        <p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: ${oppCurrent + 1}/10</p>                    </div>                    <div class="text-center mb-6">                        <p class="text-gray-300 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –¢–ï–ö–°–¢–ê:</p>                        <p class="text-5xl font-black" style="color: ${round.displayColor}">${round.text}</p>                    </div>                    <div class="grid grid-cols-3 gap-3">                        ${colors.map(c => `                            <button onclick="colorAnswer('${c.color}')" class="aspect-square rounded-xl transition-transform hover:scale-105" style="background: ${c.color}"></button>                        `).join('')}                    </div>                    <p class="text-center text-gray-400 mt-4 text-sm">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞!</p>                `;            }                        window.colorAnswer = async function(color) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const round = data.rounds[myCurrent];                                const currentField = isPlayer1 ? 'current1' : 'current2';                const scoreField = isPlayer1 ? 'score1' : 'score2';                                const updates = {};                updates[currentField] = myCurrent + 1;                                // Check if selected color matches the DISPLAY color (not the text meaning)                if (color === round.correctColor) {                    updates[scoreField] = (isPlayer1 ? data.score1 : data.score2) + 1;                }                                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // MEMORY GAME        function initMemory() {            document.getElementById('gameTitle').textContent = 'üß† –ú–µ–º–æ—Ä–∏';            const emojis = ['üéÆ', 'üé≤', 'üéØ', 'üé™', 'üé®', 'üé≠', 'üé∏', 'üé∫'];            let cards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);            let flipped = [];            let matched = [];            let moves = 0;            let startTime = Date.now();                        function render() {                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-lg">–•–æ–¥—ã: ${moves} | –ù–∞–π–¥–µ–Ω–æ: ${matched.length / 2}/${emojis.length}</p>                    </div>                    <div class="grid grid-cols-4 gap-2 max-w-sm mx-auto">                        ${cards.map((emoji, i) => `                            <div class="memory-card aspect-square cursor-pointer ${flipped.includes(i) || matched.includes(i) ? 'flipped' : ''}" onclick="flipCard(${i})">                                <div class="memory-card-inner w-full h-full relative">                                    <div class="memory-card-front absolute inset-0 glass rounded-xl flex items-center justify-center text-3xl">‚ùì</div>                                    <div class="memory-card-back absolute inset-0 glass rounded-xl flex items-center justify-center text-3xl ${matched.includes(i) ? 'bg-green-500/30' : 'bg-purple-500/30'}">${emoji}</div>                                </div>                            </div>                        `).join('')}                    </div>                    ${matched.length === cards.length ? `                        <div class="text-center mt-6">                            <p class="text-2xl font-bold text-green-400 mb-2">–ü–æ–±–µ–¥–∞! üéâ</p>                            <p class="text-gray-300">–í—Ä–µ–º—è: ${Math.round((Date.now() - startTime) / 1000)}—Å | –•–æ–¥—ã: ${moves}</p>                            <button onclick="initMemory()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>                        </div>                    ` : ''}                `;            }                        window.flipCard = function(i) {                if (flipped.length >= 2 || flipped.includes(i) || matched.includes(i)) return;                                flipped.push(i);                render();                                if (flipped.length === 2) {                    moves++;                    const [a, b] = flipped;                    if (cards[a] === cards[b]) {                        matched.push(a, b);                        flipped = [];                        render();                                                if (matched.length === cards.length) {                            const time = Math.round((Date.now() - startTime) / 1000);                            saveScore('memory', 10000 - (time * 10) - (moves * 5));                        }                    } else {                        setTimeout(() => {                            flipped = [];                            render();                        }, 1000);                    }                }            };                        render();        }        // REACTION GAME        function initReaction() {            document.getElementById('gameTitle').textContent = '‚ö° –¢–µ—Å—Ç —Ä–µ–∞–∫—Ü–∏–∏';            let state = 'waiting';            let startTime = 0;            let timeout = null;                        function render() {                let content = '';                if (state === 'waiting') {                    content = `                        <div onclick="startReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-blue-500/30 hover:bg-blue-500/50 transition-all">                            <div class="text-center">                                <div class="text-6xl mb-4">üëÜ</div>                                <p class="text-xl">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</p>                            </div>                        </div>                    `;                } else if (state === 'ready') {                    content = `                        <div onclick="tooEarly()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-red-500/30">                            <div class="text-center">                                <div class="text-6xl mb-4">‚è≥</div>                                <p class="text-xl">–ñ–¥–∏—Ç–µ –∑–µ–ª—ë–Ω—ã–π —Ü–≤–µ—Ç...</p>                            </div>                        </div>                    `;                } else if (state === 'go') {                    content = `                        <div onclick="clickReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-green-500/50 animate-pulse">                            <div class="text-center">                                <div class="text-6xl mb-4">‚ö°</div>                                <p class="text-xl font-bold">–ñ–ú–ò–¢–ï!</p>                            </div>                        </div>                    `;                } else if (state === 'result') {                    const time = Date.now() - startTime;                    content = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">‚ö°</div>                            <p class="text-4xl font-bold gradient-text mb-2">${time} –º—Å</p>                            <p class="text-gray-300 mb-6">${time < 200 ? '–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ! üî•' : time < 300 ? '–û—Ç–ª–∏—á–Ω–æ! üëç' : time < 400 ? '–•–æ—Ä–æ—à–æ! üòä' : '–ú–æ–∂–Ω–æ –ª—É—á—à–µ! üí™'}</p>                            <button onclick="initReaction()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>                    `;                    saveScore('reaction', Math.max(0, 1000 - time));                } else if (state === 'early') {                    content = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üòÖ</div>                            <p class="text-2xl font-bold text-red-400 mb-2">–°–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ!</p>                            <p class="text-gray-300 mb-6">–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–µ–ª—ë–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞</p>                            <button onclick="initReaction()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>                    `;                }                document.getElementById('gameContent').innerHTML = content;            }                        window.startReaction = function() {                state = 'ready';                render();                timeout = setTimeout(() => {                    state = 'go';                    startTime = Date.now();                    render();                }, Math.random() * 3000 + 1000);            };                        window.tooEarly = function() {                clearTimeout(timeout);                state = 'early';                render();            };                        window.clickReaction = function() {                state = 'result';                render();            };                        render();        }        // SNAKE GAME        function initSnake() {            document.getElementById('gameTitle').textContent = 'üêç –ó–º–µ–π–∫–∞';            const size = 15;            let snake = [{x: 7, y: 7}];            let food = {x: 5, y: 5};            let dir = {x: 1, y: 0};            let score = 0;            let gameOver = false;            let interval = null;                        function placeFood() {                do {                    food = {x: Math.floor(Math.random() * size), y: Math.floor(Math.random() * size)};                } while (snake.some(s => s.x === food.x && s.y === food.y));            }                        function render() {                let grid = '';                for (let y = 0; y < size; y++) {                    for (let x = 0; x < size; x++) {                        const isSnake = snake.some(s => s.x === x && s.y === y);                        const isHead = snake[0].x === x && snake[0].y === y;                        const isFood = food.x === x && food.y === y;                        grid += `<div class="aspect-square rounded-sm ${isHead ? 'bg-green-400' : isSnake ? 'bg-green-600' : isFood ? 'bg-red-500' : 'bg-white/10'}"></div>`;                    }                }                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-xl font-bold">–°—á—ë—Ç: ${score}</p>                    </div>                    <div class="grid gap-0.5 max-w-sm mx-auto" style="grid-template-columns: repeat(${size}, 1fr)">                        ${grid}                    </div>                    ${gameOver ? `                        <div class="text-center mt-6">                            <p class="text-2xl font-bold text-red-400 mb-2">–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</p>                            <button onclick="initSnake()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>                        </div>                    ` : `                        <div class="flex justify-center gap-2 mt-4">                            <button onclick="snakeDir(0,-1)" class="glass p-3 rounded-xl text-2xl">‚¨ÜÔ∏è</button>                        </div>                        <div class="flex justify-center gap-2 mt-2">                            <button onclick="snakeDir(-1,0)" class="glass p-3 rounded-xl text-2xl">‚¨ÖÔ∏è</button>                            <button onclick="snakeDir(0,1)" class="glass p-3 rounded-xl text-2xl">‚¨áÔ∏è</button>                            <button onclick="snakeDir(1,0)" class="glass p-3 rounded-xl text-2xl">‚û°Ô∏è</button>                        </div>                    `}                `;            }                        function move() {                if (gameOver) return;                                const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};                                if (head.x < 0 || head.x >= size || head.y < 0 || head.y >= size || snake.some(s => s.x === head.x && s.y === head.y)) {                    gameOver = true;                    clearInterval(interval);                    saveScore('snake', score);                    render();                    return;                }                                snake.unshift(head);                                if (head.x === food.x && head.y === food.y) {                    score += 10;                    placeFood();                } else {                    snake.pop();                }                                render();            }                        window.snakeDir = function(x, y) {                if ((x !== 0 && dir.x !== 0) || (y !== 0 && dir.y !== 0)) return;                dir = {x, y};            };                        document.onkeydown = (e) => {                if (e.key === 'ArrowUp') snakeDir(0, -1);                if (e.key === 'ArrowDown') snakeDir(0, 1);                if (e.key === 'ArrowLeft') snakeDir(-1, 0);                if (e.key === 'ArrowRight') snakeDir(1, 0);            };                        clearInterval(interval);            interval = setInterval(move, 150);            gameIntervals.push(interval);            render();        }        // QUIZ        const quizQuestions = [            {q: "–°—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏?", a: ["–ü–∞—Ä–∏–∂", "–õ–æ–Ω–¥–æ–Ω", "–ë–µ—Ä–ª–∏–Ω", "–ú–∞–¥—Ä–∏–¥"], c: 0},            {q: "2 + 2 √ó 2 = ?", a: ["6", "8", "4", "10"], c: 0},            {q: "–°–∞–º–∞—è –±–æ–ª—å—à–∞—è –ø–ª–∞–Ω–µ—Ç–∞?", a: ["–Æ–ø–∏—Ç–µ—Ä", "–°–∞—Ç—É—Ä–Ω", "–ó–µ–º–ª—è", "–ú–∞—Ä—Å"], c: 0},            {q: "–ì–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω–∏—è Google?", a: ["1998", "2000", "1995", "2004"], c: 0},            {q: "–°–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–æ–≤?", a: ["7", "6", "5", "8"], c: 0},            {q: "–•–∏–º–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª –≤–æ–¥—ã?", a: ["H2O", "CO2", "O2", "NaCl"], c: 0},            {q: "–°—Ç–æ–ª–∏—Ü–∞ –Ø–ø–æ–Ω–∏–∏?", a: ["–¢–æ–∫–∏–æ", "–ü–µ–∫–∏–Ω", "–°–µ—É–ª", "–ë–∞–Ω–≥–∫–æ–∫"], c: 0},            {q: "–°–∫–æ–ª—å–∫–æ —Ü–≤–µ—Ç–æ–≤ –≤ —Ä–∞–¥—É–≥–µ?", a: ["7", "6", "8", "5"], c: 0},        ];        function initQuiz() {            document.getElementById('gameTitle').textContent = 'üß© –í–∏–∫—Ç–æ—Ä–∏–Ω–∞';            let current = 0;            let score = 0;            const questions = [...quizQuestions].sort(() => Math.random() - 0.5).slice(0, 5);                        function render() {                if (current >= questions.length) {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üèÜ</div>                            <p class="text-3xl font-bold gradient-text mb-2">${score}/${questions.length}</p>                            <p class="text-gray-300 mb-6">${score === questions.length ? '–ò–¥–µ–∞–ª—å–Ω–æ! üî•' : score >= 3 ? '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üëç' : '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë! üí™'}</p>                            <button onclick="initQuiz()" class="btn-primary px-6 py-3 rounded-xl font-bold">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>                        </div>                    `;                    return;                }                                const q = questions[current];                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-6">                        <p class="text-gray-300">–í–æ–ø—Ä–æ—Å ${current + 1}/${questions.length}</p>                        <p class="text-2xl font-bold mt-2">${q.q}</p>                    </div>                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">                        ${q.a.map((ans, i) => `                            <button onclick="quizAnswer(${i})" class="glass p-4 rounded-xl text-lg font-bold hover:bg-purple-500/50 transition-all">${ans}</button>                        `).join('')}                    </div>                `;            }                        window.quizAnswer = function(i) {                if (i === questions[current].c) score++;                current++;                render();            };                        render();        }        async function initMultiplayerQuiz(gameId) {            document.getElementById('gameTitle').textContent = 'üß© –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ (–û–Ω–ª–∞–π–Ω)';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (!game.questions) {                const questions = [...quizQuestions].sort(() => Math.random() - 0.5).slice(0, 5);                await db.ref('games/' + gameId + '/questions').set(questions);                await db.ref('games/' + gameId + '/current').set(0);                await db.ref('games/' + gameId + '/score1').set(0);                await db.ref('games/' + gameId + '/score2').set(0);            }                        function render(data) {                if (!data.questions) return;                                const myScore = isPlayer1 ? data.score1 : data.score2;                const oppScore = isPlayer1 ? data.score2 : data.score1;                const myAnswer = isPlayer1 ? data.answer1 : data.answer2;                const oppAnswer = isPlayer1 ? data.answer2 : data.answer1;                                if (data.current >= data.questions.length) {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-6xl mb-4">üèÜ</div>                            <div class="flex justify-center gap-8 mb-4">                                <div class="${myScore > oppScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–í—ã</p>                                    <p class="text-3xl font-bold">${myScore}</p>                                </div>                                <div class="${oppScore > myScore ? 'glow-green' : ''} p-4 rounded-xl">                                    <p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <p class="text-3xl font-bold">${oppScore}</p>                                </div>                            </div>                            <p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : myScore < oppScore ? 'text-red-400' : 'text-yellow-400'}">${myScore > oppScore ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏! üéâ' : myScore < oppScore ? '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ üò¢' : '–ù–∏—á—å—è! ü§ù'}</p>                        </div>                    `;                    return;                }                                const q = data.questions[data.current];                                if (myAnswer !== undefined && myAnswer !== null && oppAnswer !== undefined && oppAnswer !== null) {                    setTimeout(async () => {                        await db.ref('games/' + gameId).update({                            current: data.current + 1,                            answer1: null,                            answer2: null                        });                    }, 1500);                }                                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p class="text-lg">–í—ã: ${myScore}</p>                        <p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: ${oppScore}</p>                    </div>                    <div class="text-center mb-6">                        <p class="text-gray-300">–í–æ–ø—Ä–æ—Å ${data.current + 1}/${data.questions.length}</p>                        <p class="text-2xl font-bold mt-2">${q.q}</p>                    </div>                    ${myAnswer !== undefined && myAnswer !== null ? `                        <div class="text-center">                            <p class="text-lg mb-2">–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏: ${q.a[myAnswer]}</p>                            ${oppAnswer !== undefined && oppAnswer !== null ? `<p class="text-lg">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –æ—Ç–≤–µ—Ç–∏–ª: ${q.a[oppAnswer]}</p>` : '<p class="text-gray-300">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>'}                        </div>                    ` : `                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">                            ${q.a.map((ans, i) => `                                <button onclick="multiQuizAnswer(${i})" class="glass p-4 rounded-xl text-lg font-bold hover:bg-purple-500/50 transition-all">${ans}</button>                            `).join('')}                        </div>                    `}                `;            }                        window.multiQuizAnswer = async function(i) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const q = data.questions[data.current];                                const answerField = isPlayer1 ? 'answer1' : 'answer2';                const scoreField = isPlayer1 ? 'score1' : 'score2';                const currentScore = isPlayer1 ? data.score1 : data.score2;                                const updates = {};                updates[answerField] = i;                if (i === q.c) updates[scoreField] = currentScore + 1;                                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => {                render(snap.val() || {});            });            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // Leaderboard        async function saveScore(game, score) {            if (!currentUser || score <= 0) return;                        const userData = await db.ref('users/' + currentUser.uid).once('value');            const username = userData.val()?.username || '–ò–≥—Ä–æ–∫';                        const existing = await db.ref('leaderboard/' + game).orderByChild('oderId').equalTo(currentUser.uid).once('value');            const data = existing.val();                        if (data) {                const key = Object.keys(data)[0];                if (data[key].score < score) {                    await db.ref('leaderboard/' + game + '/' + key + '/score').set(score);                }            } else {                await db.ref('leaderboard/' + game).push({                    oderId: currentUser.uid,                    username: username,                    score: score                });            }        }        async function showLeaderboard(game) {            document.querySelectorAll('.lb-btn').forEach(btn => btn.classList.remove('bg-purple-500'));            event.target.classList.add('bg-purple-500');                        const snap = await db.ref('leaderboard/' + game).orderByChild('score').limitToLast(10).once('value');            const data = snap.val() || {};                        const entries = Object.values(data).sort((a, b) => b.score - a.score);                        if (entries.length === 0) {                document.getElementById('leaderboardList').innerHTML = '<p class="text-gray-400 text-center">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>';                return;            }                        const medals = ['ü•á', 'ü•à', 'ü•â'];            document.getElementById('leaderboardList').innerHTML = entries.map((entry, i) => `                <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 ${entry.oderId === currentUser?.uid ? 'ring-2 ring-purple-500' : ''}">                    <div class="flex items-center gap-3">                        <span class="text-2xl">${medals[i] || (i + 1)}</span>                        <span class="font-bold">${entry.username}</span>                    </div>                    <span class="text-xl font-bold gradient-text">${entry.score}</span>                </div>            `).join('');        }        // Utils        function notify(text) {            const el = document.getElementById('notification');            document.getElementById('notificationText').textContent = text;            el.classList.remove('hidden', 'translate-y-20');            setTimeout(() => {                el.classList.add('translate-y-20');                setTimeout(() => el.classList.add('hidden'), 300);            }, 3000);        }        // Init        showSection('games');    </script></body></html>