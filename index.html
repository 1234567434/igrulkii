<!DOCTYPE html><html lang="ru"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>üéÆ GameZone Pro - –ò–≥—Ä–æ–≤–æ–π –ü–æ—Ä—Ç–∞–ª</title>    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;800;900&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">    <style>        * { font-family: 'Nunito', sans-serif; }        .logo-font { font-family: 'Orbitron', sans-serif; }                body {            background: linear-gradient(135deg, #0a0015 0%, #1a0a2e 25%, #16213e 50%, #0a1628 75%, #0d0d0d 100%);            min-height: 100vh;            overflow-x: hidden;        }                .animated-bg {            position: fixed;            top: 0;            left: 0;            width: 100%;            height: 100%;            z-index: -1;            background:                 radial-gradient(ellipse at 20% 20%, rgba(120, 0, 255, 0.15) 0%, transparent 50%),                radial-gradient(ellipse at 80% 80%, rgba(255, 0, 150, 0.15) 0%, transparent 50%),                radial-gradient(ellipse at 50% 50%, rgba(0, 200, 255, 0.1) 0%, transparent 60%);            animation: bgPulse 10s ease-in-out infinite;        }                @keyframes bgPulse {            0%, 100% { opacity: 1; }            50% { opacity: 0.7; }        }                .glass {            background: rgba(255, 255, 255, 0.05);            backdrop-filter: blur(20px);            border: 1px solid rgba(255, 255, 255, 0.1);        }                .glass-strong {            background: rgba(255, 255, 255, 0.1);            backdrop-filter: blur(30px);            border: 1px solid rgba(255, 255, 255, 0.2);        }                .neon-border {            border: 2px solid transparent;            background-clip: padding-box;            position: relative;        }                .neon-border::before {            content: '';            position: absolute;            top: -2px; right: -2px; bottom: -2px; left: -2px;            background: linear-gradient(135deg, #8b5cf6, #ec4899, #06b6d4, #8b5cf6);            border-radius: inherit;            z-index: -1;            animation: neonRotate 3s linear infinite;            background-size: 300% 300%;        }                @keyframes neonRotate {            0% { background-position: 0% 50%; }            50% { background-position: 100% 50%; }            100% { background-position: 0% 50%; }        }                .neon-glow {            box-shadow:                 0 0 20px rgba(139, 92, 246, 0.4),                0 0 40px rgba(139, 92, 246, 0.2),                0 0 60px rgba(139, 92, 246, 0.1),                inset 0 0 20px rgba(139, 92, 246, 0.05);        }                .neon-glow-pink {            box-shadow:                 0 0 20px rgba(236, 72, 153, 0.4),                0 0 40px rgba(236, 72, 153, 0.2),                0 0 60px rgba(236, 72, 153, 0.1);        }                .neon-glow-cyan {            box-shadow:                 0 0 20px rgba(6, 182, 212, 0.4),                0 0 40px rgba(6, 182, 212, 0.2),                0 0 60px rgba(6, 182, 212, 0.1);        }                .game-card {            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);            position: relative;            overflow: hidden;        }                .game-card::before {            content: '';            position: absolute;            top: 0;            left: -100%;            width: 100%;            height: 100%;            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);            transition: left 0.5s;        }                .game-card:hover::before {            left: 100%;        }                .game-card:hover {            transform: translateY(-15px) scale(1.03);            box-shadow:                 0 25px 50px rgba(139, 92, 246, 0.4),                0 0 100px rgba(139, 92, 246, 0.2);        }                .floating {            animation: floating 3s ease-in-out infinite;        }                .floating-delayed {            animation: floating 3s ease-in-out infinite;            animation-delay: 1.5s;        }                @keyframes floating {            0%, 100% { transform: translateY(0) rotate(0deg); }            25% { transform: translateY(-10px) rotate(2deg); }            75% { transform: translateY(-5px) rotate(-2deg); }        }                .pulse-glow {            animation: pulseGlow 2s ease-in-out infinite;        }                @keyframes pulseGlow {            0%, 100% {                 box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);                transform: scale(1);            }            50% {                 box-shadow: 0 0 50px rgba(139, 92, 246, 0.8), 0 0 80px rgba(236, 72, 153, 0.4);                transform: scale(1.02);            }        }                .gradient-text {            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 50%, #06b6d4 100%);            -webkit-background-clip: text;            -webkit-text-fill-color: transparent;            background-clip: text;            animation: gradientShift 5s ease infinite;            background-size: 200% 200%;        }                @keyframes gradientShift {            0% { background-position: 0% 50%; }            50% { background-position: 100% 50%; }            100% { background-position: 0% 50%; }        }                .rainbow-text {            background: linear-gradient(90deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);            background-size: 400% 100%;            -webkit-background-clip: text;            -webkit-text-fill-color: transparent;            animation: rainbowMove 3s linear infinite;        }                @keyframes rainbowMove {            0% { background-position: 0% 50%; }            100% { background-position: 400% 50%; }        }                .btn-primary {            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);            transition: all 0.3s ease;            position: relative;            overflow: hidden;        }                .btn-primary::before {            content: '';            position: absolute;            top: 0;            left: -100%;            width: 100%;            height: 100%;            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);            transition: left 0.5s;        }                .btn-primary:hover::before {            left: 100%;        }                .btn-primary:hover {            transform: scale(1.05) translateY(-2px);            box-shadow: 0 15px 40px rgba(139, 92, 246, 0.5);        }                .btn-game {            background: linear-gradient(135deg, #06b6d4 0%, #8b5cf6 100%);            transition: all 0.3s ease;        }                .btn-game:hover {            transform: scale(1.1);            box-shadow: 0 10px 30px rgba(6, 182, 212, 0.5);        }                .online-dot {            animation: onlinePulse 2s infinite;        }                @keyframes onlinePulse {            0%, 100% { opacity: 1; box-shadow: 0 0 10px #22c55e; }            50% { opacity: 0.6; box-shadow: 0 0 20px #22c55e; }        }                .particle {            position: fixed;            pointer-events: none;            border-radius: 50%;            animation: floatUp 20s linear infinite;        }                @keyframes floatUp {            0% { transform: translateY(100vh) rotate(0deg) scale(0); opacity: 0; }            10% { opacity: 1; transform: scale(1); }            90% { opacity: 0.8; }            100% { transform: translateY(-100vh) rotate(1080deg) scale(0.5); opacity: 0; }        }                .star {            position: fixed;            width: 3px;            height: 3px;            background: white;            border-radius: 50%;            animation: twinkle 2s ease-in-out infinite;        }                @keyframes twinkle {            0%, 100% { opacity: 0.3; transform: scale(1); }            50% { opacity: 1; transform: scale(1.5); }        }                .rainbow-border {            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);            background-size: 400%;            animation: rainbowMove 3s linear infinite;            padding: 3px;            border-radius: 1.5rem;        }                .gold-glow {            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);            animation: goldPulse 1.5s ease-in-out infinite;        }                @keyframes goldPulse {            0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }            50% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.9), 0 0 100px rgba(255, 215, 0, 0.4); }        }                .slide-in {            animation: slideIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);        }                @keyframes slideIn {            from { opacity: 0; transform: translateY(30px) scale(0.9); }            to { opacity: 1; transform: translateY(0) scale(1); }        }                .fade-in {            animation: fadeIn 0.5s ease-out;        }                @keyframes fadeIn {            from { opacity: 0; }            to { opacity: 1; }        }                .shake { animation: shake 0.5s infinite; }        @keyframes shake {            0%, 100% { transform: translateX(0) rotate(0); }            25% { transform: translateX(-15px) rotate(-2deg); }            75% { transform: translateX(15px) rotate(2deg); }        }                .flip-screen { transform: rotate(180deg); transition: transform 0.5s; }        .blur-screen { filter: blur(15px); transition: filter 0.5s; }        .invert-screen { filter: invert(1) hue-rotate(180deg); transition: filter 0.5s; }        .rainbow-bg { animation: rainbowBg 0.3s linear infinite; }        @keyframes rainbowBg { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }                .matrix-rain {            position: fixed;            top: 0;            left: 0;            width: 100%;            height: 100%;            pointer-events: none;            z-index: 9999;            background: rgba(0,0,0,0.95);            overflow: hidden;        }                .matrix-char {            position: absolute;            color: #0f0;            font-family: monospace;            font-size: 20px;            text-shadow: 0 0 10px #0f0;            animation: matrixFall 2s linear forwards;        }                @keyframes matrixFall {            0% { top: -20px; opacity: 1; }            100% { top: 100vh; opacity: 0; }        }                .admin-panel {            background: linear-gradient(135deg, #1a0a0a 0%, #2d1515 50%, #1a0a0a 100%);            border: 2px solid #ff0000;            box-shadow: 0 0 50px rgba(255, 0, 0, 0.5), inset 0 0 30px rgba(255, 0, 0, 0.1);        }                .troll-btn {            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);            transition: all 0.2s;            position: relative;            overflow: hidden;        }                .troll-btn:hover {            transform: scale(1.05);            box-shadow: 0 0 30px rgba(220, 38, 38, 0.6);        }                .cheat-btn {            background: linear-gradient(135deg, #059669 0%, #047857 100%);        }                .cheat-btn:hover {            box-shadow: 0 0 30px rgba(5, 150, 105, 0.6);        }                ::-webkit-scrollbar { width: 10px; }        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }        ::-webkit-scrollbar-thumb {             background: linear-gradient(135deg, #8b5cf6, #ec4899);             border-radius: 5px;        }        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #a78bfa, #f472b6); }                .cyber-grid {            background-image:                 linear-gradient(rgba(139, 92, 246, 0.1) 1px, transparent 1px),                linear-gradient(90deg, rgba(139, 92, 246, 0.1) 1px, transparent 1px);            background-size: 50px 50px;            animation: gridMove 20s linear infinite;        }                @keyframes gridMove {            0% { background-position: 0 0; }            100% { background-position: 50px 50px; }        }                .hexagon {            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);        }                .avatar-ring {            background: linear-gradient(135deg, #8b5cf6, #ec4899, #06b6d4);            padding: 3px;            border-radius: 50%;            animation: avatarPulse 3s ease-in-out infinite;        }                @keyframes avatarPulse {            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }            50% { box-shadow: 0 0 40px rgba(236, 72, 153, 0.7); }        }                .typing-indicator span {            animation: typing 1.4s infinite;            display: inline-block;        }        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }                @keyframes typing {            0%, 60%, 100% { transform: translateY(0); }            30% { transform: translateY(-10px); }        }                .progress-bar {            background: linear-gradient(90deg, #8b5cf6, #ec4899, #06b6d4);            background-size: 200% 100%;            animation: progressGlow 2s ease infinite;        }                @keyframes progressGlow {            0% { background-position: 0% 50%; }            50% { background-position: 100% 50%; }            100% { background-position: 0% 50%; }        }                .level-badge {            background: linear-gradient(135deg, #fbbf24, #f59e0b);            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);        }                .vip-badge {            background: linear-gradient(135deg, #a855f7, #ec4899);            box-shadow: 0 0 20px rgba(168, 85, 247, 0.5);        }                .tooltip {            position: relative;        }                .tooltip::after {            content: attr(data-tip);            position: absolute;            bottom: 100%;            left: 50%;            transform: translateX(-50%);            background: rgba(0,0,0,0.9);            color: white;            padding: 5px 10px;            border-radius: 5px;            font-size: 12px;            white-space: nowrap;            opacity: 0;            pointer-events: none;            transition: opacity 0.3s;        }                .tooltip:hover::after {            opacity: 1;        }                .notification-badge {            position: absolute;            top: -8px;            right: -8px;            background: linear-gradient(135deg, #ef4444, #dc2626);            min-width: 22px;            height: 22px;            border-radius: 11px;            display: flex;            align-items: center;            justify-content: center;            font-size: 12px;            font-weight: bold;            animation: badgePop 0.3s ease-out;            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);        }                @keyframes badgePop {            0% { transform: scale(0); }            50% { transform: scale(1.3); }            100% { transform: scale(1); }        }                .category-divider {            display: flex;            align-items: center;            gap: 1rem;            margin: 2rem 0;        }                .category-divider::before,        .category-divider::after {            content: '';            flex: 1;            height: 2px;            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.5), transparent);        }                .game-tag {            font-size: 0.7rem;            padding: 2px 8px;            border-radius: 10px;            text-transform: uppercase;            letter-spacing: 0.5px;        }                input:focus, button:focus {            outline: none;            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);        }                .fire-text {            background: linear-gradient(180deg, #ff0000, #ff7300, #fffb00);            -webkit-background-clip: text;            -webkit-text-fill-color: transparent;            animation: fireFlicker 0.5s ease-in-out infinite alternate;        }                @keyframes fireFlicker {            0% { filter: brightness(1); }            100% { filter: brightness(1.3); }        }    </style></head><body class="text-white">    <div class="animated-bg"></div>    <div class="cyber-grid fixed inset-0 pointer-events-none opacity-30"></div>    <div id="particles"></div>    <div id="stars"></div>    <!-- AUTH SCREEN -->    <div id="authScreen" class="min-h-screen flex items-center justify-center p-4 relative">        <div class="absolute top-10 left-1/2 -translate-x-1/2 text-center">            <h1 class="text-6xl md:text-8xl font-black logo-font rainbow-text mb-4">GAMEZONE</h1>            <p class="text-xl text-gray-400">–ò–≥—Ä–∞–π —Å –¥—Ä—É–∑—å—è–º–∏ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É! üåç</p>        </div>                <div class="glass-strong rounded-3xl p-8 w-full max-w-md neon-glow slide-in mt-32">            <div class="text-center mb-8">                <div class="text-7xl mb-4 floating">üéÆ</div>                <h2 class="text-3xl font-black gradient-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>            </div>                        <div id="authTabs" class="flex mb-6 glass rounded-2xl p-1.5">                <button onclick="showAuthTab('login')" id="loginTab" class="flex-1 py-3 rounded-xl bg-purple-500 font-bold transition-all duration-300">üîê –í—Ö–æ–¥</button>                <button onclick="showAuthTab('register')" id="registerTab" class="flex-1 py-3 rounded-xl font-bold transition-all duration-300 hover:bg-white/10">‚ú® –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>            </div>                        <div id="loginForm" class="space-y-4">                <div class="relative">                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl">üìß</span>                    <input type="email" id="loginEmail" placeholder="Email" class="w-full p-4 pl-12 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                </div>                <div class="relative">                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl">üîí</span>                    <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 pl-12 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                </div>                <button onclick="login()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–í–æ–π—Ç–∏ üöÄ</button>            </div>                        <div id="registerForm" class="space-y-4 hidden">                <div class="relative">                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl">üë§</span>                    <input type="text" id="regUsername" placeholder="–ù–∏–∫–Ω–µ–π–º" class="w-full p-4 pl-12 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                </div>                <div class="relative">                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl">üìß</span>                    <input type="email" id="regEmail" placeholder="Email" class="w-full p-4 pl-12 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                </div>                <div class="relative">                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl">üîí</span>                    <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 pl-12 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                </div>                <button onclick="register()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç ‚ú®</button>            </div>                        <p id="authError" class="text-red-400 text-center mt-4 hidden"></p>        </div>    </div>    <!-- MAIN APP -->    <div id="mainApp" class="hidden">        <!-- HEADER -->        <header class="glass-strong sticky top-0 z-50 px-4 md:px-8 py-4">            <div class="max-w-7xl mx-auto flex items-center justify-between">                <h1 class="text-2xl md:text-3xl font-black logo-font gradient-text cursor-pointer" onclick="showSection('games')">üéÆ GAMEZONE</h1>                                <div class="flex items-center gap-3 md:gap-6">                    <div class="hidden md:flex items-center gap-2 glass rounded-full px-4 py-2">                        <span class="text-yellow-400">üèÜ</span>                        <span id="userCoins" class="font-bold">0</span>                    </div>                                        <div class="flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity" onclick="showSection('profile')">                        <div class="avatar-ring">                            <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br from-purple-600 to-pink-600 flex items-center justify-center font-bold text-lg" id="userAvatar">?</div>                        </div>                        <div class="hidden md:block">                            <p id="userName" class="font-bold">–ò–≥—Ä–æ–∫</p>                            <p class="text-xs text-gray-400">–û–Ω–ª–∞–π–Ω</p>                        </div>                    </div>                                        <button onclick="logout()" class="glass p-3 rounded-xl hover:bg-red-500/30 transition-all tooltip" data-tip="–í—ã–π—Ç–∏">üö™</button>                </div>            </div>        </header>        <!-- NAVIGATION -->        <nav class="flex justify-center gap-2 md:gap-4 p-4 flex-wrap">            <button onclick="showSection('games')" class="nav-btn px-4 md:px-8 py-3 rounded-2xl glass font-bold hover:bg-purple-500/30 transition-all flex items-center gap-2" data-section="games">                <span class="text-xl">üéÆ</span>                <span class="hidden sm:inline">–ò–≥—Ä—ã</span>            </button>            <button onclick="showSection('friends')" class="nav-btn px-4 md:px-8 py-3 rounded-2xl glass font-bold hover:bg-purple-500/30 transition-all flex items-center gap-2" data-section="friends">                <span class="text-xl">üë•</span>                <span class="hidden sm:inline">–î—Ä—É–∑—å—è</span>            </button>            <button onclick="showSection('leaderboard')" class="nav-btn px-4 md:px-8 py-3 rounded-2xl glass font-bold hover:bg-purple-500/30 transition-all flex items-center gap-2" data-section="leaderboard">                <span class="text-xl">üèÜ</span>                <span class="hidden sm:inline">–†–µ–π—Ç–∏–Ω–≥</span>            </button>            <button onclick="showSection('invites')" class="nav-btn px-4 md:px-8 py-3 rounded-2xl glass font-bold hover:bg-purple-500/30 transition-all flex items-center gap-2 relative" data-section="invites">                <span class="text-xl">üì®</span>                <span class="hidden sm:inline">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</span>                <span id="invitesBadge" class="notification-badge hidden">0</span>            </button>        </nav>        <!-- GAMES SECTION -->        <section id="gamesSection" class="max-w-7xl mx-auto p-4 md:p-6">            <div class="text-center mb-8">                <h2 class="text-4xl md:text-5xl font-black gradient-text mb-2">üéÆ –ò–≥—Ä–æ–≤–æ–π –¶–µ–Ω—Ç—Ä</h2>                <p class="text-gray-400">–í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏ –ø—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–∑–µ–π!</p>            </div>                        <!-- TOP GAMES -->            <div class="category-divider">                <span class="text-xl font-bold fire-text">üî• –¢–û–ü –ò–ì–†–´</span>            </div>                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">                <div class="rainbow-border cursor-pointer" onclick="openGame('heist')">                    <div class="game-card glass rounded-3xl p-6 h-full">                        <div class="flex justify-between items-start mb-4">                            <div class="text-6xl floating">üè¶</div>                            <span class="game-tag bg-red-500/30 text-red-300">üî• –•–ò–¢</span>                        </div>                        <h3 class="text-2xl font-black mb-2">–û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞</h3>                        <p class="text-gray-400 mb-4">–ì—Ä–∞–±–∏—Ç–µ–ª—å vs –ü–æ–ª–∏—Ü–∏—è! –£–∫—Ä–∞–¥–∏ –∑–æ–ª–æ—Ç–æ –∏ —É–±–µ–≥–∏!</p>                        <div class="flex gap-2">                            <span class="game-tag bg-purple-500/30 text-purple-300">üë• 2 –∏–≥—Ä–æ–∫–∞</span>                            <span class="game-tag bg-green-500/30 text-green-300">‚ö° –≠–∫—à–Ω</span>                        </div>                    </div>                </div>                                <div class="game-card glass rounded-3xl p-6 cursor-pointer gold-glow" onclick="openGame('seabattle')">                    <div class="flex justify-between items-start mb-4">                        <div class="text-6xl floating">üö¢</div>                        <span class="game-tag bg-blue-500/30 text-blue-300">‚≠ê NEW</span>                    </div>                    <h3 class="text-2xl font-black mb-2">–ú–æ—Ä—Å–∫–æ–π –ë–æ–π</h3>                    <p class="text-gray-400 mb-4">–†–∞—Å—Å—Ç–∞–≤—å –∫–æ—Ä–∞–±–ª–∏ –∏ –ø–æ—Ç–æ–ø–∏ —Ñ–ª–æ—Ç –≤—Ä–∞–≥–∞!</p>                    <div class="flex gap-2">                        <span class="game-tag bg-purple-500/30 text-purple-300">üë• 2 –∏–≥—Ä–æ–∫–∞</span>                        <span class="game-tag bg-cyan-500/30 text-cyan-300">üß† –°—Ç—Ä–∞—Ç–µ–≥–∏—è</span>                    </div>                </div>                                <div class="game-card glass rounded-3xl p-6 cursor-pointer neon-glow-pink" onclick="openGame('tanks')">                    <div class="flex justify-between items-start mb-4">                        <div class="text-6xl floating">üî´</div>                        <span class="game-tag bg-orange-500/30 text-orange-300">‚öîÔ∏è PvP</span>                    </div>                    <h3 class="text-2xl font-black mb-2">–¢–∞–Ω–∫–æ–≤—ã–π –ë–æ–π</h3>                    <p class="text-gray-400 mb-4">–£–Ω–∏—á—Ç–æ–∂—å –≤—Ä–∞–∂–µ—Å–∫–∏–π —Ç–∞–Ω–∫ –ø–µ—Ä–≤—ã–º!</p>                    <div class="flex gap-2">                        <span class="game-tag bg-purple-500/30 text-purple-300">üë• 2 –∏–≥—Ä–æ–∫–∞</span>                        <span class="game-tag bg-red-500/30 text-red-300">üí• –®—É—Ç–µ—Ä</span>                    </div>                </div>            </div>                        <!-- MULTIPLAYER GAMES -->            <div class="category-divider">                <span class="text-xl font-bold text-purple-400">üë• –ú–£–õ–¨–¢–ò–ü–õ–ï–ï–†</span>            </div>                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 mb-8">                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('tictactoe')">                    <div class="text-4xl mb-3 floating">‚ùå‚≠ï</div>                    <h3 class="text-lg font-bold mb-1">–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</h3>                    <span class="game-tag bg-purple-500/30 text-purple-300">–ö–ª–∞—Å—Å–∏–∫–∞</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('rps')">                    <div class="text-4xl mb-3 floating-delayed">‚úä‚úã‚úåÔ∏è</div>                    <h3 class="text-lg font-bold mb-1">–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã</h3>                    <span class="game-tag bg-green-500/30 text-green-300">–ë—ã—Å—Ç—Ä–∞—è</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('pong')">                    <div class="text-4xl mb-3 floating">üèì</div>                    <h3 class="text-lg font-bold mb-1">–ü–æ–Ω–≥</h3>                    <span class="game-tag bg-cyan-500/30 text-cyan-300">–ê—Ä–∫–∞–¥–∞</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('duel')">                    <div class="text-4xl mb-3 floating-delayed">‚öîÔ∏è</div>                    <h3 class="text-lg font-bold mb-1">–î—É—ç–ª—å</h3>                    <span class="game-tag bg-red-500/30 text-red-300">–†–µ–∞–∫—Ü–∏—è</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('fruitcatcher')">                    <div class="text-4xl mb-3 floating">üß∫üçé</div>                    <h3 class="text-lg font-bold mb-1">–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤</h3>                    <span class="game-tag bg-yellow-500/30 text-yellow-300">–ê—Ä–∫–∞–¥–∞</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('clickbattle')">                    <div class="text-4xl mb-3 floating-delayed">üëÜüí•</div>                    <h3 class="text-lg font-bold mb-1">–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª</h3>                    <span class="game-tag bg-pink-500/30 text-pink-300">–°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('mathbattle')">                    <div class="text-4xl mb-3 floating">üî¢‚öîÔ∏è</div>                    <h3 class="text-lg font-bold mb-1">–ú–∞—Ç–µ–º. –ë–æ–π</h3>                    <span class="game-tag bg-blue-500/30 text-blue-300">–ú–æ–∑–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('colormatch')">                    <div class="text-4xl mb-3 floating-delayed">üé®üèÉ</div>                    <h3 class="text-lg font-bold mb-1">–¶–≤–µ—Ç–æ–≤–∞—è –ì–æ–Ω–∫–∞</h3>                    <span class="game-tag bg-indigo-500/30 text-indigo-300">–°–∫–æ—Ä–æ—Å—Ç—å</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('runner')">                    <div class="text-4xl mb-3 floating">üèÉüí®</div>                    <h3 class="text-lg font-bold mb-1">–ì–æ–Ω–∫–∞</h3>                    <span class="game-tag bg-orange-500/30 text-orange-300">–†–µ–∞–∫—Ü–∏—è</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('quiz')">                    <div class="text-4xl mb-3 floating-delayed">üß†‚ùì</div>                    <h3 class="text-lg font-bold mb-1">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</h3>                    <span class="game-tag bg-violet-500/30 text-violet-300">–ó–Ω–∞–Ω–∏—è</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('memory2p')">                    <div class="text-4xl mb-3 floating">üÉèüÉè</div>                    <h3 class="text-lg font-bold mb-1">–ú–µ–º–æ—Ä–∏ 2P</h3>                    <span class="game-tag bg-emerald-500/30 text-emerald-300">–ü–∞–º—è—Ç—å</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow" onclick="openGame('bomber')">                    <div class="text-4xl mb-3 floating-delayed">üí£üî•</div>                    <h3 class="text-lg font-bold mb-1">–ë–æ–º–±–µ—Ä–º–µ–Ω</h3>                    <span class="game-tag bg-rose-500/30 text-rose-300">–≠–∫—à–Ω</span>                </div>            </div>                        <!-- SOLO GAMES -->            <div class="category-divider">                <span class="text-xl font-bold text-cyan-400">üèÜ –û–î–ò–ù–û–ß–ù–´–ï</span>            </div>                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('memory')">                    <div class="text-4xl mb-3 floating">üß†</div>                    <h3 class="text-lg font-bold mb-1">–ú–µ–º–æ—Ä–∏</h3>                    <span class="game-tag bg-cyan-500/30 text-cyan-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('reaction')">                    <div class="text-4xl mb-3 floating-delayed">‚ö°</div>                    <h3 class="text-lg font-bold mb-1">–†–µ–∞–∫—Ü–∏—è</h3>                    <span class="game-tag bg-yellow-500/30 text-yellow-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('snake')">                    <div class="text-4xl mb-3 floating">üêç</div>                    <h3 class="text-lg font-bold mb-1">–ó–º–µ–π–∫–∞</h3>                    <span class="game-tag bg-green-500/30 text-green-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('flappy')">                    <div class="text-4xl mb-3 floating-delayed">üê¶</div>                    <h3 class="text-lg font-bold mb-1">Flappy Bird</h3>                    <span class="game-tag bg-sky-500/30 text-sky-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('tetris')">                    <div class="text-4xl mb-3 floating">üß±</div>                    <h3 class="text-lg font-bold mb-1">–¢–µ—Ç—Ä–∏—Å</h3>                    <span class="game-tag bg-purple-500/30 text-purple-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('2048')">                    <div class="text-4xl mb-3 floating-delayed">üî¢</div>                    <h3 class="text-lg font-bold mb-1">2048</h3>                    <span class="game-tag bg-amber-500/30 text-amber-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('asteroids')">                    <div class="text-4xl mb-3 floating">üöÄ‚òÑÔ∏è</div>                    <h3 class="text-lg font-bold mb-1">–ê—Å—Ç–µ—Ä–æ–∏–¥—ã</h3>                    <span class="game-tag bg-slate-500/30 text-slate-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>                                <div class="game-card glass rounded-2xl p-4 cursor-pointer hover:neon-glow-cyan" onclick="openGame('typing')">                    <div class="text-4xl mb-3 floating-delayed">‚å®Ô∏è</div>                    <h3 class="text-lg font-bold mb-1">–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—á–∞—Ç–∏</h3>                    <span class="game-tag bg-teal-500/30 text-teal-300">–†–µ–π—Ç–∏–Ω–≥</span>                </div>            </div>        </section>        <!-- FRIENDS SECTION -->        <section id="friendsSection" class="max-w-4xl mx-auto p-4 md:p-6 hidden">            <h2 class="text-4xl font-black gradient-text text-center mb-8">üë• –î—Ä—É–∑—å—è</h2>                        <div class="glass-strong rounded-3xl p-6 mb-6 neon-glow">                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">                    <span class="text-2xl">‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞                </h3>                <div class="flex gap-4 flex-wrap">                    <input type="text" id="friendEmail" placeholder="üìß Email –¥—Ä—É–≥–∞" class="flex-1 min-w-[200px] p-4 rounded-xl bg-white/5 border border-white/10 focus:border-purple-500 transition-all">                    <button onclick="addFriend()" class="btn-primary px-8 rounded-xl font-bold">–î–æ–±–∞–≤–∏—Ç—å ‚ú®</button>                </div>            </div>                        <div class="glass-strong rounded-3xl p-6 mb-6">                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">                    <span class="text-2xl">üì®</span> –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è                </h3>                <div id="friendRequests" class="space-y-3">                    <p class="text-gray-400 text-center py-4">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>                </div>            </div>                        <div class="glass-strong rounded-3xl p-6">                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">                    <span class="text-2xl">üíú</span> –ú–æ–∏ –¥—Ä—É–∑—å—è                </h3>                <div id="friendsList" class="space-y-3">                    <p class="text-gray-400 text-center py-4">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ! üòä</p>                </div>            </div>        </section>        <!-- LEADERBOARD SECTION -->        <section id="leaderboardSection" class="max-w-4xl mx-auto p-4 md:p-6 hidden">            <h2 class="text-4xl font-black gradient-text text-center mb-8">üèÜ –¢–∞–±–ª–∏—Ü–∞ –õ–∏–¥–µ—Ä–æ–≤</h2>                        <div class="flex gap-2 mb-6 flex-wrap justify-center">                <button onclick="showLeaderboard('snake')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">üêç –ó–º–µ–π–∫–∞</button>                <button onclick="showLeaderboard('memory')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">üß† –ú–µ–º–æ—Ä–∏</button>                <button onclick="showLeaderboard('reaction')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">‚ö° –†–µ–∞–∫—Ü–∏—è</button>                <button onclick="showLeaderboard('flappy')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">üê¶ Flappy</button>                <button onclick="showLeaderboard('tetris')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">üß± –¢–µ—Ç—Ä–∏—Å</button>                <button onclick="showLeaderboard('2048')" class="lb-btn px-4 py-2 rounded-xl glass font-bold hover:bg-purple-500/30">üî¢ 2048</button>            </div>                        <div id="leaderboardContent" class="glass-strong rounded-3xl p-6 neon-glow">                <div id="leaderboardList" class="space-y-3">                    <p class="text-gray-400 text-center py-8">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞</p>                </div>            </div>        </section>        <!-- INVITES SECTION -->        <section id="invitesSection" class="max-w-4xl mx-auto p-4 md:p-6 hidden">            <h2 class="text-4xl font-black gradient-text text-center mb-8">üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h2>                        <div id="gameInvites" class="glass-strong rounded-3xl p-6 neon-glow">                <p class="text-gray-400 text-center py-8">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>            </div>        </section>    </div>    <!-- GAME MODAL -->    <div id="gameModal" class="fixed inset-0 bg-black/95 backdrop-blur-lg z-50 hidden flex items-center justify-center p-4">        <div class="glass-strong rounded-3xl p-6 w-full max-w-4xl max-h-[95vh] overflow-y-auto neon-glow slide-in">            <div class="flex justify-between items-center mb-6">                <h2 id="gameTitle" class="text-2xl md:text-3xl font-black gradient-text">–ò–≥—Ä–∞</h2>                <button onclick="closeGame()" class="text-3xl hover:scale-125 transition-transform hover:rotate-90 duration-300">‚ùå</button>            </div>            <div id="gameContent"></div>        </div>    </div>    <!-- ADMIN PANEL -->    <div id="adminPanel" class="fixed inset-0 bg-black/98 z-[100] hidden flex items-center justify-center p-4 overflow-y-auto">        <div class="admin-panel rounded-3xl p-6 w-full max-w-3xl max-h-[95vh] overflow-y-auto slide-in">            <div class="flex justify-between items-center mb-6">                <h2 class="text-3xl font-black text-red-500 flex items-center gap-3">                    <span class="animate-pulse">üî¥</span> ADMIN TROLL PANEL <span class="animate-pulse">üî¥</span>                </h2>                <button onclick="closeAdminPanel()" class="text-3xl hover:scale-125 transition-transform">‚ùå</button>            </div>                        <div class="glass rounded-xl p-4 mb-6">                <p class="text-gray-400">–¶–µ–ª—å: <span id="opponentName" class="text-white font-bold text-lg">–ù–∏–∫–æ–≥–æ</span></p>                <div class="flex gap-4 mt-2">                    <p class="text-yellow-400">‚≠ê Godmode: <span id="godmodeStatus" class="font-bold">OFF</span></p>                    <p class="text-cyan-400">‚ö° Speed: <span id="speedStatus" class="font-bold">x1</span></p>                </div>            </div>                        <h3 class="text-xl font-bold text-red-400 mb-3 flex items-center gap-2">üòà –¢—Ä–æ–ª–ª—å-–∞—Ç–∞–∫–∏</h3>            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mb-6">                <button onclick="trollAction('screamer')" class="troll-btn p-3 rounded-xl font-bold">üò± –°–∫—Ä–∏–º–µ—Ä</button>                <button onclick="trollAction('shake')" class="troll-btn p-3 rounded-xl font-bold">üì≥ –¢—Ä—è—Å–∫–∞</button>                <button onclick="trollAction('flip')" class="troll-btn p-3 rounded-xl font-bold">üôÉ –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç</button>                <button onclick="trollAction('blur')" class="troll-btn p-3 rounded-xl font-bold">üå´Ô∏è –†–∞–∑–º—ã—Ç–∏–µ</button>                <button onclick="trollAction('invert')" class="troll-btn p-3 rounded-xl font-bold">üîÑ –ò–Ω–≤–µ—Ä—Å–∏—è</button>                <button onclick="trollAction('rainbow')" class="troll-btn p-3 rounded-xl font-bold">üåà –†–∞–¥—É–≥–∞</button>                <button onclick="trollAction('matrix')" class="troll-btn p-3 rounded-xl font-bold">üíª –ú–∞—Ç—Ä–∏—Ü–∞</button>                <button onclick="trollAction('fakeerror')" class="troll-btn p-3 rounded-xl font-bold">‚ö†Ô∏è –û—à–∏–±–∫–∞</button>                <button onclick="trollAction('jumpscare')" class="troll-btn p-3 rounded-xl font-bold">üëª Jumpscare</button>                <button onclick="trollAction('spam')" class="troll-btn p-3 rounded-xl font-bold">üì¢ –°–ø–∞–º</button>                <button onclick="trollAction('freeze')" class="troll-btn p-3 rounded-xl font-bold">ü•∂ –ó–∞–º–æ—Ä–æ–∑–∫–∞</button>                <button onclick="trollAction('disconnect')" class="troll-btn p-3 rounded-xl font-bold">üì¥ Fake DC</button>                <button onclick="trollAction('rickroll')" class="troll-btn p-3 rounded-xl font-bold">üéµ Rickroll</button>                <button onclick="trollAction('confetti')" class="troll-btn p-3 rounded-xl font-bold">üéä –ö–æ–Ω—Ñ–µ—Ç—Ç–∏</button>                <button onclick="trollAction('zalgo')" class="troll-btn p-3 rounded-xl font-bold">üëÅÔ∏è Zalgo</button>                <button onclick="trollAction('earrape')" class="troll-btn p-3 rounded-xl font-bold">üîä LOUD</button>            </div>                        <h3 class="text-xl font-bold text-green-400 mb-3 flex items-center gap-2">‚öîÔ∏è –ò–≥—Ä–æ–≤—ã–µ —á–∏—Ç—ã</h3>            <div class="grid grid-cols-2 gap-3 mb-6">                <button onclick="trollAction('forcewin')" class="cheat-btn troll-btn p-4 rounded-xl font-bold text-lg">üèÜ –§–û–†–° –ü–û–ë–ï–î–ê</button>                <button onclick="trollAction('forcelose')" class="troll-btn p-4 rounded-xl font-bold text-lg">üíÄ –°–õ–ò–¢–¨ –í–†–ê–ì–ê</button>                <button onclick="toggleGodmode()" id="godmodeBtn" class="troll-btn p-4 rounded-xl font-bold text-lg bg-gradient-to-r from-yellow-600 to-amber-700">‚≠ê –ë–ï–°–°–ú–ï–†–¢–ò–ï</button>                <button onclick="toggleSpeedhack()" id="speedBtn" class="troll-btn p-4 rounded-xl font-bold text-lg bg-gradient-to-r from-cyan-600 to-blue-700">‚ö° –°–ö–û–†–û–°–¢–¨ x3</button>            </div>                        <h3 class="text-xl font-bold text-purple-400 mb-3 flex items-center gap-2">üé≠ –ë–æ–Ω—É—Å—ã</h3>            <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">                <button onclick="trollAction('addcoins')" class="troll-btn p-3 rounded-xl font-bold bg-gradient-to-r from-yellow-600 to-yellow-800">üí∞ +1000 –º–æ–Ω–µ—Ç</button>                <button onclick="trollAction('resetopp')" class="troll-btn p-3 rounded-xl font-bold bg-gradient-to-r from-red-700 to-red-900">üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –≤—Ä–∞–≥–∞</button>                <button onclick="trollAction('teleport')" class="troll-btn p-3 rounded-xl font-bold bg-gradient-to-r from-purple-600 to-pink-700">üåÄ –¢–µ–ª–µ–ø–æ—Ä—Ç</button>            </div>        </div>    </div>    <!-- TROLL OVERLAY -->    <div id="trollOverlay" class="fixed inset-0 z-[200] hidden pointer-events-none"></div>        <!-- NOTIFICATION -->    <div id="notification" class="fixed bottom-4 right-4 glass-strong rounded-2xl p-4 hidden transform translate-y-20 transition-all duration-500 z-50 neon-glow max-w-sm">        <p id="notificationText" class="font-bold"></p>    </div>    <script>        // Firebase Config        const firebaseConfig = {            apiKey: "AIzaSyBKDnOlEP4wb8YfZkJ-b5qVzbZmCBn6G3A",            authDomain: "bucktupogub-ae41a.firebaseapp.com",            databaseURL: "https://bucktupogub-ae41a-default-rtdb.firebaseio.com",            projectId: "bucktupogub-ae41a",            storageBucket: "bucktupogub-ae41a.firebasestorage.app",            messagingSenderId: "974220682292",            appId: "1:974220682292:web:16f3696389804f2f4a5661",            measurementId: "G-QTZ59V95LN"        };        firebase.initializeApp(firebaseConfig);        const auth = firebase.auth();        const db = firebase.database();        // Global State        let currentUser = null, currentGameId = null, currentOpponentId = null;        let gameListeners = [], gameIntervals = [];        let isAdmin = false, godmodeEnabled = false, speedHack = 1;        const ADMIN_EMAIL = 'nilnil20@gmail.com';        // Create Particles & Stars        function createParticles() {            const container = document.getElementById('particles');            const colors = ['#8b5cf6', '#ec4899', '#06b6d4', '#10b981', '#f59e0b', '#ef4444'];            for (let i = 0; i < 30; i++) {                const p = document.createElement('div');                p.className = 'particle';                const size = Math.random() * 10 + 5;                p.style.cssText = `left:${Math.random()*100}%;width:${size}px;height:${size}px;background:${colors[Math.floor(Math.random()*colors.length)]};animation-delay:${Math.random()*20}s;opacity:${Math.random()*0.5+0.2}`;                container.appendChild(p);            }        }        function createStars() {            const container = document.getElementById('stars');            for (let i = 0; i < 100; i++) {                const s = document.createElement('div');                s.className = 'star';                s.style.cssText = `left:${Math.random()*100}%;top:${Math.random()*100}%;animation-delay:${Math.random()*2}s`;                container.appendChild(s);            }        }        createParticles();        createStars();        // Admin Panel Toggle (Right Ctrl)        document.addEventListener('keydown', (e) => {            if (e.key === 'Control' && e.location === 2 && isAdmin) {                document.getElementById('adminPanel').classList.toggle('hidden');            }        });        function closeAdminPanel() { document.getElementById('adminPanel').classList.add('hidden'); }        function toggleGodmode() {            godmodeEnabled = !godmodeEnabled;            document.getElementById('godmodeStatus').textContent = godmodeEnabled ? 'ON ‚úÖ' : 'OFF';            document.getElementById('godmodeBtn').classList.toggle('ring-4', godmodeEnabled);            document.getElementById('godmodeBtn').classList.toggle('ring-yellow-400', godmodeEnabled);            notify(godmodeEnabled ? '‚≠ê –ë–µ—Å—Å–º–µ—Ä—Ç–∏–µ –í–ö–õ–Æ–ß–ï–ù–û!' : '‚≠ê –ë–µ—Å—Å–º–µ—Ä—Ç–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–æ');        }        function toggleSpeedhack() {            speedHack = speedHack === 1 ? 3 : 1;            document.getElementById('speedStatus').textContent = 'x' + speedHack;            document.getElementById('speedBtn').classList.toggle('ring-4', speedHack > 1);            document.getElementById('speedBtn').classList.toggle('ring-cyan-400', speedHack > 1);            notify('‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: x' + speedHack);        }        // Troll Actions        async function trollAction(action) {            if (action === 'addcoins') {                const current = parseInt(document.getElementById('userCoins').textContent) || 0;                await db.ref('users/' + currentUser.uid + '/coins').set(current + 1000);                document.getElementById('userCoins').textContent = current + 1000;                notify('üí∞ +1000 –º–æ–Ω–µ—Ç!');                return;            }            if (!currentGameId || !currentOpponentId) {                notify('‚ùå –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä—ã!');                return;            }            if (action === 'forcewin' || action === 'forcelose') {                const snap = await db.ref('games/' + currentGameId).once('value');                const game = snap.val();                if (!game) return;                                const isP1 = game.player1 === currentUser.uid;                let winner;                                if (['heist'].includes(game.type)) {                    winner = action === 'forcewin' ? (isP1 ? 'robber' : 'police') : (isP1 ? 'police' : 'robber');                } else if (['tictactoe'].includes(game.type)) {                    winner = action === 'forcewin' ? (isP1 ? 'X' : 'O') : (isP1 ? 'O' : 'X');                } else {                    winner = action === 'forcewin' ? (isP1 ? 1 : 2) : (isP1 ? 2 : 1);                }                                await db.ref('games/' + currentGameId + '/winner').set(winner);                notify('üèÜ ' + (action === 'forcewin' ? '–ü–æ–±–µ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!' : '–í—Ä–∞–≥ —Å–ª–∏—Ç!'));                return;            }            // Send troll effect to opponent            await db.ref('trollEffects/' + currentOpponentId).set({                action, timestamp: Date.now(), from: currentUser.uid            });            notify('üòà –¢—Ä–æ–ª–ª—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');        }        // Listen for troll effects        function setupTrollListener() {            if (!currentUser) return;            db.ref('trollEffects/' + currentUser.uid).on('value', (snap) => {                const effect = snap.val();                if (!effect || Date.now() - effect.timestamp > 5000) return;                applyTrollEffect(effect.action);                db.ref('trollEffects/' + currentUser.uid).remove();            });        }        function applyTrollEffect(action) {            const overlay = document.getElementById('trollOverlay');            const body = document.body;            switch(action) {                case 'screamer':                    overlay.innerHTML = `<div class="w-full h-full bg-black flex items-center justify-center"><img src="https://i.imgflip.com/3vf4gd.png" class="max-w-full max-h-full animate-pulse" style="transform:scale(1.5)"></div>`;                    overlay.classList.remove('hidden');                    overlay.style.pointerEvents = 'auto';                    try { new Audio('https://www.myinstants.com/media/sounds/fnaf-scream.mp3').play(); } catch(e){}                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; overlay.style.pointerEvents = 'none'; }, 3000);                    break;                case 'shake': body.classList.add('shake'); setTimeout(() => body.classList.remove('shake'), 4000); break;                case 'flip': body.classList.add('flip-screen'); setTimeout(() => body.classList.remove('flip-screen'), 6000); break;                case 'blur': body.classList.add('blur-screen'); setTimeout(() => body.classList.remove('blur-screen'), 5000); break;                case 'invert': body.classList.add('invert-screen'); setTimeout(() => body.classList.remove('invert-screen'), 5000); break;                case 'rainbow': body.classList.add('rainbow-bg'); setTimeout(() => body.classList.remove('rainbow-bg'), 6000); break;                case 'matrix': showMatrixEffect(); break;                case 'fakeerror': alert('‚ùå CRITICAL SYSTEM ERROR!\n\nYour account has been TERMINATED!\nError Code: 0xDEADBEEF\n\nAll your data will be deleted in 10 seconds...'); break;                case 'jumpscare':                    overlay.innerHTML = '<div class="w-full h-full bg-black flex items-center justify-center text-[300px] animate-ping">üëª</div>';                    overlay.classList.remove('hidden');                    try { new Audio('https://www.myinstants.com/media/sounds/vine-boom.mp3').play(); } catch(e){}                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; }, 1500);                    break;                case 'spam': for (let i = 0; i < 20; i++) setTimeout(() => notify(['üéâ','üí•','üòà','üî•','üíÄ','üëª','ü§°','üí£'][Math.floor(Math.random()*8)] + ' SPAM!'), i * 100); break;                case 'freeze':                    overlay.innerHTML = '<div class="w-full h-full bg-blue-900/98 flex items-center justify-center flex-col"><div class="text-[200px]">ü•∂</div><p class="text-5xl font-black animate-pulse">–ó–ê–ú–û–†–û–ñ–ï–ù–û</p></div>';                    overlay.classList.remove('hidden');                    overlay.style.pointerEvents = 'auto';                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; overlay.style.pointerEvents = 'none'; }, 6000);                    break;                case 'disconnect':                    overlay.innerHTML = '<div class="w-full h-full bg-gray-900 flex items-center justify-center flex-col gap-4"><div class="text-9xl">üì¥</div><p class="text-4xl font-bold">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ</p><p class="text-gray-400">–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</p><div class="w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin"></div></div>';                    overlay.classList.remove('hidden');                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; }, 5000);                    break;                case 'rickroll': window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank'); break;                case 'confetti': createConfetti(); break;                case 'zalgo':                    document.querySelectorAll('h1,h2,h3,p,span,button').forEach(el => {                        if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {                            el.dataset.original = el.textContent;                            el.textContent = el.textContent.split('').map(c => c + 'Ã∑Ã®ÃõÃñÃóÃôÃúÃùÃûÃüÃ†Ã£Ã§Ã•Ã¶'.slice(0, Math.floor(Math.random()*8))).join('');                        }                    });                    setTimeout(() => location.reload(), 4000);                    break;                case 'earrape':                     try { const a = new Audio('https://www.myinstants.com/media/sounds/mlg-airhorn.mp3'); a.volume = 1; a.play(); } catch(e){}                     break;            }        }        function showMatrixEffect() {            const c = document.createElement('div');            c.className = 'matrix-rain';            document.body.appendChild(c);            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&*()„Ç°„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥';            for (let i = 0; i < 100; i++) {                setTimeout(() => {                    const ch = document.createElement('div');                    ch.className = 'matrix-char';                    ch.textContent = chars[Math.floor(Math.random()*chars.length)];                    ch.style.cssText = `left:${Math.random()*100}%;animation-duration:${Math.random()*2+1}s`;                    c.appendChild(ch);                }, i * 30);            }            setTimeout(() => c.remove(), 6000);        }        function createConfetti() {            for (let i = 0; i < 100; i++) {                const c = document.createElement('div');                c.style.cssText = `position:fixed;width:12px;height:12px;background:hsl(${Math.random()*360},100%,50%);left:${Math.random()*100}%;top:-20px;z-index:9999;pointer-events:none;border-radius:${Math.random()>0.5?'50%':'2px'};animation:confettiFall ${Math.random()*3+2}s linear forwards`;                document.body.appendChild(c);                setTimeout(() => c.remove(), 5000);            }            if (!document.getElementById('confettiStyle')) {                const s = document.createElement('style');                s.id = 'confettiStyle';                s.textContent = '@keyframes confettiFall{to{top:100vh;transform:rotate(720deg)}}';                document.head.appendChild(s);            }        }        // Auth Functions        function showAuthTab(tab) {            document.getElementById('loginForm').classList.toggle('hidden', tab !== 'login');            document.getElementById('registerForm').classList.toggle('hidden', tab !== 'register');            document.getElementById('loginTab').classList.toggle('bg-purple-500', tab === 'login');            document.getElementById('registerTab').classList.toggle('bg-purple-500', tab === 'register');        }        async function login() {            const email = document.getElementById('loginEmail').value;            const password = document.getElementById('loginPassword').value;            try {                await auth.signInWithEmailAndPassword(email, password);            } catch (e) {                showAuthError(e.message);            }        }        async function register() {            const username = document.getElementById('regUsername').value;            const email = document.getElementById('regEmail').value;            const password = document.getElementById('regPassword').value;            try {                const cred = await auth.createUserWithEmailAndPassword(email, password);                await db.ref('users/' + cred.user.uid).set({                    username, email, createdAt: Date.now(), online: true, coins: 100                });            } catch (e) {                showAuthError(e.message);            }        }        function logout() {            if (currentUser) db.ref('users/' + currentUser.uid + '/online').set(false);            auth.signOut();        }        function showAuthError(msg) {            const el = document.getElementById('authError');            el.textContent = msg;            el.classList.remove('hidden');        }        auth.onAuthStateChanged(async (user) => {            if (user) {                currentUser = user;                isAdmin = user.email === ADMIN_EMAIL;                const userData = await db.ref('users/' + user.uid).once('value');                const data = userData.val() || {};                document.getElementById('userName').textContent = data.username || '–ò–≥—Ä–æ–∫';                document.getElementById('userAvatar').textContent = (data.username || '–ò')[0].toUpperCase();                document.getElementById('userCoins').textContent = data.coins || 0;                db.ref('users/' + user.uid + '/online').set(true);                db.ref('users/' + user.uid + '/online').onDisconnect().set(false);                document.getElementById('authScreen').classList.add('hidden');                document.getElementById('mainApp').classList.remove('hidden');                setupListeners();                setupTrollListener();                if (isAdmin) notify('üëë –†–µ–∂–∏–º –∞–¥–º–∏–Ω–∞! –ü—Ä–∞–≤—ã–π Ctrl –¥–ª—è –ø–∞–Ω–µ–ª–∏');            } else {                currentUser = null;                isAdmin = false;                document.getElementById('authScreen').classList.remove('hidden');                document.getElementById('mainApp').classList.add('hidden');            }        });        // Navigation        function showSection(section) {            ['games', 'friends', 'leaderboard', 'invites'].forEach(s => {                document.getElementById(s + 'Section').classList.add('hidden');            });            document.getElementById(section + 'Section').classList.remove('hidden');            document.querySelectorAll('.nav-btn').forEach(btn => {                btn.classList.toggle('bg-purple-500/50', btn.dataset.section === section);                btn.classList.toggle('neon-glow', btn.dataset.section === section);            });        }        // Friends System        async function addFriend() {            const email = document.getElementById('friendEmail').value.trim();            if (!email) return;            const users = await db.ref('users').orderByChild('email').equalTo(email).once('value');            const data = users.val();            if (!data) { notify('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }            const friendId = Object.keys(data)[0];            if (friendId === currentUser.uid) { notify('üòÖ –ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è'); return; }            await db.ref('friendRequests/' + friendId + '/' + currentUser.uid).set({ from: currentUser.uid, timestamp: Date.now() });            document.getElementById('friendEmail').value = '';            notify('‚úâÔ∏è –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');        }        async function acceptFriend(friendId) {            await db.ref('friends/' + currentUser.uid + '/' + friendId).set(true);            await db.ref('friends/' + friendId + '/' + currentUser.uid).set(true);            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();            notify('üéâ –î—Ä—É–≥ –¥–æ–±–∞–≤–ª–µ–Ω!');        }        async function declineFriend(friendId) {            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();        }        const gameNames = {            tictactoe: '–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏', rps: '–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞', fruitcatcher: '–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤',            clickbattle: '–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª', mathbattle: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π', colormatch: '–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞',            heist: '–û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞', seabattle: '–ú–æ—Ä—Å–∫–æ–π –ë–æ–π', tanks: '–¢–∞–Ω–∫–æ–≤—ã–π –ë–æ–π', pong: '–ü–æ–Ω–≥',             duel: '–î—É—ç–ª—å', runner: '–ì–æ–Ω–∫–∞', quiz: '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞', memory2p: '–ú–µ–º–æ—Ä–∏ 2P', bomber: '–ë–æ–º–±–µ—Ä–º–µ–Ω'        };        function setupListeners() {            // Friend requests listener            db.ref('friendRequests/' + currentUser.uid).on('value', async (snap) => {                const requests = snap.val() || {};                const container = document.getElementById('friendRequests');                const keys = Object.keys(requests);                if (keys.length === 0) {                    container.innerHTML = '<p class="text-gray-400 text-center py-4">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>';                    return;                }                container.innerHTML = '';                for (const id of keys) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between glass rounded-xl p-4 slide-in">                            <div class="flex items-center gap-3">                                <div class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-bold text-lg">${(user.username||'?')[0].toUpperCase()}</div>                                <span class="font-bold">${user.username||'–ò–≥—Ä–æ–∫'}</span>                            </div>                            <div class="flex gap-2">                                <button onclick="acceptFriend('${id}')" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded-xl font-bold transition-all">‚úì</button>                                <button onclick="declineFriend('${id}')" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-xl font-bold transition-all">‚úï</button>                            </div>                        </div>`;                }            });            // Friends list listener            db.ref('friends/' + currentUser.uid).on('value', async (snap) => {                const friends = snap.val() || {};                const container = document.getElementById('friendsList');                const keys = Object.keys(friends);                if (keys.length === 0) {                    container.innerHTML = '<p class="text-gray-400 text-center py-4">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ! üòä</p>';                    return;                }                container.innerHTML = '';                for (const id of keys) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    const online = user.online;                    container.innerHTML += `                        <div class="flex items-center justify-between glass rounded-xl p-4 slide-in">                            <div class="flex items-center gap-3">                                ${online ? '<span class="w-3 h-3 bg-green-500 rounded-full online-dot"></span>' : '<span class="w-3 h-3 bg-gray-500 rounded-full"></span>'}                                <div class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-bold text-lg">${(user.username||'?')[0].toUpperCase()}</div>                                <div>                                    <p class="font-bold">${user.username||'–ò–≥—Ä–æ–∫'}</p>                                    <p class="text-xs ${online ? 'text-green-400' : 'text-gray-500'}">${online ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ–ª–∞–π–Ω'}</p>                                </div>                            </div>                            <button onclick="inviteToGame('${id}')" class="btn-primary px-6 py-2 rounded-xl font-bold ${online?'':'opacity-50 cursor-not-allowed'}" ${online?'':'disabled'}>üéÆ –ò–≥—Ä–∞—Ç—å</button>                        </div>`;                }            });            // Game invites listener            db.ref('gameInvites/' + currentUser.uid).on('value', async (snap) => {                const invites = snap.val() || {};                const container = document.getElementById('gameInvites');                const keys = Object.keys(invites);                document.getElementById('invitesBadge').classList.toggle('hidden', keys.length === 0);                document.getElementById('invitesBadge').textContent = keys.length;                if (keys.length === 0) {                    container.innerHTML = '<p class="text-gray-400 text-center py-8">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>';                    return;                }                container.innerHTML = '';                for (const id of keys) {                    const invite = invites[id];                    const userData = await db.ref('users/' + invite.from).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between glass rounded-xl p-4 slide-in">                            <div class="flex items-center gap-4">                                <div class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-bold text-lg">${(user.username||'?')[0].toUpperCase()}</div>                                <div>                                    <p class="font-bold">${user.username||'–ò–≥—Ä–æ–∫'}</p>                                    <p class="text-purple-400">${gameNames[invite.game]||invite.game}</p>                                </div>                            </div>                            <div class="flex gap-2">                                <button onclick="joinGame('${id}','${invite.game}','${invite.gameId}')" class="bg-green-500 hover:bg-green-600 px-6 py-2 rounded-xl font-bold transition-all">–ü—Ä–∏–Ω—è—Ç—å</button>                                <button onclick="declineInvite('${id}')" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-xl font-bold transition-all">‚úï</button>                            </div>                        </div>`;                }            });        }        function inviteToGame(friendId) {            const icons = { tictactoe:'‚ùå‚≠ï', rps:'‚úä‚úã‚úåÔ∏è', fruitcatcher:'üß∫üçé', clickbattle:'üëÜüí•', mathbattle:'üî¢‚öîÔ∏è', colormatch:'üé®', heist:'üè¶üí∞', seabattle:'üö¢üí•', tanks:'üî´üéØ', pong:'üèì', duel:'‚öîÔ∏è', runner:'üèÉ', quiz:'üß†', memory2p:'üÉè', bomber:'üí£' };            document.getElementById('gameContent').innerHTML = `                <div class="text-center">                    <h3 class="text-2xl font-bold mb-6">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</h3>                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">                        ${Object.entries(gameNames).map(([k,n])=>`                            <button onclick="sendGameInvite('${friendId}','${k}')" class="game-card glass p-4 rounded-xl hover:bg-purple-500/30">                                <div class="text-3xl mb-2">${icons[k]||'üéÆ'}</div>                                <div class="text-sm font-bold">${n}</div>                            </button>                        `).join('')}                    </div>                </div>`;            document.getElementById('gameTitle').textContent = 'üéÆ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –∏–≥—Ä—É';            document.getElementById('gameModal').classList.remove('hidden');        }        async function sendGameInvite(friendId, game) {            const gameId = db.ref('games').push().key;            await db.ref('games/' + gameId).set({                type: game, player1: currentUser.uid, player2: friendId,                 status: 'waiting', createdAt: Date.now()            });            await db.ref('gameInvites/' + friendId + '/' + Date.now()).set({                from: currentUser.uid, game, gameId            });            closeGame();            notify('üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');            waitForOpponent(gameId, game, friendId);        }        function waitForOpponent(gameId, game, opponentId) {            currentOpponentId = opponentId;            document.getElementById('gameContent').innerHTML = `                <div class="text-center py-12">                    <div class="text-8xl mb-6 floating">‚è≥</div>                    <h3 class="text-2xl font-bold mb-2">–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...</h3>                    <div class="typing-indicator text-4xl mt-4">                        <span>.</span><span>.</span><span>.</span>                    </div>                </div>`;            document.getElementById('gameTitle').textContent = 'üéÆ –û–∂–∏–¥–∞–Ω–∏–µ';            document.getElementById('gameModal').classList.remove('hidden');                        const listener = db.ref('games/' + gameId + '/status').on('value', (snap) => {                if (snap.val() === 'playing') {                    db.ref('games/' + gameId + '/status').off('value', listener);                    startMultiplayerGame(gameId, game);                }            });            gameListeners.push({ ref: 'games/' + gameId + '/status', callback: listener });        }        async function joinGame(inviteId, game, gameId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();            await db.ref('games/' + gameId + '/status').set('playing');            const gameSnap = await db.ref('games/' + gameId).once('value');            currentOpponentId = gameSnap.val().player1;            startMultiplayerGame(gameId, game);        }        async function declineInvite(inviteId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();        }        function openGame(game) {            document.getElementById('gameModal').classList.remove('hidden');            const mp = Object.keys(gameNames);            if (mp.includes(game)) {                document.getElementById('gameTitle').textContent = gameNames[game] || game;                document.getElementById('gameContent').innerHTML = `                    <div class="text-center py-8">                        <div class="text-8xl mb-6 floating">üë•</div>                        <h3 class="text-2xl font-bold mb-2">–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω–∞—è –∏–≥—Ä–∞</h3>                        <p class="text-gray-400 mb-6">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã!</p>                        <button onclick="showSection('friends');closeGame();" class="btn-primary px-8 py-4 rounded-xl font-bold text-lg">–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥—Ä—É–∑—å—è–º üë•</button>                    </div>`;            } else {                switch(game) {                    case 'memory': initMemory(); break;                    case 'reaction': initReaction(); break;                    case 'snake': initSnake(); break;                    case 'flappy': initFlappy(); break;                    case 'tetris': initTetris(); break;                    case '2048': init2048(); break;                    case 'asteroids': initAsteroids(); break;                    case 'typing': initTyping(); break;                }            }        }        function closeGame() {            document.getElementById('gameModal').classList.add('hidden');            gameListeners.forEach(l => { try { db.ref(l.ref).off('value', l.callback); } catch(e){} });            gameListeners = [];            gameIntervals.forEach(i => clearInterval(i));            gameIntervals = [];            currentGameId = null;        }        async function startMultiplayerGame(gameId, game) {            currentGameId = gameId;            if (currentOpponentId) {                const oppData = await db.ref('users/' + currentOpponentId).once('value');                document.getElementById('opponentName').textContent = oppData.val()?.username || '–ò–≥—Ä–æ–∫';            }            document.getElementById('gameModal').classList.remove('hidden');            switch(game) {                case 'tictactoe': initTicTacToe(gameId); break;                case 'rps': initRPS(gameId); break;                case 'fruitcatcher': initFruitCatcher(gameId); break;                case 'clickbattle': initClickBattle(gameId); break;                case 'mathbattle': initMathBattle(gameId); break;                case 'colormatch': initColorMatch(gameId); break;                case 'heist': initHeist(gameId); break;                case 'seabattle': initSeaBattle(gameId); break;                case 'tanks': initTanks(gameId); break;                case 'pong': initPong(gameId); break;                case 'duel': initDuel(gameId); break;                case 'runner': initRunner(gameId); break;                case 'quiz': initQuiz(gameId); break;            }        }        // ========== MULTIPLAYER GAMES ==========        async function initHeist(gameId) {            document.getElementById('gameTitle').textContent = 'üè¶ –û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞';            const snap = await db.ref('games/' + gameId).once('value');            const game = snap.val();            const isP1 = game.player1 === currentUser.uid;            const isRobber = isP1;            const size = 12;            if (isP1 && !game.robberX) {                await db.ref('games/' + gameId).update({                    robberX: 1, robberY: 1, policeX: size-2, policeY: size-2,                    goldX: 6, goldY: 6, exitX: size-2, exitY: 1,                    hasGold: false, winner: null, timeLeft: 60                });                const timer = setInterval(async () => {                    const s = await db.ref('games/' + gameId + '/timeLeft').once('value');                    const t = s.val();                    if (t > 0) await db.ref('games/' + gameId + '/timeLeft').set(t - 1);                    else { clearInterval(timer); await db.ref('games/' + gameId + '/winner').set('police'); }                }, 1000);                gameIntervals.push(timer);            }            function render(data) {                if (!data) return;                if (data.winner) {                    const iWon = (data.winner === 'robber' && isRobber) || (data.winner === 'police' && !isRobber);                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-9xl mb-6">${iWon ? 'üèÜ' : 'üíÄ'}</div>                            <p class="text-4xl font-black ${iWon ? 'text-green-400' : 'text-red-400'}">${iWon ? '–ü–û–ë–ï–î–ê!' : '–ü–û–†–ê–ñ–ï–ù–ò–ï!'}</p>                        </div>`;                    return;                }                let grid = '';                for (let y = 0; y < size; y++) {                    for (let x = 0; x < size; x++) {                        let content = '', cls = 'bg-gray-800/30';                        if (x === 0 || x === size-1 || y === 0 || y === size-1) {                            if (!(x === data.exitX && y === data.exitY)) cls = 'bg-gray-600/50';                        }                        if (x === data.exitX && y === data.exitY) { content = 'üö™'; cls = 'bg-green-900/50'; }                        if (!data.hasGold && x === data.goldX && y === data.goldY) { content = 'üí∞'; cls = 'bg-yellow-900/30'; }                        if (x === data.policeX && y === data.policeY) { content = 'üëÆ'; cls = 'bg-blue-900/50'; }                        if (x === data.robberX && y === data.robberY) { content = data.hasGold ? 'ü¶πüí∞' : 'ü¶π'; cls = 'bg-red-900/50'; }                        grid += `<div class="aspect-square flex items-center justify-center text-lg sm:text-xl rounded ${cls}">${content}</div>`;                    }                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <span class="${isRobber ? 'text-red-400' : 'text-blue-400'} text-xl font-bold">${isRobber ? 'ü¶π –ì—Ä–∞–±–∏—Ç–µ–ª—å' : 'üëÆ –ü–æ–ª–∏—Ü–∏—è'}</span>                        <span class="ml-6 text-2xl">‚è±Ô∏è ${data.timeLeft}—Å</span>                    </div>                    <div class="grid gap-0.5 max-w-md mx-auto mb-4" style="grid-template-columns:repeat(${size},1fr)">${grid}</div>                    <div class="flex flex-col items-center gap-2">                        <button onclick="heistMove(0,-1)" class="btn-game px-10 py-3 rounded-xl text-2xl">‚¨ÜÔ∏è</button>                        <div class="flex gap-2">                            <button onclick="heistMove(-1,0)" class="btn-game px-10 py-3 rounded-xl text-2xl">‚¨ÖÔ∏è</button>                            <button onclick="heistMove(0,1)" class="btn-game px-10 py-3 rounded-xl text-2xl">‚¨áÔ∏è</button>                            <button onclick="heistMove(1,0)" class="btn-game px-10 py-3 rounded-xl text-2xl">‚û°Ô∏è</button>                        </div>                    </div>`;            }            window.heistMove = async function(dx, dy) {                const s = await db.ref('games/' + gameId).once('value');                const data = s.val();                if (data.winner) return;                let newX, newY;                if (isRobber) {                    newX = data.robberX + dx * speedHack;                    newY = data.robberY + dy * speedHack;                } else {                    newX = data.policeX + dx;                    newY = data.policeY + dy;                }                newX = Math.max(0, Math.min(size-1, newX));                newY = Math.max(0, Math.min(size-1, newY));                if ((newX === 0 || newX === size-1 || newY === 0 || newY === size-1) && !(newX === data.exitX && newY === data.exitY)) return;                const updates = {};                if (isRobber) {                    updates.robberX = newX; updates.robberY = newY;                    if (newX === data.goldX && newY === data.goldY && !data.hasGold) updates.hasGold = true;                    if (newX === data.exitX && newY === data.exitY && data.hasGold) updates.winner = 'robber';                    if (newX === data.policeX && newY === data.policeY && !godmodeEnabled) updates.winner = 'police';                } else {                    updates.policeX = newX; updates.policeY = newY;                    if (newX === data.robberX && newY === data.robberY) updates.winner = 'police';                }                await db.ref('games/' + gameId).update(updates);            };            const listener = db.ref('games/' + gameId).on('value', snap => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initTicTacToe(gameId) {            document.getElementById('gameTitle').textContent = '‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏';            const snap = await db.ref('games/' + gameId).once('value');            const game = snap.val();            const isP1 = game.player1 === currentUser.uid;            const mySymbol = isP1 ? 'X' : 'O';            if (!game.board) {                await db.ref('games/' + gameId + '/board').set(['','','','','','','','','']);                await db.ref('games/' + gameId + '/turn').set('X');            }            function render(data) {                if (!data || !data.board) return;                const isMyTurn = data.turn === mySymbol;                let result = '';                if (data.winner) {                    result = data.winner === 'draw' ? '–ù–∏—á—å—è! ü§ù' : (data.winner === mySymbol ? '–ü–æ–±–µ–¥–∞! üèÜ' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ üíÄ');                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-6">                        <p class="text-xl font-bold ${data.winner ? (data.winner === mySymbol ? 'text-green-400' : 'text-red-400') : (isMyTurn ? 'text-green-400' : 'text-gray-400')}">${result || (isMyTurn ? '‚ú® –í–∞—à —Ö–æ–¥!' : '‚è≥ –•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...')}</p>                    </div>                    <div class="grid grid-cols-3 gap-3 max-w-xs mx-auto">                        ${data.board.map((c,i) => `                            <button onclick="tttMove(${i})" class="aspect-square glass rounded-xl text-5xl font-bold hover:bg-purple-500/30 transition-all ${c === 'X' ? 'text-red-400' : 'text-blue-400'}">                                ${c === 'X' ? '‚ùå' : c === 'O' ? '‚≠ï' : ''}                            </button>                        `).join('')}                    </div>`;            }            window.tttMove = async function(i) {                const s = await db.ref('games/' + gameId).once('value');                const data = s.val();                if (data.board[i] || data.turn !== mySymbol || data.winner) return;                data.board[i] = mySymbol;                const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];                let winner = null;                for (const [a,b,c] of wins) {                    if (data.board[a] && data.board[a] === data.board[b] && data.board[a] === data.board[c]) {                        winner = data.board[a]; break;                    }                }                if (!winner && !data.board.includes('')) winner = 'draw';                await db.ref('games/' + gameId).update({ board: data.board, turn: mySymbol === 'X' ? 'O' : 'X', winner });            };            const listener = db.ref('games/' + gameId).on('value', snap => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initRPS(gameId) {            document.getElementById('gameTitle').textContent = '‚úä –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞';            const snap = await db.ref('games/' + gameId).once('value');            const isP1 = snap.val().player1 === currentUser.uid;            function render(data) {                const myChoice = isP1 ? data.choice1 : data.choice2;                const oppChoice = isP1 ? data.choice2 : data.choice1;                const emoji = { rock: '‚úä', paper: '‚úã', scissors: '‚úåÔ∏è' };                let result = null;                if (myChoice && oppChoice) {                    if (myChoice === oppChoice) result = 'draw';                    else if ((myChoice === 'rock' && oppChoice === 'scissors') || (myChoice === 'paper' && oppChoice === 'rock') || (myChoice === 'scissors' && oppChoice === 'paper')) result = 'win';                    else result = 'lose';                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center">                        ${!myChoice ? `                            <p class="text-2xl mb-8">–°–¥–µ–ª–∞–π—Ç–µ –≤—ã–±–æ—Ä!</p>                            <div class="flex justify-center gap-6">                                <button onclick="rpsChoice('rock')" class="text-7xl p-6 glass rounded-2xl hover:scale-125 transition-all">‚úä</button>                                <button onclick="rpsChoice('paper')" class="text-7xl p-6 glass rounded-2xl hover:scale-125 transition-all">‚úã</button>                                <button onclick="rpsChoice('scissors')" class="text-7xl p-6 glass rounded-2xl hover:scale-125 transition-all">‚úåÔ∏è</button>                            </div>                        ` : result ? `                            <div class="flex justify-center gap-12 mb-8">                                <div class="text-center">                                    <p class="text-gray-400 mb-2">–í—ã</p>                                    <div class="text-8xl">${emoji[myChoice]}</div>                                </div>                                <div class="text-5xl self-center">‚öîÔ∏è</div>                                <div class="text-center">                                    <p class="text-gray-400 mb-2">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                    <div class="text-8xl">${emoji[oppChoice]}</div>                                </div>                            </div>                            <p class="text-4xl font-black ${result === 'win' ? 'text-green-400' : result === 'lose' ? 'text-red-400' : 'text-yellow-400'}">${result === 'win' ? '–ü–û–ë–ï–î–ê! üèÜ' : result === 'lose' ? '–ü–û–†–ê–ñ–ï–ù–ò–ï! üíÄ' : '–ù–ò–ß–¨–Ø! ü§ù'}</p>                        ` : `                            <div class="text-8xl mb-6">${emoji[myChoice]}</div>                            <p class="text-xl">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>                            <div class="typing-indicator text-4xl mt-4"><span>.</span><span>.</span><span>.</span></div>                        `}                    </div>`;            }            window.rpsChoice = async function(choice) {                await db.ref('games/' + gameId + '/' + (isP1 ? 'choice1' : 'choice2')).set(choice);            };            const listener = db.ref('games/' + gameId).on('value', snap => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initClickBattle(gameId) {            document.getElementById('gameTitle').textContent = 'üëÜ –ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª';            const snap = await db.ref('games/' + gameId).once('value');            const isP1 = snap.val().player1 === currentUser.uid;            if (isP1 && !snap.val().startTime) {                await db.ref('games/' + gameId).update({ clicks1: 0, clicks2: 0, startTime: Date.now() });            }            let localClicks = 0;            function render(data) {                const oppClicks = isP1 ? data.clicks2 : data.clicks1;                const elapsed = Date.now() - data.startTime;                const timeLeft = Math.max(0, Math.ceil((10000 - elapsed) / 1000));                if (timeLeft <= 0) {                    const iWon = localClicks > oppClicks;                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <p class="text-5xl font-black mb-4">${localClicks} : ${oppClicks}</p>                            <p class="text-3xl font-bold ${iWon ? 'text-green-400' : (localClicks < oppClicks ? 'text-red-400' : 'text-yellow-400')}">${iWon ? '–ü–û–ë–ï–î–ê! üèÜ' : (localClicks < oppClicks ? '–ü–û–†–ê–ñ–ï–ù–ò–ï! üíÄ' : '–ù–ò–ß–¨–Ø! ü§ù')}</p>                        </div>`;                    return;                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center">                        <p class="text-7xl font-black mb-6 gradient-text">‚è±Ô∏è ${timeLeft}</p>                        <div class="flex justify-center gap-8 mb-6">                            <div class="text-center">                                <p class="text-gray-400">–í—ã</p>                                <p class="text-4xl font-black text-green-400">${localClicks}</p>                            </div>                            <div class="text-center">                                <p class="text-gray-400">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p>                                <p class="text-4xl font-black text-red-400">${oppClicks}</p>                            </div>                        </div>                        <button onclick="clickBattle()" class="w-56 h-56 mx-auto block glass rounded-full text-9xl pulse-glow active:scale-95 transition-transform">üëÜ</button>                    </div>`;            }            window.clickBattle = async () => {                localClicks += speedHack;                await db.ref('games/' + gameId + '/' + (isP1 ? 'clicks1' : 'clicks2')).set(localClicks);            };            const listener = db.ref('games/' + gameId).on('value', snap => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // ========== SOLO GAMES ==========        function initMemory() {            document.getElementById('gameTitle').textContent = 'üß† –ú–µ–º–æ—Ä–∏';            const emojis = ['üéÆ','üé≤','üéØ','üé™','üé®','üé≠','üé∏','üé∫'];            let cards = [...emojis,...emojis].sort(() => Math.random()-0.5);            let flipped = [], matched = [], moves = 0, startTime = Date.now();            function render() {                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4 text-lg">                        <p>–•–æ–¥—ã: <span class="font-bold text-purple-400">${moves}</span></p>                        <p>–ù–∞–π–¥–µ–Ω–æ: <span class="font-bold text-green-400">${matched.length/2}</span>/${emojis.length}</p>                    </div>                    <div class="grid grid-cols-4 gap-3 max-w-sm mx-auto">                        ${cards.map((e,i) => `                            <div onclick="flipCard(${i})" class="aspect-square cursor-pointer glass rounded-xl flex items-center justify-center text-3xl transition-all duration-300 ${flipped.includes(i) || matched.includes(i) ? (matched.includes(i) ? 'bg-green-500/30 scale-95' : 'bg-purple-500/30') : 'hover:bg-white/20 hover:scale-105'}">                                ${flipped.includes(i) || matched.includes(i) ? e : '‚ùì'}                            </div>                        `).join('')}                    </div>                    ${matched.length === cards.length ? `                        <div class="text-center mt-8">                            <p class="text-3xl font-black text-green-400 mb-4">üéâ –ü–û–ë–ï–î–ê!</p>                            <p class="text-xl mb-4">–•–æ–¥–æ–≤: ${moves} | –í—Ä–µ–º—è: ${Math.floor((Date.now()-startTime)/1000)}—Å</p>                            <button onclick="initMemory()" class="btn-primary px-8 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>                    ` : ''}`;            }            window.flipCard = (i) => {                if (flipped.length >= 2 || flipped.includes(i) || matched.includes(i)) return;                flipped.push(i);                render();                if (flipped.length === 2) {                    moves++;                    if (cards[flipped[0]] === cards[flipped[1]]) {                        matched.push(...flipped);                        flipped = [];                        render();                        if (matched.length === cards.length) {                            saveScore('memory', 10000 - Math.round((Date.now()-startTime)/100) - moves*50);                        }                    } else {                        setTimeout(() => { flipped = []; render(); }, 1000);                    }                }            };            render();        }        function initReaction() {            document.getElementById('gameTitle').textContent = '‚ö° –¢–µ—Å—Ç –†–µ–∞–∫—Ü–∏–∏';            let state = 'waiting', startTime = 0, timeout = null;            function render() {                const content = {                    waiting: `                        <div onclick="startReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-blue-500/20 hover:bg-blue-500/30 transition-all">                            <div class="text-center">                                <div class="text-7xl mb-4 floating">üëÜ</div>                                <p class="text-2xl">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞</p>                            </div>                        </div>`,                    ready: `                        <div onclick="tooEarly()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-red-500/30">                            <div class="text-center">                                <div class="text-7xl mb-4">‚è≥</div>                                <p class="text-2xl">–ñ–¥–∏—Ç–µ –∑–µ–ª—ë–Ω—ã–π...</p>                            </div>                        </div>`,                    go: `                        <div onclick="clickReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-green-500/50 animate-pulse">                            <div class="text-center">                                <div class="text-7xl mb-4">‚ö°</div>                                <p class="text-3xl font-black">–ñ–ú–ò–¢–ï!</p>                            </div>                        </div>`,                    result: `                        <div class="text-center py-8">                            <p class="text-6xl font-black gradient-text mb-4">${Date.now()-startTime} –º—Å</p>                            <p class="text-xl text-gray-400 mb-6">${Date.now()-startTime < 200 ? 'üöÄ –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!' : Date.now()-startTime < 300 ? '‚ö° –û—Ç–ª–∏—á–Ω–æ!' : 'üëç –•–æ—Ä–æ—à–æ!'}</p>                            <button onclick="initReaction()" class="btn-primary px-8 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>`,                    early: `                        <div class="text-center py-8">                            <p class="text-4xl font-bold text-red-400 mb-4">üòÖ –°–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ!</p>                            <button onclick="initReaction()" class="btn-primary px-8 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>`                };                document.getElementById('gameContent').innerHTML = content[state];                if (state === 'result') saveScore('reaction', Math.max(0, 1000 - (Date.now()-startTime)));            }            window.startReaction = () => {                state = 'ready';                render();                timeout = setTimeout(() => { state = 'go'; startTime = Date.now(); render(); }, Math.random()*3000+1500);            };            window.tooEarly = () => { clearTimeout(timeout); state = 'early'; render(); };            window.clickReaction = () => { state = 'result'; render(); };            render();        }        function initSnake() {            document.getElementById('gameTitle').textContent = 'üêç –ó–º–µ–π–∫–∞';            const size = 15;            let snake = [{x:7,y:7}], food = {x:3,y:3}, dir = {x:1,y:0}, score = 0, gameOver = false;            function placeFood() {                do { food = {x:Math.floor(Math.random()*size),y:Math.floor(Math.random()*size)}; }                while (snake.some(s => s.x === food.x && s.y === food.y));            }            function render() {                let grid = '';                for (let y = 0; y < size; y++) {                    for (let x = 0; x < size; x++) {                        const isHead = snake[0].x === x && snake[0].y === y;                        const isSnake = snake.some(s => s.x === x && s.y === y);                        const isFood = food.x === x && food.y === y;                        grid += `<div class="aspect-square rounded-sm ${isHead ? 'bg-green-400' : isSnake ? 'bg-green-600' : isFood ? 'bg-red-500 animate-pulse' : 'bg-white/5'}"></div>`;                    }                }                document.getElementById('gameContent').innerHTML = `                    <p class="text-center text-2xl font-bold mb-4">üçé <span class="text-green-400">${score}</span></p>                    <div class="grid gap-0.5 max-w-sm mx-auto mb-4" style="grid-template-columns:repeat(${size},1fr)">${grid}</div>                    ${gameOver ? `                        <div class="text-center">                            <p class="text-3xl font-bold text-red-400 mb-4">Game Over!</p>                            <button onclick="initSnake()" class="btn-primary px-8 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>                    ` : `                        <div class="flex flex-col items-center gap-2">                            <button onclick="snakeDir(0,-1)" class="btn-game px-8 py-2 rounded-xl text-xl">‚¨ÜÔ∏è</button>                            <div class="flex gap-2">                                <button onclick="snakeDir(-1,0)" class="btn-game px-8 py-2 rounded-xl text-xl">‚¨ÖÔ∏è</button>                                <button onclick="snakeDir(0,1)" class="btn-game px-8 py-2 rounded-xl text-xl">‚¨áÔ∏è</button>                                <button onclick="snakeDir(1,0)" class="btn-game px-8 py-2 rounded-xl text-xl">‚û°Ô∏è</button>                            </div>                        </div>                    `}`;            }            function move() {                if (gameOver) return;                const head = {x:snake[0].x+dir.x, y:snake[0].y+dir.y};                if (head.x < 0 || head.x >= size || head.y < 0 || head.y >= size || snake.some(s => s.x === head.x && s.y === head.y)) {                    gameOver = true;                    saveScore('snake', score);                    render();                    return;                }                snake.unshift(head);                if (head.x === food.x && head.y === food.y) {                    score += 10;                    placeFood();                } else {                    snake.pop();                }                render();            }            window.snakeDir = (x,y) => {                if ((x && dir.x) || (y && dir.y)) return;                dir = {x,y};            };            const int = setInterval(move, 120);            gameIntervals.push(int);            render();        }        function initFlappy() {            document.getElementById('gameTitle').textContent = 'üê¶ Flappy Bird';            let birdY = 50, velocity = 0, pipes = [], score = 0, gameOver = false;            const gravity = 0.4, jump = -7, pipeGap = 28;            function render() {                document.getElementById('gameContent').innerHTML = `                    <p class="text-center text-2xl font-bold mb-2">üèÜ <span class="text-yellow-400">${score}</span></p>                    <div id="flappyArea" onclick="flap()" class="relative bg-gradient-to-b from-sky-400 to-sky-600 rounded-2xl h-72 overflow-hidden cursor-pointer">                        ${pipes.map(p => `                            <div class="absolute bg-green-500 w-12 rounded-b-xl" style="left:${p.x}%;top:0;height:${p.top}%"></div>                            <div class="absolute bg-green-500 w-12 rounded-t-xl" style="left:${p.x}%;bottom:0;height:${100-p.top-pipeGap}%"></div>                        `).join('')}                        <div class="absolute text-4xl transition-transform" style="left:15%;top:${birdY}%;transform:translateY(-50%) rotate(${Math.min(velocity*3, 45)}deg)">üê¶</div>                    </div>                    ${gameOver ? `                        <div class="text-center mt-4">                            <p class="text-2xl font-bold text-red-400 mb-4">Game Over!</p>                            <button onclick="initFlappy()" class="btn-primary px-8 py-3 rounded-xl font-bold">üîÑ –ï—â—ë —Ä–∞–∑</button>                        </div>                    ` : '<p class="text-center text-gray-400 mt-2">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä—ã–≥–Ω—É—Ç—å</p>'}`;            }            window.flap = () => { if (!gameOver) velocity = jump; };            function loop() {                if (gameOver) return;                velocity += gravity;                birdY += velocity * 0.5;                if (birdY <= 0 || birdY >= 100) { gameOver = true; saveScore('flappy', score); }                pipes.forEach(p => p.x -= 1);                pipes = pipes.filter(p => p.x > -15);                if (pipes.length === 0 || pipes[pipes.length-1].x < 60) {                    pipes.push({x:100, top:Math.random()*40+10});                }                pipes.forEach(p => {                    if (p.x < 20 && p.x > 10 && (birdY < p.top || birdY > p.top + pipeGap)) {                        gameOver = true;                        saveScore('flappy', score);                    }                    if (p.x === 10) score++;                });                render();            }            const int = setInterval(loop, 40);            gameIntervals.push(int);            render();        }        // Placeholder for other games        function initSeaBattle(gameId) { document.getElementById('gameTitle').textContent = 'üö¢ –ú–æ—Ä—Å–∫–æ–π –ë–æ–π'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initTanks(gameId) { document.getElementById('gameTitle').textContent = 'üî´ –¢–∞–Ω–∫–∏'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initPong(gameId) { document.getElementById('gameTitle').textContent = 'üèì –ü–æ–Ω–≥'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initDuel(gameId) { document.getElementById('gameTitle').textContent = '‚öîÔ∏è –î—É—ç–ª—å'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initFruitCatcher(gameId) { document.getElementById('gameTitle').textContent = 'üß∫ –õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initMathBattle(gameId) { document.getElementById('gameTitle').textContent = 'üî¢ –ú–∞—Ç–µ–º. –±–æ–π'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initColorMatch(gameId) { document.getElementById('gameTitle').textContent = 'üé® –¶–≤–µ—Ç–∞'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initRunner(gameId) { document.getElementById('gameTitle').textContent = 'üèÉ –ì–æ–Ω–∫–∞'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initQuiz(gameId) { document.getElementById('gameTitle').textContent = 'üß† –í–∏–∫—Ç–æ—Ä–∏–Ω–∞'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initTetris() { document.getElementById('gameTitle').textContent = 'üß± –¢–µ—Ç—Ä–∏—Å'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function init2048() { document.getElementById('gameTitle').textContent = 'üî¢ 2048'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initAsteroids() { document.getElementById('gameTitle').textContent = 'üöÄ –ê—Å—Ç–µ—Ä–æ–∏–¥—ã'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        function initTyping() { document.getElementById('gameTitle').textContent = '‚å®Ô∏è –ü–µ—á–∞—Ç—å'; document.getElementById('gameContent').innerHTML = '<p class="text-center text-xl py-12">üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...</p>'; }        // Save Score & Leaderboard        async function saveScore(game, score) {            if (!currentUser || score <= 0) return;            const userData = await db.ref('users/' + currentUser.uid).once('value');            const username = userData.val()?.username || '–ò–≥—Ä–æ–∫';            const existing = await db.ref('leaderboard/' + game).orderByChild('userId').equalTo(currentUser.uid).once('value');            const data = existing.val();            if (data) {                const key = Object.keys(data)[0];                if (data[key].score < score) await db.ref('leaderboard/' + game + '/' + key + '/score').set(score);            } else {                await db.ref('leaderboard/' + game).push({ userId: currentUser.uid, username, score });            }        }        async function showLeaderboard(game) {            document.querySelectorAll('.lb-btn').forEach(b => b.classList.remove('bg-purple-500'));            event.target.classList.add('bg-purple-500');            const snap = await db.ref('leaderboard/' + game).orderByChild('score').limitToLast(10).once('value');            const entries = Object.values(snap.val() || {}).sort((a,b) => b.score - a.score);            const medals = ['ü•á','ü•à','ü•â'];            document.getElementById('leaderboardList').innerHTML = entries.length ? entries.map((e,i) => `                <div class="flex items-center justify-between glass rounded-xl p-4 slide-in ${e.userId === currentUser?.uid ? 'ring-2 ring-purple-500' : ''}">                    <div class="flex items-center gap-4">                        <span class="text-3xl">${medals[i] || (i+1)}</span>                        <span class="font-bold text-lg">${e.username}</span>                    </div>                    <span class="text-2xl font-black gradient-text">${e.score}</span>                </div>            `).join('') : '<p class="text-gray-400 text-center py-8">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>';        }        // Notification        function notify(text) {            const el = document.getElementById('notification');            document.getElementById('notificationText').textContent = text;            el.classList.remove('hidden', 'translate-y-20');            setTimeout(() => {                el.classList.add('translate-y-20');                setTimeout(() => el.classList.add('hidden'), 500);            }, 3000);        }        // Init        showSection('games');    </script></body></html>