<!DOCTYPE html><html lang="ru"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>üéÆ GameZone - –ò–≥—Ä–æ–≤–æ–π –ü–æ—Ä—Ç–∞–ª</title>    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">    <style>        * { font-family: 'Nunito', sans-serif; }                body {            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);            min-height: 100vh;        }                .glass {            background: rgba(255, 255, 255, 0.1);            backdrop-filter: blur(20px);            border: 1px solid rgba(255, 255, 255, 0.2);        }                .neon-glow {            box-shadow: 0 0 20px rgba(139, 92, 246, 0.5), 0 0 40px rgba(139, 92, 246, 0.3);        }                .game-card {            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);        }                .game-card:hover {            transform: translateY(-10px) scale(1.02);            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.4);        }                .floating {            animation: floating 3s ease-in-out infinite;        }                @keyframes floating {            0%, 100% { transform: translateY(0); }            50% { transform: translateY(-10px); }        }                .pulse-glow {            animation: pulseGlow 2s ease-in-out infinite;        }                @keyframes pulseGlow {            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.8), 0 0 60px rgba(236, 72, 153, 0.4); }        }                .gradient-text {            background: linear-gradient(135deg, #8b5cf6, #ec4899, #06b6d4);            -webkit-background-clip: text;            -webkit-text-fill-color: transparent;            background-clip: text;        }                .btn-primary {            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);            transition: all 0.3s ease;        }                .btn-primary:hover {            transform: scale(1.05);            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);        }                .online-dot {            animation: onlinePulse 2s infinite;        }                @keyframes onlinePulse {            0%, 100% { opacity: 1; }            50% { opacity: 0.5; }        }                .particle {            position: fixed;            pointer-events: none;            border-radius: 50%;            animation: floatUp 15s linear infinite;        }                @keyframes floatUp {            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }            10% { opacity: 1; }            90% { opacity: 1; }            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }        }                .rainbow-border {            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);            background-size: 400%;            animation: rainbowMove 3s linear infinite;            padding: 3px;        }                @keyframes rainbowMove {            0% { background-position: 0% 50%; }            100% { background-position: 400% 50%; }        }                .gold-glow {            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 215, 0, 0.3);            animation: goldPulse 1.5s ease-in-out infinite;        }                @keyframes goldPulse {            0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }            50% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.9), 0 0 80px rgba(255, 215, 0, 0.4); }        }                .police-glow { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8); }        .robber-glow { box-shadow: 0 0 20px rgba(239, 68, 68, 0.8); }        .slide-in { animation: slideIn 0.5s ease-out; }        @keyframes slideIn {            from { opacity: 0; transform: translateY(20px); }            to { opacity: 1; transform: translateY(0); }        }        /* TROLL EFFECTS */        .shake { animation: shake 0.5s infinite; }        @keyframes shake {            0%, 100% { transform: translateX(0); }            25% { transform: translateX(-10px) rotate(-1deg); }            75% { transform: translateX(10px) rotate(1deg); }        }                .flip-screen { transform: rotate(180deg); }        .blur-screen { filter: blur(10px); }        .invert-screen { filter: invert(1); }        .rainbow-bg { animation: rainbowBg 0.5s linear infinite; }        @keyframes rainbowBg {            0% { filter: hue-rotate(0deg); }            100% { filter: hue-rotate(360deg); }        }                .matrix-rain {            position: fixed;            top: 0;            left: 0;            width: 100%;            height: 100%;            pointer-events: none;            z-index: 9999;            background: rgba(0,0,0,0.9);            overflow: hidden;        }                .matrix-char {            position: absolute;            color: #0f0;            font-family: monospace;            font-size: 20px;            animation: matrixFall 2s linear forwards;        }                @keyframes matrixFall {            0% { top: -20px; opacity: 1; }            100% { top: 100vh; opacity: 0; }        }        .admin-panel {            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);            border: 2px solid #ff0000;            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);        }        .troll-btn {            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);            transition: all 0.2s;        }        .troll-btn:hover {            transform: scale(1.05);            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);        }        ::-webkit-scrollbar { width: 8px; }        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #8b5cf6, #ec4899); border-radius: 4px; }    </style></head><body class="text-white overflow-x-hidden">    <div id="particles"></div>    <!-- Auth Screen -->    <div id="authScreen" class="min-h-screen flex items-center justify-center p-4">        <div class="glass rounded-3xl p-8 w-full max-w-md neon-glow slide-in">            <div class="text-center mb-8">                <h1 class="text-5xl font-black gradient-text mb-2">üéÆ GameZone</h1>                <p class="text-gray-300">–ò–≥—Ä–∞–π —Å –¥—Ä—É–∑—å—è–º–∏ –æ–Ω–ª–∞–π–Ω!</p>            </div>                        <div id="authTabs" class="flex mb-6 bg-white/10 rounded-xl p-1">                <button onclick="showAuthTab('login')" id="loginTab" class="flex-1 py-2 rounded-lg bg-purple-500 font-bold transition-all">–í—Ö–æ–¥</button>                <button onclick="showAuthTab('register')" id="registerTab" class="flex-1 py-2 rounded-lg font-bold transition-all">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>            </div>                        <div id="loginForm">                <input type="email" id="loginEmail" placeholder="Email" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <button onclick="login()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–í–æ–π—Ç–∏ üöÄ</button>            </div>                        <div id="registerForm" class="hidden">                <input type="text" id="regUsername" placeholder="–ù–∏–∫–Ω–µ–π–º" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="email" id="regEmail" placeholder="Email" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 mb-4 focus:outline-none focus:border-purple-500 transition-all">                <button onclick="register()" class="w-full btn-primary py-4 rounded-xl font-bold text-lg">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç ‚ú®</button>            </div>                        <p id="authError" class="text-red-400 text-center mt-4 hidden"></p>        </div>    </div>    <!-- Main App -->    <div id="mainApp" class="hidden">        <header class="glass sticky top-0 z-50 px-6 py-4">            <div class="max-w-7xl mx-auto flex items-center justify-between">                <h1 class="text-2xl font-black gradient-text">üéÆ GameZone</h1>                <div class="flex items-center gap-4">                    <div class="flex items-center gap-2">                        <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold" id="userAvatar">?</div>                        <span id="userName" class="font-bold hidden sm:block">–ò–≥—Ä–æ–∫</span>                    </div>                    <button onclick="logout()" class="glass px-4 py-2 rounded-xl hover:bg-white/20 transition-all">üö™</button>                </div>            </div>        </header>        <nav class="flex justify-center gap-2 p-4 flex-wrap">            <button onclick="showSection('games')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="games">üéÆ –ò–≥—Ä—ã</button>            <button onclick="showSection('friends')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="friends">üë• –î—Ä—É–∑—å—è</button>            <button onclick="showSection('leaderboard')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all" data-section="leaderboard">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>            <button onclick="showSection('invites')" class="nav-btn px-6 py-3 rounded-xl glass font-bold hover:bg-purple-500/50 transition-all relative" data-section="invites">                üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è                <span id="invitesBadge" class="absolute -top-2 -right-2 bg-red-500 text-xs w-5 h-5 rounded-full flex items-center justify-center hidden">0</span>            </button>        </nav>        <!-- Games Section -->        <section id="gamesSection" class="max-w-7xl mx-auto p-6">            <h2 class="text-3xl font-black mb-6 gradient-text">üéÆ –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É</h2>                        <h3 class="text-xl font-bold mb-4 text-yellow-300">‚≠ê –¢–æ–ø –∏–≥—Ä—ã</h3>            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">                <div class="rainbow-border rounded-2xl cursor-pointer" onclick="openGame('heist')">                    <div class="game-card bg-gray-900 rounded-2xl p-6 h-full">                        <div class="text-6xl mb-4 floating">üè¶üí∞</div>                        <h3 class="text-2xl font-bold mb-2">–û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞</h3>                        <p class="text-gray-300 mb-4">–ì—Ä–∞–±–∏—Ç–µ–ª—å vs –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π!</p>                        <span class="inline-block bg-red-500/30 text-red-300 px-3 py-1 rounded-full text-sm">üî• –•–ò–¢</span>                    </div>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer gold-glow" onclick="openGame('seabattle')">                    <div class="text-6xl mb-4 floating">üö¢üí•</div>                    <h3 class="text-2xl font-bold mb-2">–ú–æ—Ä—Å–∫–æ–π –ë–æ–π</h3>                    <p class="text-gray-300 mb-4">–ü–æ—Ç–æ–ø–∏ —Ñ–ª–æ—Ç –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞!</p>                    <span class="inline-block bg-blue-500/30 text-blue-300 px-3 py-1 rounded-full text-sm">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</span>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('tanks')">                    <div class="text-6xl mb-4 floating">üî´üéØ</div>                    <h3 class="text-2xl font-bold mb-2">–¢–∞–Ω–∫–æ–≤—ã–π –ë–æ–π</h3>                    <p class="text-gray-300 mb-4">–£–Ω–∏—á—Ç–æ–∂—å –≤—Ä–∞–≥–∞ –ø–µ—Ä–≤—ã–º!</p>                    <span class="inline-block bg-orange-500/30 text-orange-300 px-3 py-1 rounded-full text-sm">‚öîÔ∏è PvP</span>                </div>            </div>                        <h3 class="text-xl font-bold mb-4 text-purple-300">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã</h3>            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('tictactoe')">                    <div class="text-5xl mb-4 floating">‚ùå‚≠ï</div>                    <h3 class="text-xl font-bold mb-2">–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</h3>                    <p class="text-gray-300 text-sm">–ö–ª–∞—Å—Å–∏–∫–∞ –¥–ª—è –¥–≤–æ–∏—Ö</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('rps')">                    <div class="text-5xl mb-4 floating">‚úä‚úã‚úåÔ∏è</div>                    <h3 class="text-xl font-bold mb-2">–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã</h3>                    <p class="text-gray-300 text-sm">–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('pong')">                    <div class="text-5xl mb-4 floating">üèì</div>                    <h3 class="text-xl font-bold mb-2">–ü–æ–Ω–≥</h3>                    <p class="text-gray-300 text-sm">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∏–Ω–≥-–ø–æ–Ω–≥!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('duel')">                    <div class="text-5xl mb-4 floating">‚öîÔ∏èüõ°Ô∏è</div>                    <h3 class="text-xl font-bold mb-2">–î—É—ç–ª—å</h3>                    <p class="text-gray-300 text-sm">–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –≤—ã—Å—Ç—Ä–µ–ª–∏—Ç!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('fruitcatcher')">                    <div class="text-5xl mb-4 floating">üß∫üçé</div>                    <h3 class="text-xl font-bold mb-2">–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤</h3>                    <p class="text-gray-300 text-sm">–õ–æ–≤–∏ –±—ã—Å—Ç—Ä–µ–µ!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('clickbattle')">                    <div class="text-5xl mb-4 floating">üëÜüí•</div>                    <h3 class="text-xl font-bold mb-2">–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª</h3>                    <p class="text-gray-300 text-sm">–ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('mathbattle')">                    <div class="text-5xl mb-4 floating">üî¢‚öîÔ∏è</div>                    <h3 class="text-xl font-bold mb-2">–ú–∞—Ç–µ–º. –±–æ–π</h3>                    <p class="text-gray-300 text-sm">–°—á–∏—Ç–∞–π –±—ã—Å—Ç—Ä–µ–µ!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('colormatch')">                    <div class="text-5xl mb-4 floating">üé®üèÉ</div>                    <h3 class="text-xl font-bold mb-2">–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞</h3>                    <p class="text-gray-300 text-sm">–í—ã–±–µ—Ä–∏ —Ü–≤–µ—Ç!</p>                </div>            </div>                        <h3 class="text-xl font-bold mb-4 text-blue-300">üèÜ –û–¥–∏–Ω–æ—á–Ω—ã–µ –∏–≥—Ä—ã</h3>            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('memory')">                    <div class="text-5xl mb-4 floating">üß†</div>                    <h3 class="text-xl font-bold mb-2">–ú–µ–º–æ—Ä–∏</h3>                    <p class="text-gray-300 text-sm">–ù–∞–π–¥–∏ –ø–∞—Ä—ã!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('reaction')">                    <div class="text-5xl mb-4 floating">‚ö°</div>                    <h3 class="text-xl font-bold mb-2">–†–µ–∞–∫—Ü–∏—è</h3>                    <p class="text-gray-300 text-sm">–ü—Ä–æ–≤–µ—Ä—å —Å–∫–æ—Ä–æ—Å—Ç—å!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('snake')">                    <div class="text-5xl mb-4 floating">üêç</div>                    <h3 class="text-xl font-bold mb-2">–ó–º–µ–π–∫–∞</h3>                    <p class="text-gray-300 text-sm">–ö–ª–∞—Å—Å–∏–∫–∞!</p>                </div>                                <div class="game-card glass rounded-2xl p-6 cursor-pointer" onclick="openGame('flappy')">                    <div class="text-5xl mb-4 floating">üê¶</div>                    <h3 class="text-xl font-bold mb-2">Flappy Bird</h3>                    <p class="text-gray-300 text-sm">–õ–µ—Ç–∏ –≤—ã—à–µ!</p>                </div>            </div>        </section>        <!-- Friends Section -->        <section id="friendsSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üë• –î—Ä—É–∑—å—è</h2>                        <div class="glass rounded-2xl p-6 mb-6">                <h3 class="text-xl font-bold mb-4">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞</h3>                <div class="flex gap-4 flex-wrap">                    <input type="text" id="friendEmail" placeholder="Email –¥—Ä—É–≥–∞" class="flex-1 min-w-[200px] p-4 rounded-xl bg-white/10 border border-white/20 focus:outline-none focus:border-purple-500">                    <button onclick="addFriend()" class="btn-primary px-6 rounded-xl font-bold">–î–æ–±–∞–≤–∏—Ç—å</button>                </div>            </div>                        <div class="glass rounded-2xl p-6 mb-6">                <h3 class="text-xl font-bold mb-4">üì® –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h3>                <div id="friendRequests" class="space-y-3"><p class="text-gray-400">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p></div>            </div>                        <div class="glass rounded-2xl p-6">                <h3 class="text-xl font-bold mb-4">üë• –ú–æ–∏ –¥—Ä—É–∑—å—è</h3>                <div id="friendsList" class="space-y-3"><p class="text-gray-400">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p></div>            </div>        </section>        <!-- Leaderboard Section -->        <section id="leaderboardSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>            <div class="flex gap-2 mb-6 flex-wrap">                <button onclick="showLeaderboard('snake')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üêç –ó–º–µ–π–∫–∞</button>                <button onclick="showLeaderboard('memory')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üß† –ú–µ–º–æ—Ä–∏</button>                <button onclick="showLeaderboard('reaction')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">‚ö° –†–µ–∞–∫—Ü–∏—è</button>                <button onclick="showLeaderboard('flappy')" class="lb-btn px-4 py-2 rounded-xl glass font-bold">üê¶ Flappy</button>            </div>            <div id="leaderboardContent" class="glass rounded-2xl p-6">                <div class="space-y-3" id="leaderboardList"><p class="text-gray-400 text-center">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</p></div>            </div>        </section>        <!-- Invites Section -->        <section id="invitesSection" class="max-w-4xl mx-auto p-6 hidden">            <h2 class="text-3xl font-black mb-6 gradient-text">üì® –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –∏–≥—Ä—ã</h2>            <div id="gameInvites" class="glass rounded-2xl p-6 space-y-4"><p class="text-gray-400 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p></div>        </section>    </div>    <!-- Game Modal -->    <div id="gameModal" class="fixed inset-0 bg-black/90 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">        <div class="glass rounded-3xl p-6 w-full max-w-4xl max-h-[95vh] overflow-y-auto neon-glow">            <div class="flex justify-between items-center mb-6">                <h2 id="gameTitle" class="text-2xl font-black gradient-text">–ò–≥—Ä–∞</h2>                <button onclick="closeGame()" class="text-3xl hover:scale-110 transition-transform">‚ùå</button>            </div>            <div id="gameContent"></div>        </div>    </div>    <!-- SECRET ADMIN PANEL -->    <div id="adminPanel" class="fixed inset-0 bg-black/95 z-[100] hidden flex items-center justify-center p-4">        <div class="admin-panel rounded-3xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">            <div class="flex justify-between items-center mb-6">                <h2 class="text-2xl font-black text-red-500">üî¥ ADMIN TROLL PANEL üî¥</h2>                <button onclick="closeAdminPanel()" class="text-3xl hover:scale-110 transition-transform">‚ùå</button>            </div>                        <p class="text-gray-400 mb-4">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –≤ –∏–≥—Ä–µ: <span id="opponentName" class="text-white font-bold">–ù–∏–∫–æ–≥–æ</span></p>                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 mb-6">                <button onclick="trollAction('screamer')" class="troll-btn p-4 rounded-xl font-bold">üò± –°–∫—Ä–∏–º–µ—Ä</button>                <button onclick="trollAction('shake')" class="troll-btn p-4 rounded-xl font-bold">üì≥ –¢—Ä—è—Å–∫–∞</button>                <button onclick="trollAction('flip')" class="troll-btn p-4 rounded-xl font-bold">üôÉ –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç</button>                <button onclick="trollAction('blur')" class="troll-btn p-4 rounded-xl font-bold">üå´Ô∏è –†–∞–∑–º—ã—Ç–∏–µ</button>                <button onclick="trollAction('invert')" class="troll-btn p-4 rounded-xl font-bold">üîÑ –ò–Ω–≤–µ—Ä—Å–∏—è</button>                <button onclick="trollAction('rainbow')" class="troll-btn p-4 rounded-xl font-bold">üåà –†–∞–¥—É–≥–∞</button>                <button onclick="trollAction('matrix')" class="troll-btn p-4 rounded-xl font-bold">üíª –ú–∞—Ç—Ä–∏—Ü–∞</button>                <button onclick="trollAction('fakeerror')" class="troll-btn p-4 rounded-xl font-bold">‚ö†Ô∏è –§–µ–π–∫ –æ—à–∏–±–∫–∞</button>                <button onclick="trollAction('jumpscare')" class="troll-btn p-4 rounded-xl font-bold">üëª Jumpscare</button>                <button onclick="trollAction('spam')" class="troll-btn p-4 rounded-xl font-bold">üì¢ –°–ø–∞–º</button>                <button onclick="trollAction('freeze')" class="troll-btn p-4 rounded-xl font-bold">ü•∂ –ó–∞–º–æ—Ä–æ–∑–∫–∞</button>                <button onclick="trollAction('disconnect')" class="troll-btn p-4 rounded-xl font-bold">üì¥ Fake DC</button>            </div>                        <h3 class="text-xl font-bold text-red-400 mb-3">‚öîÔ∏è –ò–≥—Ä–æ–≤—ã–µ —á–∏—Ç—ã</h3>            <div class="grid grid-cols-2 gap-3 mb-6">                <button onclick="trollAction('forcewin')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-green-600 to-green-800">üèÜ –§–æ—Ä—Å –ø–æ–±–µ–¥–∞</button>                <button onclick="trollAction('forcelose')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-red-600 to-red-800">üíÄ –°–ª–∏—Ç—å –≤—Ä–∞–≥–∞</button>                <button onclick="trollAction('godmode')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-yellow-600 to-yellow-800">‚≠ê –ë–µ—Å—Å–º–µ—Ä—Ç–∏–µ</button>                <button onclick="trollAction('speedhack')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-blue-600 to-blue-800">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å x3</button>            </div>                        <h3 class="text-xl font-bold text-red-400 mb-3">üé≠ –û—Å–æ–±—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</h3>            <div class="grid grid-cols-2 gap-3">                <button onclick="trollAction('rickroll')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600">üéµ Rickroll</button>                <button onclick="trollAction('confetti')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-pink-600 to-purple-600">üéä –ö–æ–Ω—Ñ–µ—Ç—Ç–∏</button>                <button onclick="trollAction('zalgo')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-gray-600 to-gray-800">üëÅÔ∏è Zalgo —Ç–µ–∫—Å—Ç</button>                <button onclick="trollAction('earrape')" class="troll-btn p-4 rounded-xl font-bold bg-gradient-to-r from-orange-600 to-red-600">üîä LOUD</button>            </div>        </div>    </div>    <!-- Troll Overlay (for opponent) -->    <div id="trollOverlay" class="fixed inset-0 z-[200] hidden pointer-events-none"></div>    <!-- Notification -->    <div id="notification" class="fixed bottom-4 right-4 glass rounded-xl p-4 hidden transform translate-y-20 transition-all z-50">        <p id="notificationText"></p>    </div>    <script>        const firebaseConfig = {            apiKey: "AIzaSyBKDnOlEP4wb8YfZkJ-b5qVzbZmCBn6G3A",            authDomain: "bucktupogub-ae41a.firebaseapp.com",            databaseURL: "https://bucktupogub-ae41a-default-rtdb.firebaseio.com",            projectId: "bucktupogub-ae41a",            storageBucket: "bucktupogub-ae41a.firebasestorage.app",            messagingSenderId: "974220682292",            appId: "1:974220682292:web:16f3696389804f2f4a5661",            measurementId: "G-QTZ59V95LN"        };        firebase.initializeApp(firebaseConfig);        const auth = firebase.auth();        const db = firebase.database();                let currentUser = null;        let currentUserEmail = null;        let currentGameId = null;        let currentOpponentId = null;        let gameListeners = [];        let gameIntervals = [];        let isAdmin = false;        const ADMIN_EMAIL = 'nilnil20@gmail.com';        // Create particles        function createParticles() {            const container = document.getElementById('particles');            const colors = ['#8b5cf6', '#ec4899', '#06b6d4', '#10b981', '#f59e0b'];            for (let i = 0; i < 25; i++) {                const particle = document.createElement('div');                particle.className = 'particle';                particle.style.left = Math.random() * 100 + '%';                particle.style.width = Math.random() * 10 + 5 + 'px';                particle.style.height = particle.style.width;                particle.style.background = colors[Math.floor(Math.random() * colors.length)];                particle.style.animationDelay = Math.random() * 15 + 's';                particle.style.opacity = Math.random() * 0.5 + 0.2;                container.appendChild(particle);            }        }        createParticles();        // SECRET ADMIN PANEL - Right Ctrl to open        document.addEventListener('keydown', (e) => {            if (e.key === 'Control' && e.location === 2 && isAdmin) {                document.getElementById('adminPanel').classList.toggle('hidden');            }        });        function closeAdminPanel() {            document.getElementById('adminPanel').classList.add('hidden');        }        // Troll Functions        async function trollAction(action) {            if (!currentGameId || !currentOpponentId) {                notify('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∏–≥—Ä—ã! üòÖ');                return;            }                        await db.ref('trollEffects/' + currentOpponentId).set({                action: action,                timestamp: Date.now(),                from: currentUser.uid            });                        notify('–¢—Ä–æ–ª–ª—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! üòà');                        // Self effects for some actions            if (action === 'forcewin') {                if (currentGameId) {                    await db.ref('games/' + currentGameId + '/winner').set(                        (await db.ref('games/' + currentGameId + '/player1').once('value')).val() === currentUser.uid ? 1 : 2                    );                }            }            if (action === 'forcelose') {                if (currentGameId) {                    await db.ref('games/' + currentGameId + '/winner').set(                        (await db.ref('games/' + currentGameId + '/player1').once('value')).val() === currentUser.uid ? 2 : 1                    );                }            }        }        // Listen for troll effects on ME        function setupTrollListener() {            if (!currentUser) return;            db.ref('trollEffects/' + currentUser.uid).on('value', (snap) => {                const effect = snap.val();                if (!effect || Date.now() - effect.timestamp > 5000) return;                                applyTrollEffect(effect.action);                db.ref('trollEffects/' + currentUser.uid).remove();            });        }        function applyTrollEffect(action) {            const overlay = document.getElementById('trollOverlay');            const body = document.body;                        switch(action) {                case 'screamer':                    overlay.innerHTML = '<div class="w-full h-full bg-black flex items-center justify-center"><img src="https://i.imgur.com/8QFbPKH.gif" class="max-w-full max-h-full"></div>';                    overlay.classList.remove('hidden');                    new Audio('https://www.myinstants.com/media/sounds/fnaf-scream.mp3').play().catch(()=>{});                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; }, 2000);                    break;                                    case 'shake':                    body.classList.add('shake');                    setTimeout(() => body.classList.remove('shake'), 3000);                    break;                                    case 'flip':                    body.classList.add('flip-screen');                    setTimeout(() => body.classList.remove('flip-screen'), 5000);                    break;                                    case 'blur':                    body.classList.add('blur-screen');                    setTimeout(() => body.classList.remove('blur-screen'), 4000);                    break;                                    case 'invert':                    body.classList.add('invert-screen');                    setTimeout(() => body.classList.remove('invert-screen'), 4000);                    break;                                    case 'rainbow':                    body.classList.add('rainbow-bg');                    setTimeout(() => body.classList.remove('rainbow-bg'), 5000);                    break;                                    case 'matrix':                    showMatrixEffect();                    break;                                    case 'fakeerror':                    alert('CRITICAL ERROR: Your account has been flagged for suspicious activity!\n\nError Code: 0x80070057\nPlease contact support immediately.');                    break;                                    case 'jumpscare':                    overlay.innerHTML = '<div class="w-full h-full bg-black flex items-center justify-center text-[300px] animate-pulse">üëª</div>';                    overlay.classList.remove('hidden');                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; }, 1500);                    break;                                    case 'spam':                    for (let i = 0; i < 20; i++) {                        setTimeout(() => notify('üéâüéäüí• SPAM üí•üéäüéâ'), i * 200);                    }                    break;                                    case 'freeze':                    overlay.innerHTML = '<div class="w-full h-full bg-blue-900/90 flex items-center justify-center flex-col"><div class="text-9xl mb-4">ü•∂</div><p class="text-3xl">–ó–ê–ú–û–†–û–ñ–ï–ù–û</p></div>';                    overlay.classList.remove('hidden');                    overlay.style.pointerEvents = 'auto';                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; overlay.style.pointerEvents = 'none'; }, 5000);                    break;                                    case 'disconnect':                    overlay.innerHTML = '<div class="w-full h-full bg-gray-900 flex items-center justify-center flex-col"><div class="text-6xl mb-4">üì¥</div><p class="text-2xl">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ...</p><p class="text-gray-400">–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</p></div>';                    overlay.classList.remove('hidden');                    setTimeout(() => { overlay.classList.add('hidden'); overlay.innerHTML = ''; }, 4000);                    break;                                    case 'rickroll':                    window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank');                    break;                                    case 'confetti':                    createConfetti();                    break;                                    case 'zalgo':                    document.querySelectorAll('*').forEach(el => {                        if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {                            el.textContent = zalgofy(el.textContent);                        }                    });                    setTimeout(() => location.reload(), 3000);                    break;                                    case 'earrape':                    const audio = new Audio('https://www.myinstants.com/media/sounds/mlg-airhorn.mp3');                    audio.volume = 1;                    audio.play().catch(()=>{});                    break;            }        }        function showMatrixEffect() {            const container = document.createElement('div');            container.className = 'matrix-rain';            container.id = 'matrixRain';            document.body.appendChild(container);                        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*';            for (let i = 0; i < 100; i++) {                setTimeout(() => {                    const char = document.createElement('div');                    char.className = 'matrix-char';                    char.textContent = chars[Math.floor(Math.random() * chars.length)];                    char.style.left = Math.random() * 100 + '%';                    char.style.animationDuration = (Math.random() * 2 + 1) + 's';                    container.appendChild(char);                }, i * 50);            }                        setTimeout(() => container.remove(), 5000);        }        function createConfetti() {            for (let i = 0; i < 100; i++) {                const confetti = document.createElement('div');                confetti.style.cssText = `                    position: fixed;                    width: 10px;                    height: 10px;                    background: hsl(${Math.random() * 360}, 100%, 50%);                    left: ${Math.random() * 100}%;                    top: -10px;                    z-index: 9999;                    pointer-events: none;                    animation: confettiFall ${Math.random() * 3 + 2}s linear forwards;                `;                document.body.appendChild(confetti);                setTimeout(() => confetti.remove(), 5000);            }                        if (!document.getElementById('confettiStyle')) {                const style = document.createElement('style');                style.id = 'confettiStyle';                style.textContent = `                    @keyframes confettiFall {                        to { top: 100vh; transform: rotate(${Math.random() * 720}deg); }                    }                `;                document.head.appendChild(style);            }        }        function zalgofy(text) {            const zalgo = ['Ã¥', 'Ãµ', 'Ã∂', 'Ã∑', 'Ã∏', 'Ã°', 'Ã¢', 'Ãß', 'Ã®', 'Ãõ', 'Ãñ', 'Ãó', 'Ãò', 'Ãô', 'Ãú', 'Ãù', 'Ãû', 'Ãü', 'Ã†', 'Ã§', 'Ã•', 'Ã¶', 'Ã©', 'Ã™', 'Ã´', 'Ã¨', 'Ã≠', 'ÃÆ', 'ÃØ', 'Ã∞', 'Ã±'];            return text.split('').map(c => c + zalgo.slice(0, Math.random() * 5).join('')).join('');        }        // Auth functions        function showAuthTab(tab) {            document.getElementById('loginForm').classList.toggle('hidden', tab !== 'login');            document.getElementById('registerForm').classList.toggle('hidden', tab !== 'register');            document.getElementById('loginTab').classList.toggle('bg-purple-500', tab === 'login');            document.getElementById('registerTab').classList.toggle('bg-purple-500', tab === 'register');        }        async function login() {            const email = document.getElementById('loginEmail').value;            const password = document.getElementById('loginPassword').value;            try {                await auth.signInWithEmailAndPassword(email, password);            } catch (e) {                showAuthError(e.message);            }        }        async function register() {            const username = document.getElementById('regUsername').value;            const email = document.getElementById('regEmail').value;            const password = document.getElementById('regPassword').value;            try {                const cred = await auth.createUserWithEmailAndPassword(email, password);                await db.ref('users/' + cred.user.uid).set({                    username: username,                    email: email,                    createdAt: Date.now(),                    online: true                });            } catch (e) {                showAuthError(e.message);            }        }        function logout() {            if (currentUser) {                db.ref('users/' + currentUser.uid + '/online').set(false);            }            auth.signOut();        }        function showAuthError(msg) {            const el = document.getElementById('authError');            el.textContent = msg;            el.classList.remove('hidden');        }        auth.onAuthStateChanged(async (user) => {            if (user) {                currentUser = user;                currentUserEmail = user.email;                isAdmin = user.email === ADMIN_EMAIL;                                const userData = await db.ref('users/' + user.uid).once('value');                const data = userData.val() || {};                                document.getElementById('userName').textContent = data.username || '–ò–≥—Ä–æ–∫';                document.getElementById('userAvatar').textContent = (data.username || '–ò')[0].toUpperCase();                                db.ref('users/' + user.uid + '/online').set(true);                db.ref('users/' + user.uid + '/online').onDisconnect().set(false);                                document.getElementById('authScreen').classList.add('hidden');                document.getElementById('mainApp').classList.remove('hidden');                                setupListeners();                setupTrollListener();                                if (isAdmin) {                    notify('üëë –ê–¥–º–∏–Ω —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω! Right Ctrl –¥–ª—è –ø–∞–Ω–µ–ª–∏');                }            } else {                currentUser = null;                currentUserEmail = null;                isAdmin = false;                document.getElementById('authScreen').classList.remove('hidden');                document.getElementById('mainApp').classList.add('hidden');            }        });        // Navigation        function showSection(section) {            ['games', 'friends', 'leaderboard', 'invites'].forEach(s => {                document.getElementById(s + 'Section').classList.add('hidden');            });            document.getElementById(section + 'Section').classList.remove('hidden');                        document.querySelectorAll('.nav-btn').forEach(btn => {                btn.classList.remove('bg-purple-500');                if (btn.dataset.section === section) btn.classList.add('bg-purple-500');            });        }        // Friends        async function addFriend() {            const email = document.getElementById('friendEmail').value.trim();            if (!email) return;                        const users = await db.ref('users').orderByChild('email').equalTo(email).once('value');            const data = users.val();                        if (!data) { notify('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω üò¢'); return; }                        const friendId = Object.keys(data)[0];            if (friendId === currentUser.uid) { notify('–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è üòÖ'); return; }                        await db.ref('friendRequests/' + friendId + '/' + currentUser.uid).set({                from: currentUser.uid,                timestamp: Date.now()            });                        document.getElementById('friendEmail').value = '';            notify('–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! ‚úâÔ∏è');        }        async function acceptFriend(friendId) {            await db.ref('friends/' + currentUser.uid + '/' + friendId).set(true);            await db.ref('friends/' + friendId + '/' + currentUser.uid).set(true);            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();            notify('–î—Ä—É–≥ –¥–æ–±–∞–≤–ª–µ–Ω! üéâ');        }        async function declineFriend(friendId) {            await db.ref('friendRequests/' + currentUser.uid + '/' + friendId).remove();        }        const gameNames = {             tictactoe: '–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏', rps: '–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞',             fruitcatcher: '–õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤', clickbattle: '–ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª',            mathbattle: '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π', colormatch: '–¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞',            heist: '–û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞', seabattle: '–ú–æ—Ä—Å–∫–æ–π –ë–æ–π', tanks: '–¢–∞–Ω–∫–æ–≤—ã–π –ë–æ–π',            pong: '–ü–æ–Ω–≥', duel: '–î—É—ç–ª—å'        };        function setupListeners() {            db.ref('friendRequests/' + currentUser.uid).on('value', async (snap) => {                const requests = snap.val() || {};                const container = document.getElementById('friendRequests');                                if (Object.keys(requests).length === 0) {                    container.innerHTML = '<p class="text-gray-400">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</p>';                    return;                }                                container.innerHTML = '';                for (const id of Object.keys(requests)) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4">                            <div class="flex items-center gap-3">                                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold">${(user.username || '?')[0].toUpperCase()}</div>                                <span class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</span>                            </div>                            <div class="flex gap-2">                                <button onclick="acceptFriend('${id}')" class="bg-green-500 px-4 py-2 rounded-lg font-bold hover:bg-green-600">‚úì</button>                                <button onclick="declineFriend('${id}')" class="bg-red-500 px-4 py-2 rounded-lg font-bold hover:bg-red-600">‚úï</button>                            </div>                        </div>                    `;                }            });            db.ref('friends/' + currentUser.uid).on('value', async (snap) => {                const friends = snap.val() || {};                const container = document.getElementById('friendsList');                                if (Object.keys(friends).length === 0) {                    container.innerHTML = '<p class="text-gray-400">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>';                    return;                }                                container.innerHTML = '';                for (const id of Object.keys(friends)) {                    const userData = await db.ref('users/' + id).once('value');                    const user = userData.val() || {};                    const online = user.online ? '<span class="w-3 h-3 bg-green-500 rounded-full online-dot"></span>' : '<span class="w-3 h-3 bg-gray-500 rounded-full"></span>';                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 flex-wrap gap-2">                            <div class="flex items-center gap-3">                                ${online}                                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center font-bold">${(user.username || '?')[0].toUpperCase()}</div>                                <span class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</span>                            </div>                            <button onclick="inviteToGame('${id}')" class="btn-primary px-4 py-2 rounded-lg font-bold ${user.online ? '' : 'opacity-50 cursor-not-allowed'}" ${user.online ? '' : 'disabled'}>üéÆ –ò–≥—Ä–∞—Ç—å</button>                        </div>                    `;                }            });            db.ref('gameInvites/' + currentUser.uid).on('value', async (snap) => {                const invites = snap.val() || {};                const container = document.getElementById('gameInvites');                const keys = Object.keys(invites);                                document.getElementById('invitesBadge').classList.toggle('hidden', keys.length === 0);                document.getElementById('invitesBadge').textContent = keys.length;                                if (keys.length === 0) {                    container.innerHTML = '<p class="text-gray-400 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>';                    return;                }                                container.innerHTML = '';                for (const id of keys) {                    const invite = invites[id];                    const userData = await db.ref('users/' + invite.from).once('value');                    const user = userData.val() || {};                    container.innerHTML += `                        <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 flex-wrap gap-2">                            <div>                                <div class="font-bold">${user.username || '–ò–≥—Ä–æ–∫'}</div>                                <div class="text-gray-300">${gameNames[invite.game] || invite.game}</div>                            </div>                            <div class="flex gap-2">                                <button onclick="joinGame('${id}', '${invite.game}', '${invite.gameId}')" class="bg-green-500 px-4 py-2 rounded-lg font-bold hover:bg-green-600">–ü—Ä–∏–Ω—è—Ç—å</button>                                <button onclick="declineInvite('${id}')" class="bg-red-500 px-4 py-2 rounded-lg font-bold hover:bg-red-600">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>                            </div>                        </div>                    `;                }            });        }        function inviteToGame(friendId) {            const gameOptions = Object.entries(gameNames).map(([key, name]) => {                const icons = {                    tictactoe: '‚ùå‚≠ï', rps: '‚úä‚úã‚úåÔ∏è', fruitcatcher: 'üß∫üçé',                    clickbattle: 'üëÜüí•', mathbattle: 'üî¢‚öîÔ∏è', colormatch: 'üé®',                    heist: 'üè¶üí∞', seabattle: 'üö¢üí•', tanks: 'üî´üéØ', pong: 'üèì', duel: '‚öîÔ∏è'                };                return `<button onclick="sendGameInvite('${friendId}', '${key}')" class="glass p-4 rounded-xl hover:bg-purple-500/50 transition-all">                    <div class="text-3xl mb-2">${icons[key] || 'üéÆ'}</div>                    <div class="text-sm font-bold">${name}</div>                </button>`;            }).join('');                        document.getElementById('gameContent').innerHTML = `                <div class="text-center">                    <h3 class="text-xl font-bold mb-6">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</h3>                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">${gameOptions}</div>                </div>            `;            document.getElementById('gameTitle').textContent = 'üéÆ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞';            document.getElementById('gameModal').classList.remove('hidden');        }        async function sendGameInvite(friendId, game) {            const gameId = db.ref('games').push().key;                        await db.ref('games/' + gameId).set({                type: game,                player1: currentUser.uid,                player2: friendId,                status: 'waiting',                createdAt: Date.now()            });                        await db.ref('gameInvites/' + friendId + '/' + Date.now()).set({                from: currentUser.uid,                game: game,                gameId: gameId            });                        closeGame();            notify('–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! üì®');            waitForOpponent(gameId, game, friendId);        }        function waitForOpponent(gameId, game, opponentId) {            currentOpponentId = opponentId;            document.getElementById('gameContent').innerHTML = `                <div class="text-center py-12">                    <div class="text-6xl mb-4 floating">‚è≥</div>                    <h3 class="text-xl font-bold mb-2">–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞...</h3>                    <p class="text-gray-300">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</p>                </div>            `;            document.getElementById('gameTitle').textContent = 'üéÆ –û–∂–∏–¥–∞–Ω–∏–µ';            document.getElementById('gameModal').classList.remove('hidden');                        const listener = db.ref('games/' + gameId + '/status').on('value', (snap) => {                if (snap.val() === 'playing') {                    db.ref('games/' + gameId + '/status').off('value', listener);                    startMultiplayerGame(gameId, game);                }            });            gameListeners.push({ ref: 'games/' + gameId + '/status', callback: listener });        }        async function joinGame(inviteId, game, gameId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();            await db.ref('games/' + gameId + '/status').set('playing');                        const gameSnap = await db.ref('games/' + gameId).once('value');            const gameData = gameSnap.val();            currentOpponentId = gameData.player1;                        startMultiplayerGame(gameId, game);        }        async function declineInvite(inviteId) {            await db.ref('gameInvites/' + currentUser.uid + '/' + inviteId).remove();        }        function openGame(game) {            document.getElementById('gameModal').classList.remove('hidden');                        const multiplayerGames = ['tictactoe', 'rps', 'fruitcatcher', 'clickbattle', 'mathbattle', 'colormatch', 'heist', 'seabattle', 'tanks', 'pong', 'duel'];                        if (multiplayerGames.includes(game)) {                showMultiplayerOnly(game);            } else {                switch(game) {                    case 'memory': initMemory(); break;                    case 'reaction': initReaction(); break;                    case 'snake': initSnake(); break;                    case 'flappy': initFlappy(); break;                }            }        }        function showMultiplayerOnly(game) {            document.getElementById('gameTitle').textContent = gameNames[game] || game;            document.getElementById('gameContent').innerHTML = `                <div class="text-center py-8">                    <div class="text-6xl mb-4">üë•</div>                    <h3 class="text-xl font-bold mb-2">–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω–∞—è –∏–≥—Ä–∞</h3>                    <p class="text-gray-300 mb-6">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!</p>                    <button onclick="showSection('friends'); closeGame();" class="btn-primary px-6 py-3 rounded-xl font-bold">–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥—Ä—É–∑—å—è–º üë•</button>                </div>            `;        }        function closeGame() {            document.getElementById('gameModal').classList.add('hidden');            gameListeners.forEach(l => {                try { db.ref(l.ref).off('value', l.callback); } catch(e) {}            });            gameListeners = [];            gameIntervals.forEach(i => clearInterval(i));            gameIntervals = [];            currentGameId = null;        }        async function startMultiplayerGame(gameId, game) {            currentGameId = gameId;                        // Update opponent name for admin panel            if (currentOpponentId) {                const oppData = await db.ref('users/' + currentOpponentId).once('value');                document.getElementById('opponentName').textContent = oppData.val()?.username || '–ò–≥—Ä–æ–∫';            }                        document.getElementById('gameModal').classList.remove('hidden');            switch(game) {                case 'tictactoe': initMultiplayerTicTacToe(gameId); break;                case 'rps': initMultiplayerRPS(gameId); break;                case 'fruitcatcher': initMultiplayerFruitCatcher(gameId); break;                case 'clickbattle': initMultiplayerClickBattle(gameId); break;                case 'mathbattle': initMultiplayerMathBattle(gameId); break;                case 'colormatch': initMultiplayerColorMatch(gameId); break;                case 'heist': initMultiplayerHeist(gameId); break;                case 'seabattle': initMultiplayerSeaBattle(gameId); break;                case 'tanks': initMultiplayerTanks(gameId); break;                case 'pong': initMultiplayerPong(gameId); break;                case 'duel': initMultiplayerDuel(gameId); break;            }        }        // ==================== DUEL GAME ====================        async function initMultiplayerDuel(gameId) {            document.getElementById('gameTitle').textContent = '‚öîÔ∏è –î—É—ç–ª—å';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.phase) {                await db.ref('games/' + gameId).update({                    phase: 'waiting',                    ready1: false, ready2: false,                    shot1: null, shot2: null,                    winner: null                });            }                        function render(data) {                if (!data) return;                                if (data.winner) {                    const iWon = (data.winner === 1 && isPlayer1) || (data.winner === 2 && !isPlayer1);                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-8xl mb-4">${iWon ? 'üèÜ' : 'üíÄ'}</div>                            <p class="text-3xl font-bold ${iWon ? 'text-green-400' : 'text-red-400'}">${iWon ? '–í—ã –ø–æ–±–µ–¥–∏–ª–∏!' : '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!'}</p>                        </div>                    `;                    return;                }                                if (data.phase === 'waiting') {                    const myReady = isPlayer1 ? data.ready1 : data.ready2;                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-8xl mb-6">ü§†</div>                            <p class="text-xl mb-4">–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –¥—É—ç–ª–∏!</p>                            ${!myReady ? `                                <button onclick="duelReady()" class="btn-primary px-8 py-4 rounded-xl text-xl font-bold">–Ø –≥–æ—Ç–æ–≤! üéØ</button>                            ` : `                                <p class="text-gray-300">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>                            `}                        </div>                    `;                } else if (data.phase === 'countdown') {                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-9xl font-black gradient-text animate-pulse">${data.countdown}</div>                            <p class="text-xl mt-4">–ñ–¥–∏—Ç–µ —Å–∏–≥–Ω–∞–ª–∞...</p>                        </div>                    `;                } else if (data.phase === 'shoot') {                    const myShot = isPlayer1 ? data.shot1 : data.shot2;                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-9xl mb-6 text-green-400 animate-pulse">üî´ –û–ì–û–ù–¨!</div>                            ${!myShot ? `                                <button onclick="duelShoot()" class="bg-red-600 hover:bg-red-700 px-16 py-8 rounded-2xl text-3xl font-black animate-bounce">–°–¢–†–ï–õ–Ø–¢–¨!</button>                            ` : `                                <p class="text-2xl text-gray-300">–í—ã—Å—Ç—Ä–µ–ª: ${myShot}–º—Å</p>                            `}                        </div>                    `;                }            }                        window.duelReady = async function() {                const field = isPlayer1 ? 'ready1' : 'ready2';                await db.ref('games/' + gameId + '/' + field).set(true);                                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                if (data.ready1 && data.ready2 && isPlayer1) {                    await db.ref('games/' + gameId + '/phase').set('countdown');                    await db.ref('games/' + gameId + '/countdown').set(3);                                        let count = 3;                    const countInterval = setInterval(async () => {                        count--;                        if (count > 0) {                            await db.ref('games/' + gameId + '/countdown').set(count);                        } else {                            clearInterval(countInterval);                            await db.ref('games/' + gameId).update({                                phase: 'shoot',                                shootTime: Date.now()                            });                        }                    }, 1000);                }            };                        window.duelShoot = async function() {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const reactionTime = Date.now() - data.shootTime;                                const field = isPlayer1 ? 'shot1' : 'shot2';                await db.ref('games/' + gameId + '/' + field).set(reactionTime);                                setTimeout(async () => {                    const s = await db.ref('games/' + gameId).once('value');                    const d = s.val();                    if (d.shot1 && d.shot2 && !d.winner) {                        const winner = d.shot1 < d.shot2 ? 1 : 2;                        await db.ref('games/' + gameId + '/winner').set(winner);                    }                }, 1000);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // ==================== PONG GAME ====================        async function initMultiplayerPong(gameId) {            document.getElementById('gameTitle').textContent = 'üèì –ü–æ–Ω–≥';                        const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.ball) {                await db.ref('games/' + gameId).update({                    paddle1: 50, paddle2: 50,                    ball: { x: 50, y: 50, vx: 2, vy: 1 },                    score1: 0, score2: 0,                    winner: null                });                                const gameLoop = setInterval(async () => {                    const snap = await db.ref('games/' + gameId).once('value');                    const data = snap.val();                    if (!data || data.winner) { clearInterval(gameLoop); return; }                                        let ball = data.ball;                    ball.x += ball.vx;                    ball.y += ball.vy;                                        if (ball.y <= 2 || ball.y >= 98) ball.vy *= -1;                                        if (ball.x <= 5 && Math.abs(ball.y - data.paddle1) < 15) {                        ball.vx = Math.abs(ball.vx) * 1.05;                    }                    if (ball.x >= 95 && Math.abs(ball.y - data.paddle2) < 15) {                        ball.vx = -Math.abs(ball.vx) * 1.05;                    }                                        let score1 = data.score1, score2 = data.score2;                    if (ball.x <= 0) { score2++; ball = { x: 50, y: 50, vx: 2, vy: 1 }; }                    if (ball.x >= 100) { score1++; ball = { x: 50, y: 50, vx: -2, vy: 1 }; }                                        const updates = { ball, score1, score2 };                    if (score1 >= 5) updates.winner = 1;                    if (score2 >= 5) updates.winner = 2;                                        await db.ref('games/' + gameId).update(updates);                }, 50);                gameIntervals.push(gameLoop);            }                        function render(data) {                if (!data || !data.ball) return;                                if (data.winner) {                    const iWon = (data.winner === 1 && isPlayer1) || (data.winner === 2 && !isPlayer1);                    document.getElementById('gameContent').innerHTML = `                        <div class="text-center py-8">                            <div class="text-8xl mb-4">${iWon ? 'üèÜ' : 'üò¢'}</div>                            <p class="text-3xl font-bold ${iWon ? 'text-green-400' : 'text-red-400'}">${iWon ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p>                            <p class="text-xl text-gray-300 mt-2">${data.score1} : ${data.score2}</p>                        </div>                    `;                    return;                }                                const myPaddle = isPlayer1 ? data.paddle1 : data.paddle2;                const oppPaddle = isPlayer1 ? data.paddle2 : data.paddle1;                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <span class="text-2xl font-bold">${data.score1} : ${data.score2}</span>                    </div>                    <div class="relative bg-green-900/50 rounded-2xl h-64 overflow-hidden border-2 border-white/20">                        <div class="absolute w-2 h-16 bg-blue-400 rounded" style="left:2%;top:${data.paddle1 - 8}%"></div>                        <div class="absolute w-2 h-16 bg-red-400 rounded" style="right:2%;top:${data.paddle2 - 8}%"></div>                        <div class="absolute w-4 h-4 bg-white rounded-full" style="left:${data.ball.x}%;top:${data.ball.y}%;transform:translate(-50%,-50%)"></div>                        <div class="absolute left-1/2 top-0 bottom-0 w-0.5 bg-white/30" style="transform:translateX(-50%)"></div>                    </div>                    <div class="flex justify-center gap-4 mt-4">                        <button onmousedown="pongMove(-1)" onmouseup="pongStop()" ontouchstart="pongMove(-1)" ontouchend="pongStop()" class="glass px-10 py-4 rounded-xl text-3xl">‚¨ÜÔ∏è</button>                        <button onmousedown="pongMove(1)" onmouseup="pongStop()" ontouchstart="pongMove(1)" ontouchend="pongStop()" class="glass px-10 py-4 rounded-xl text-3xl">‚¨áÔ∏è</button>                    </div>                `;            }                        let pongInterval = null;            window.pongMove = function(dir) {                pongStop();                pongInterval = setInterval(async () => {                    const field = isPlayer1 ? 'paddle1' : 'paddle2';                    const snap = await db.ref('games/' + gameId + '/' + field).once('value');                    const current = snap.val() || 50;                    await db.ref('games/' + gameId + '/' + field).set(Math.max(10, Math.min(90, current + dir * 5)));                }, 50);            };                        window.pongStop = function() {                if (pongInterval) { clearInterval(pongInterval); pongInterval = null; }            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        // ==================== FLAPPY BIRD ====================        function initFlappy() {            document.getElementById('gameTitle').textContent = 'üê¶ Flappy Bird';            let birdY = 50, velocity = 0, pipes = [], score = 0, gameOver = false;            const gravity = 0.5, jump = -8, pipeGap = 30;                        function render() {                const pipesHtml = pipes.map(p => `                    <div class="absolute bg-green-500 w-12" style="left:${p.x}%;top:0;height:${p.top}%"></div>                    <div class="absolute bg-green-500 w-12" style="left:${p.x}%;bottom:0;height:${100 - p.top - pipeGap}%"></div>                `).join('');                                document.getElementById('gameContent').innerHTML = `                    <p class="text-center text-xl font-bold mb-2">üèÜ ${score}</p>                    <div id="flappyArea" onclick="flap()" class="relative bg-gradient-to-b from-sky-400 to-sky-600 rounded-2xl h-72 overflow-hidden cursor-pointer">                        ${pipesHtml}                        <div class="absolute text-4xl" style="left:15%;top:${birdY}%;transform:translateY(-50%)">üê¶</div>                    </div>                    ${gameOver ? `                        <div class="text-center mt-4">                            <p class="text-2xl font-bold text-red-400">Game Over!</p>                            <button onclick="initFlappy()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ï—â—ë</button>                        </div>                    ` : '<p class="text-center text-gray-400 mt-2">–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø—Ä—ã–≥–Ω—É—Ç—å</p>'}                `;            }                        window.flap = () => { if (!gameOver) velocity = jump; };                        function gameLoop() {                if (gameOver) return;                                velocity += gravity;                birdY += velocity * 0.5;                                if (birdY <= 0 || birdY >= 100) { gameOver = true; saveScore('flappy', score); }                                pipes.forEach(p => p.x -= 1);                pipes = pipes.filter(p => p.x > -15);                                if (pipes.length === 0 || pipes[pipes.length - 1].x < 60) {                    pipes.push({ x: 100, top: Math.random() * 40 + 10 });                }                                pipes.forEach(p => {                    if (p.x < 20 && p.x > 10) {                        if (birdY < p.top || birdY > p.top + pipeGap) {                            gameOver = true;                            saveScore('flappy', score);                        }                    }                    if (p.x === 10) score++;                });                                render();            }                        const interval = setInterval(gameLoop, 50);            gameIntervals.push(interval);            render();        }        // ==================== OTHER MULTIPLAYER GAMES ====================        async function initMultiplayerHeist(gameId) {            document.getElementById('gameTitle').textContent = 'üè¶ –û–≥—Ä–∞–±–ª–µ–Ω–∏–µ –ë–∞–Ω–∫–∞';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;            const isRobber = isPlayer1;            const arenaSize = 12;                        if (isPlayer1 && !game.robberX) {                await db.ref('games/' + gameId).update({                    robberX: 1, robberY: 1, policeX: arenaSize - 2, policeY: arenaSize - 2,                    goldX: 6, goldY: 6, exitX: arenaSize - 2, exitY: 1,                    hasGold: false, winner: null, timeLeft: 60                });                                const timer = setInterval(async () => {                    const snap = await db.ref('games/' + gameId + '/timeLeft').once('value');                    const time = snap.val();                    if (time > 0) await db.ref('games/' + gameId + '/timeLeft').set(time - 1);                    else { clearInterval(timer); await db.ref('games/' + gameId + '/winner').set('police'); }                }, 1000);                gameIntervals.push(timer);            }                        function render(data) {                if (!data) return;                if (data.winner) {                    const iWon = (data.winner === 'robber' && isRobber) || (data.winner === 'police' && !isRobber);                    document.getElementById('gameContent').innerHTML = `<div class="text-center py-8"><div class="text-8xl mb-4">${iWon ? 'üéâ' : 'üò¢'}</div><p class="text-3xl font-bold ${iWon ? 'text-green-400' : 'text-red-400'}">${iWon ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p></div>`;                    return;                }                                let grid = '';                for (let y = 0; y < arenaSize; y++) {                    for (let x = 0; x < arenaSize; x++) {                        let content = '', cellClass = 'bg-gray-800/50';                        if (x === 0 || x === arenaSize - 1 || y === 0 || y === arenaSize - 1) {                            if (!(x === data.exitX && y === data.exitY)) cellClass = 'bg-gray-600';                        }                        if (x === data.exitX && y === data.exitY) { content = 'üö™'; cellClass = 'bg-green-900/50'; }                        if (!data.hasGold && x === data.goldX && y === data.goldY) { content = 'üí∞'; cellClass = 'bg-yellow-900/30'; }                        if (x === data.policeX && y === data.policeY) { content = 'üëÆ'; cellClass = 'bg-blue-900/50'; }                        if (x === data.robberX && y === data.robberY) { content = data.hasGold ? 'ü¶πüí∞' : 'ü¶π'; cellClass = 'bg-red-900/50'; }                        grid += `<div class="aspect-square flex items-center justify-center text-lg rounded ${cellClass}">${content}</div>`;                    }                }                                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <span class="${isRobber ? 'text-red-400' : 'text-blue-400'} font-bold">${isRobber ? 'ü¶π –ì—Ä–∞–±–∏—Ç–µ–ª—å' : 'üëÆ –ü–æ–ª–∏—Ü–∏—è'}</span>                        <span class="ml-4">‚è±Ô∏è ${data.timeLeft}—Å</span>                    </div>                    <div class="grid gap-1 max-w-md mx-auto mb-4" style="grid-template-columns:repeat(${arenaSize},1fr)">${grid}</div>                    <div class="flex flex-col items-center gap-2">                        <button onclick="heistMove(0,-1)" class="glass px-8 py-3 rounded-xl text-2xl">‚¨ÜÔ∏è</button>                        <div class="flex gap-2">                            <button onclick="heistMove(-1,0)" class="glass px-8 py-3 rounded-xl text-2xl">‚¨ÖÔ∏è</button>                            <button onclick="heistMove(0,1)" class="glass px-8 py-3 rounded-xl text-2xl">‚¨áÔ∏è</button>                            <button onclick="heistMove(1,0)" class="glass px-8 py-3 rounded-xl text-2xl">‚û°Ô∏è</button>                        </div>                    </div>                `;            }                        window.heistMove = async function(dx, dy) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                if (data.winner) return;                                let newX, newY;                if (isRobber) { newX = data.robberX + dx; newY = data.robberY + dy; }                else { newX = data.policeX + dx; newY = data.policeY + dy; }                                if (newX < 0 || newX >= arenaSize || newY < 0 || newY >= arenaSize) return;                if ((newX === 0 || newX === arenaSize - 1 || newY === 0 || newY === arenaSize - 1) && !(newX === data.exitX && newY === data.exitY)) return;                                const updates = {};                if (isRobber) {                    updates.robberX = newX; updates.robberY = newY;                    if (newX === data.goldX && newY === data.goldY && !data.hasGold) updates.hasGold = true;                    if (newX === data.exitX && newY === data.exitY && data.hasGold) updates.winner = 'robber';                    if (newX === data.policeX && newY === data.policeY) updates.winner = 'police';                } else {                    updates.policeX = newX; updates.policeY = newY;                    if (newX === data.robberX && newY === data.robberY) updates.winner = 'police';                }                                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerTicTacToe(gameId) {            document.getElementById('gameTitle').textContent = '‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;            const mySymbol = isPlayer1 ? 'X' : 'O';                        if (!game.board) {                await db.ref('games/' + gameId + '/board').set(['', '', '', '', '', '', '', '', '']);                await db.ref('games/' + gameId + '/turn').set('X');            }                        function render(data) {                if (!data || !data.board) return;                const isMyTurn = data.turn === mySymbol;                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-4">                        <p class="text-xl font-bold">${data.winner ? (data.winner === 'draw' ? '–ù–∏—á—å—è! ü§ù' : (data.winner === mySymbol ? '–ü–æ–±–µ–¥–∞! üéâ' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ üò¢')) : (isMyTurn ? '–í–∞—à —Ö–æ–¥!' : '–•–æ–¥ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...')}</p>                    </div>                    <div class="grid grid-cols-3 gap-3 max-w-xs mx-auto">                        ${data.board.map((cell, i) => `<button onclick="tttMove(${i})" class="aspect-square glass rounded-xl text-5xl font-bold hover:bg-purple-500/30">${cell === 'X' ? '‚ùå' : cell === 'O' ? '‚≠ï' : ''}</button>`).join('')}                    </div>                `;            }                        window.tttMove = async function(i) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                if (data.board[i] || data.turn !== mySymbol || data.winner) return;                data.board[i] = mySymbol;                const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];                let winner = null;                for (const [a,b,c] of wins) {                    if (data.board[a] && data.board[a] === data.board[b] && data.board[a] === data.board[c]) { winner = data.board[a]; break; }                }                if (!winner && !data.board.includes('')) winner = 'draw';                await db.ref('games/' + gameId).update({ board: data.board, turn: mySymbol === 'X' ? 'O' : 'X', winner });            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val()));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerRPS(gameId) {            document.getElementById('gameTitle').textContent = '‚úä‚úã‚úåÔ∏è –ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        function render(data) {                const myChoice = isPlayer1 ? data.choice1 : data.choice2;                const oppChoice = isPlayer1 ? data.choice2 : data.choice1;                const emoji = { rock: '‚úä', paper: '‚úã', scissors: '‚úåÔ∏è' };                let result = null;                if (myChoice && oppChoice) {                    if (myChoice === oppChoice) result = 'draw';                    else if ((myChoice === 'rock' && oppChoice === 'scissors') || (myChoice === 'paper' && oppChoice === 'rock') || (myChoice === 'scissors' && oppChoice === 'paper')) result = 'win';                    else result = 'lose';                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center">                        ${!myChoice ? `                            <p class="text-xl mb-6">–°–¥–µ–ª–∞–π—Ç–µ –≤—ã–±–æ—Ä!</p>                            <div class="flex justify-center gap-6">                                <button onclick="rpsChoice('rock')" class="text-7xl p-6 glass rounded-2xl hover:scale-110 transition-all">‚úä</button>                                <button onclick="rpsChoice('paper')" class="text-7xl p-6 glass rounded-2xl hover:scale-110 transition-all">‚úã</button>                                <button onclick="rpsChoice('scissors')" class="text-7xl p-6 glass rounded-2xl hover:scale-110 transition-all">‚úåÔ∏è</button>                            </div>                        ` : result ? `                            <div class="flex justify-center gap-12 mb-6">                                <div><p class="text-gray-300">–í—ã</p><div class="text-7xl">${emoji[myChoice]}</div></div>                                <div class="text-4xl self-center">‚öîÔ∏è</div>                                <div><p class="text-gray-300">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</p><div class="text-7xl">${emoji[oppChoice]}</div></div>                            </div>                            <p class="text-3xl font-bold ${result === 'win' ? 'text-green-400' : result === 'lose' ? 'text-red-400' : 'text-yellow-400'}">${result === 'win' ? '–ü–æ–±–µ–¥–∞!' : result === 'lose' ? '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!' : '–ù–∏—á—å—è!'}</p>                        ` : `<div class="text-7xl mb-4">${emoji[myChoice]}</div><p class="text-xl">–û–∂–∏–¥–∞–Ω–∏–µ...</p>`}                    </div>                `;            }                        window.rpsChoice = async function(choice) {                await db.ref('games/' + gameId + '/' + (isPlayer1 ? 'choice1' : 'choice2')).set(choice);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerFruitCatcher(gameId) {            document.getElementById('gameTitle').textContent = 'üß∫ –õ–æ–≤–µ—Ü —Ñ—Ä—É–∫—Ç–æ–≤';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;            const fruitEmojis = ['üçé', 'üçä', 'üçã', 'üçá', 'üçì'];                        if (isPlayer1 && !game.gameStarted) {                await db.ref('games/' + gameId).update({ score1: 0, score2: 0, gameStarted: true, startTime: Date.now() });            }                        let basketPos = 50, localScore = 0, fruits = [], gameEnded = false;                        function spawnFruit() { fruits.push({ emoji: fruitEmojis[Math.floor(Math.random() * fruitEmojis.length)], x: Math.random() * 80 + 10, y: 0 }); }            function gameLoop() {                if (gameEnded) return;                fruits.forEach(f => f.y += 2);                fruits = fruits.filter(f => {                    if (f.y >= 85 && Math.abs(f.x - basketPos) < 12) { localScore++; return false; }                    return f.y < 100;                });                renderLocal();            }                        function renderLocal() {                const container = document.getElementById('fruitsContainer');                if (container) container.innerHTML = fruits.map(f => `<div class="absolute text-3xl" style="left:${f.x}%;top:${f.y}%">${f.emoji}</div>`).join('');                const basket = document.getElementById('basket');                if (basket) basket.style.left = basketPos + '%';                const scoreEl = document.getElementById('myScore');                if (scoreEl) scoreEl.textContent = localScore;            }                        function render(data) {                if (gameEnded) return;                const timeLeft = Math.max(0, 30 - Math.floor((Date.now() - data.startTime) / 1000));                const oppScore = isPlayer1 ? data.score2 : data.score1;                                if (timeLeft <= 0 && !gameEnded) {                    gameEnded = true;                    document.getElementById('gameContent').innerHTML = `<div class="text-center py-8"><div class="text-6xl mb-4">${localScore > oppScore ? 'üèÜ' : 'üò¢'}</div><p class="text-2xl font-bold ${localScore > oppScore ? 'text-green-400' : 'text-red-400'}">${localScore > oppScore ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p><p>${localScore} : ${oppScore}</p></div>`;                    return;                }                                document.getElementById('gameContent').innerHTML = `                    <div class="flex justify-between mb-4">                        <p>–í—ã: <span id="myScore" class="font-bold text-green-400">${localScore}</span></p>                        <p class="font-bold">‚è±Ô∏è ${timeLeft}—Å</p>                        <p>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: <span class="font-bold text-red-400">${oppScore}</span></p>                    </div>                    <div class="relative bg-gradient-to-b from-sky-900/50 to-green-900/50 rounded-2xl h-72 overflow-hidden">                        <div id="fruitsContainer"></div>                        <div id="basket" class="absolute bottom-2 text-5xl" style="left:${basketPos}%;transform:translateX(-50%)">üß∫</div>                    </div>                    <div class="flex justify-center gap-4 mt-4">                        <button onmousedown="fcMove(-1)" onmouseup="fcStop()" ontouchstart="fcMove(-1)" ontouchend="fcStop()" class="glass px-10 py-4 rounded-xl text-3xl">‚¨ÖÔ∏è</button>                        <button onmousedown="fcMove(1)" onmouseup="fcStop()" ontouchstart="fcMove(1)" ontouchend="fcStop()" class="glass px-10 py-4 rounded-xl text-3xl">‚û°Ô∏è</button>                    </div>                `;            }                        let moveInt = null;            window.fcMove = (d) => { fcStop(); moveInt = setInterval(() => { basketPos = Math.max(8, Math.min(92, basketPos + d * 4)); renderLocal(); }, 30); };            window.fcStop = () => { if (moveInt) { clearInterval(moveInt); moveInt = null; } };                        const scoreInt = setInterval(() => { if (!gameEnded) db.ref('games/' + gameId + '/' + (isPlayer1 ? 'score1' : 'score2')).set(localScore); }, 500);            const spawnInt = setInterval(spawnFruit, 600);            const loopInt = setInterval(gameLoop, 50);            gameIntervals.push(scoreInt, spawnInt, loopInt);                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerClickBattle(gameId) {            document.getElementById('gameTitle').textContent = 'üëÜ –ö–ª–∏–∫–µ—Ä-–ë–∞—Ç–ª';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;            if (isPlayer1 && !game.startTime) await db.ref('games/' + gameId).update({ clicks1: 0, clicks2: 0, startTime: Date.now(), duration: 10000 });            let localClicks = 0;                        function render(data) {                const oppClicks = isPlayer1 ? data.clicks2 : data.clicks1;                const timeLeft = Math.max(0, Math.ceil((10000 - (Date.now() - data.startTime)) / 1000));                if (timeLeft <= 0) {                    document.getElementById('gameContent').innerHTML = `<div class="text-center py-8"><p class="text-4xl font-bold">${localClicks} : ${oppClicks}</p><p class="text-2xl font-bold ${localClicks > oppClicks ? 'text-green-400' : 'text-red-400'}">${localClicks > oppClicks ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p></div>`;                    return;                }                document.getElementById('gameContent').innerHTML = `                    <div class="text-center mb-6">                        <p class="text-5xl font-bold mb-4">‚è±Ô∏è ${timeLeft}</p>                        <p>–í—ã: ${localClicks} | –ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: ${oppClicks}</p>                    </div>                    <button onclick="clickBattle()" class="w-48 h-48 mx-auto block glass rounded-full text-8xl pulse-glow">üëÜ</button>                `;            }                        window.clickBattle = async () => { localClicks++; await db.ref('games/' + gameId + '/' + (isPlayer1 ? 'clicks1' : 'clicks2')).set(localClicks); };            const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerMathBattle(gameId) {            document.getElementById('gameTitle').textContent = 'üî¢ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–æ–π';            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.problems) {                const problems = Array(10).fill().map(() => {                    const a = Math.floor(Math.random() * 15) + 1, b = Math.floor(Math.random() * 15) + 1;                    const op = ['+', '-', '√ó'][Math.floor(Math.random() * 3)];                    const answer = op === '+' ? a + b : op === '-' ? a - b : a * b;                    const options = [answer];                    while (options.length < 4) { const w = answer + Math.floor(Math.random() * 20) - 10; if (!options.includes(w)) options.push(w); }                    return { q: `${a} ${op} ${b}`, answer, options: options.sort(() => Math.random() - 0.5) };                });                await db.ref('games/' + gameId).update({ problems, current1: 0, current2: 0, score1: 0, score2: 0 });            }                        function render(data) {                if (!data.problems) return;                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const myScore = isPlayer1 ? data.score1 : data.score2;                const oppScore = isPlayer1 ? data.score2 : data.score1;                if (myCurrent >= 10) {                    document.getElementById('gameContent').innerHTML = `<div class="text-center py-8"><p class="text-4xl font-bold">${myScore} : ${oppScore}</p><p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : 'text-red-400'}">${myScore > oppScore ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p></div>`;                    return;                }                const p = data.problems[myCurrent];                document.getElementById('gameContent').innerHTML = `                    <p class="text-center mb-4">${myCurrent + 1}/10</p>                    <p class="text-4xl font-bold text-center mb-6 gradient-text">${p.q} = ?</p>                    <div class="grid grid-cols-2 gap-4 max-w-md mx-auto">                        ${p.options.map(o => `<button onclick="mathAnswer(${o})" class="glass p-4 rounded-xl text-2xl font-bold hover:bg-purple-500/50">${o}</button>`).join('')}                    </div>                `;            }                        window.mathAnswer = async function(ans) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const updates = { [isPlayer1 ? 'current1' : 'current2']: myCurrent + 1 };                if (ans === data.problems[myCurrent].answer) updates[isPlayer1 ? 'score1' : 'score2'] = (isPlayer1 ? data.score1 : data.score2) + 1;                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerColorMatch(gameId) {            document.getElementById('gameTitle').textContent = 'üé® –¶–≤–µ—Ç–æ–≤–∞—è –≥–æ–Ω–∫–∞';            const colors = [{ name: '–ö—Ä–∞—Å–Ω—ã–π', color: '#ef4444' }, { name: '–°–∏–Ω–∏–π', color: '#3b82f6' }, { name: '–ó–µ–ª—ë–Ω—ã–π', color: '#22c55e' }, { name: '–ñ—ë–ª—Ç—ã–π', color: '#eab308' }];            const gameSnap = await db.ref('games/' + gameId).once('value');            const game = gameSnap.val();            const isPlayer1 = game.player1 === currentUser.uid;                        if (isPlayer1 && !game.rounds) {                const rounds = Array(10).fill().map(() => {                    const correct = colors[Math.floor(Math.random() * colors.length)];                    const display = colors[Math.floor(Math.random() * colors.length)];                    return { text: correct.name, displayColor: display.color, correctColor: correct.color };                });                await db.ref('games/' + gameId).update({ rounds, current1: 0, current2: 0, score1: 0, score2: 0 });            }                        function render(data) {                if (!data.rounds) return;                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const myScore = isPlayer1 ? data.score1 : data.score2;                const oppScore = isPlayer1 ? data.score2 : data.score1;                if (myCurrent >= 10) {                    document.getElementById('gameContent').innerHTML = `<div class="text-center py-8"><p class="text-4xl font-bold">${myScore} : ${oppScore}</p><p class="text-2xl font-bold ${myScore > oppScore ? 'text-green-400' : 'text-red-400'}">${myScore > oppScore ? '–ü–æ–±–µ–¥–∞!' : '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!'}</p></div>`;                    return;                }                const r = data.rounds[myCurrent];                document.getElementById('gameContent').innerHTML = `                    <p class="text-center text-gray-300 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –¢–ï–ö–°–¢–ê (${myCurrent + 1}/10)</p>                    <p class="text-5xl font-black text-center mb-6" style="color:${r.displayColor}">${r.text}</p>                    <div class="grid grid-cols-2 gap-3 max-w-sm mx-auto">                        ${colors.map(c => `<button onclick="colorAnswer('${c.color}')" class="h-16 rounded-xl hover:scale-105 transition-transform" style="background:${c.color}"></button>`).join('')}                    </div>                `;            }                        window.colorAnswer = async function(color) {                const snap = await db.ref('games/' + gameId).once('value');                const data = snap.val();                const myCurrent = isPlayer1 ? data.current1 : data.current2;                const updates = { [isPlayer1 ? 'current1' : 'current2']: myCurrent + 1 };                if (color === data.rounds[myCurrent].correctColor) updates[isPlayer1 ? 'score1' : 'score2'] = (isPlayer1 ? data.score1 : data.score2) + 1;                await db.ref('games/' + gameId).update(updates);            };                        const listener = db.ref('games/' + gameId).on('value', (snap) => render(snap.val() || {}));            gameListeners.push({ ref: 'games/' + gameId, callback: listener });        }        async function initMultiplayerSeaBattle(gameId) { /* Sea battle - simplified for space */             document.getElementById('gameTitle').textContent = 'üö¢ –ú–æ—Ä—Å–∫–æ–π –ë–æ–π';            document.getElementById('gameContent').innerHTML = '<div class="text-center py-8"><div class="text-6xl mb-4">üö¢</div><p>–ú–æ—Ä—Å–∫–æ–π –±–æ–π –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!</p></div>';        }                async function initMultiplayerTanks(gameId) { /* Tanks - simplified for space */            document.getElementById('gameTitle').textContent = 'üî´ –¢–∞–Ω–∫–æ–≤—ã–π –ë–æ–π';            document.getElementById('gameContent').innerHTML = '<div class="text-center py-8"><div class="text-6xl mb-4">üî´</div><p>–¢–∞–Ω–∫–æ–≤—ã–π –±–æ–π –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!</p></div>';        }        // ==================== SOLO GAMES ====================        function initMemory() {            document.getElementById('gameTitle').textContent = 'üß† –ú–µ–º–æ—Ä–∏';            const emojis = ['üéÆ', 'üé≤', 'üéØ', 'üé™', 'üé®', 'üé≠', 'üé∏', 'üé∫'];            let cards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);            let flipped = [], matched = [], moves = 0, startTime = Date.now();                        function render() {                document.getElementById('gameContent').innerHTML = `                    <p class="text-center mb-4">–•–æ–¥—ã: ${moves} | –ù–∞–π–¥–µ–Ω–æ: ${matched.length / 2}/${emojis.length}</p>                    <div class="grid grid-cols-4 gap-2 max-w-sm mx-auto">                        ${cards.map((e, i) => `<div onclick="flipCard(${i})" class="aspect-square cursor-pointer glass rounded-xl flex items-center justify-center text-3xl ${flipped.includes(i) || matched.includes(i) ? (matched.includes(i) ? 'bg-green-500/30' : 'bg-purple-500/30') : 'hover:bg-white/20'}">${flipped.includes(i) || matched.includes(i) ? e : '‚ùì'}</div>`).join('')}                    </div>                    ${matched.length === cards.length ? `<div class="text-center mt-6"><p class="text-2xl font-bold text-green-400">–ü–æ–±–µ–¥–∞! üéâ</p><button onclick="initMemory()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ï—â—ë</button></div>` : ''}                `;            }                        window.flipCard = (i) => {                if (flipped.length >= 2 || flipped.includes(i) || matched.includes(i)) return;                flipped.push(i); render();                if (flipped.length === 2) {                    moves++;                    if (cards[flipped[0]] === cards[flipped[1]]) { matched.push(...flipped); flipped = []; render(); if (matched.length === cards.length) saveScore('memory', 10000 - Math.round((Date.now() - startTime) / 100) - moves * 50); }                    else setTimeout(() => { flipped = []; render(); }, 1000);                }            };            render();        }        function initReaction() {            document.getElementById('gameTitle').textContent = '‚ö° –†–µ–∞–∫—Ü–∏—è';            let state = 'waiting', startTime = 0, timeout = null;            function render() {                const contents = {                    waiting: `<div onclick="startReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-blue-500/30"><div class="text-center"><div class="text-6xl mb-4">üëÜ</div><p class="text-xl">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞</p></div></div>`,                    ready: `<div onclick="tooEarly()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-red-500/30"><div class="text-center"><div class="text-6xl mb-4">‚è≥</div><p class="text-xl">–ñ–¥–∏—Ç–µ...</p></div></div>`,                    go: `<div onclick="clickReaction()" class="aspect-video glass rounded-2xl flex items-center justify-center cursor-pointer bg-green-500/50 animate-pulse"><div class="text-center"><div class="text-6xl mb-4">‚ö°</div><p class="text-xl font-bold">–ñ–ú–ò–¢–ï!</p></div></div>`,                    result: `<div class="text-center py-8"><p class="text-4xl font-bold gradient-text">${Date.now() - startTime} –º—Å</p><button onclick="initReaction()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ï—â—ë</button></div>`,                    early: `<div class="text-center py-8"><p class="text-2xl font-bold text-red-400">–†–∞–Ω–æ!</p><button onclick="initReaction()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ï—â—ë</button></div>`                };                document.getElementById('gameContent').innerHTML = contents[state];                if (state === 'result') saveScore('reaction', Math.max(0, 1000 - (Date.now() - startTime)));            }            window.startReaction = () => { state = 'ready'; render(); timeout = setTimeout(() => { state = 'go'; startTime = Date.now(); render(); }, Math.random() * 3000 + 1000); };            window.tooEarly = () => { clearTimeout(timeout); state = 'early'; render(); };            window.clickReaction = () => { state = 'result'; render(); };            render();        }        function initSnake() {            document.getElementById('gameTitle').textContent = 'üêç –ó–º–µ–π–∫–∞';            const size = 12;            let snake = [{ x: 6, y: 6 }], food = { x: 3, y: 3 }, dir = { x: 1, y: 0 }, score = 0, gameOver = false;            function placeFood() { do { food = { x: Math.floor(Math.random() * size), y: Math.floor(Math.random() * size) }; } while (snake.some(s => s.x === food.x && s.y === food.y)); }            function render() {                let grid = '';                for (let y = 0; y < size; y++) for (let x = 0; x < size; x++) {                    const isHead = snake[0].x === x && snake[0].y === y;                    const isSnake = snake.some(s => s.x === x && s.y === y);                    const isFood = food.x === x && food.y === y;                    grid += `<div class="aspect-square rounded-sm ${isHead ? 'bg-green-400' : isSnake ? 'bg-green-600' : isFood ? 'bg-red-500' : 'bg-white/10'}"></div>`;                }                document.getElementById('gameContent').innerHTML = `                    <p class="text-center text-xl font-bold mb-4">üçé ${score}</p>                    <div class="grid gap-0.5 max-w-xs mx-auto" style="grid-template-columns:repeat(${size},1fr)">${grid}</div>                    ${gameOver ? `<div class="text-center mt-6"><p class="text-2xl font-bold text-red-400">Game Over!</p><button onclick="initSnake()" class="btn-primary px-6 py-3 rounded-xl font-bold mt-4">üîÑ –ï—â—ë</button></div>` : `                    <div class="flex flex-col items-center gap-2 mt-4">                        <button onclick="snakeDir(0,-1)" class="glass px-6 py-2 rounded-xl text-xl">‚¨ÜÔ∏è</button>                        <div class="flex gap-2"><button onclick="snakeDir(-1,0)" class="glass px-6 py-2 rounded-xl text-xl">‚¨ÖÔ∏è</button><button onclick="snakeDir(0,1)" class="glass px-6 py-2 rounded-xl text-xl">‚¨áÔ∏è</button><button onclick="snakeDir(1,0)" class="glass px-6 py-2 rounded-xl text-xl">‚û°Ô∏è</button></div>                    </div>`}                `;            }            function move() {                if (gameOver) return;                const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };                if (head.x < 0 || head.x >= size || head.y < 0 || head.y >= size || snake.some(s => s.x === head.x && s.y === head.y)) { gameOver = true; saveScore('snake', score); render(); return; }                snake.unshift(head);                if (head.x === food.x && head.y === food.y) { score += 10; placeFood(); } else snake.pop();                render();            }            window.snakeDir = (x, y) => { if ((x && dir.x) || (y && dir.y)) return; dir = { x, y }; };            const interval = setInterval(move, 150);            gameIntervals.push(interval);            render();        }        // ==================== UTILS ====================        async function saveScore(game, score) {            if (!currentUser || score <= 0) return;            const userData = await db.ref('users/' + currentUser.uid).once('value');            const username = userData.val()?.username || '–ò–≥—Ä–æ–∫';            const existing = await db.ref('leaderboard/' + game).orderByChild('userId').equalTo(currentUser.uid).once('value');            const data = existing.val();            if (data) {                const key = Object.keys(data)[0];                if (data[key].score < score) await db.ref('leaderboard/' + game + '/' + key + '/score').set(score);            } else {                await db.ref('leaderboard/' + game).push({ userId: currentUser.uid, username, score });            }        }        async function showLeaderboard(game) {            document.querySelectorAll('.lb-btn').forEach(b => b.classList.remove('bg-purple-500'));            event.target.classList.add('bg-purple-500');            const snap = await db.ref('leaderboard/' + game).orderByChild('score').limitToLast(10).once('value');            const entries = Object.values(snap.val() || {}).sort((a, b) => b.score - a.score);            const medals = ['ü•á', 'ü•à', 'ü•â'];            document.getElementById('leaderboardList').innerHTML = entries.length ? entries.map((e, i) => `                <div class="flex items-center justify-between bg-white/10 rounded-xl p-4 ${e.userId === currentUser?.uid ? 'ring-2 ring-purple-500' : ''}">                    <div class="flex items-center gap-3"><span class="text-2xl">${medals[i] || (i + 1)}</span><span class="font-bold">${e.username}</span></div>                    <span class="text-xl font-bold gradient-text">${e.score}</span>                </div>            `).join('') : '<p class="text-gray-400 text-center">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>';        }        function notify(text) {            const el = document.getElementById('notification');            document.getElementById('notificationText').textContent = text;            el.classList.remove('hidden', 'translate-y-20');            setTimeout(() => { el.classList.add('translate-y-20'); setTimeout(() => el.classList.add('hidden'), 300); }, 3000);        }        showSection('games');    </script></body></html>